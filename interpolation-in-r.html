<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>J Interpolation in R | Intro to GIS and Spatial Analysis</title>
  <meta name="description" content="This is a compilation of lecture notes that accompany my Intro to GIS and Spatial Analysis course." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="J Interpolation in R | Intro to GIS and Spatial Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a compilation of lecture notes that accompany my Intro to GIS and Spatial Analysis course." />
  <meta name="github-repo" content="mgimond/spatial" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="J Interpolation in R | Intro to GIS and Spatial Analysis" />
  
  <meta name="twitter:description" content="This is a compilation of lecture notes that accompany my Intro to GIS and Spatial Analysis course." />
  

<meta name="author" content="Manuel Gimond" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="spatial-autocorrelation-in-r.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.1/leaflet.js"></script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-71085TV4MB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-71085TV4MB');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introGIS.html"><a href="introGIS.html"><i class="fa fa-check"></i><b>1</b> Introduction to GIS</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introGIS.html"><a href="introGIS.html#what-is-a-gis"><i class="fa fa-check"></i><b>1.1</b> What is a GIS?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introGIS.html"><a href="introGIS.html#gis-software"><i class="fa fa-check"></i><b>1.1.1</b> GIS software</a></li>
<li class="chapter" data-level="1.1.2" data-path="introGIS.html"><a href="introGIS.html#qgis"><i class="fa fa-check"></i><b>1.1.2</b> QGIS</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introGIS.html"><a href="introGIS.html#what-is-spatial-analysis"><i class="fa fa-check"></i><b>1.2</b> What is Spatial Analysis?</a></li>
<li class="chapter" data-level="1.3" data-path="introGIS.html"><a href="introGIS.html#whats-in-an-acronym"><i class="fa fa-check"></i><b>1.3</b> What’s in an Acronym?</a></li>
</ul></li>
<li class="part"><span><b>PART 1: Working with spatial data</b></span></li>
<li class="chapter" data-level="2" data-path="chp02_0.html"><a href="chp02_0.html"><i class="fa fa-check"></i><b>2</b> Feature Representation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chp02_0.html"><a href="chp02_0.html#vector-vs.-raster"><i class="fa fa-check"></i><b>2.1</b> Vector vs. Raster</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chp02_0.html"><a href="chp02_0.html#vector"><i class="fa fa-check"></i><b>2.1.1</b> Vector</a></li>
<li class="chapter" data-level="2.1.2" data-path="chp02_0.html"><a href="chp02_0.html#raster"><i class="fa fa-check"></i><b>2.1.2</b> Raster</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chp02_0.html"><a href="chp02_0.html#object-vs.-field"><i class="fa fa-check"></i><b>2.2</b> Object vs. Field</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chp02_0.html"><a href="chp02_0.html#object-view"><i class="fa fa-check"></i><b>2.2.1</b> Object View</a></li>
<li class="chapter" data-level="2.2.2" data-path="chp02_0.html"><a href="chp02_0.html#field-view"><i class="fa fa-check"></i><b>2.2.2</b> Field View</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="chp02_0.html"><a href="chp02_0.html#scale"><i class="fa fa-check"></i><b>2.3</b> Scale</a></li>
<li class="chapter" data-level="2.4" data-path="chp02_0.html"><a href="chp02_0.html#attribute-tables"><i class="fa fa-check"></i><b>2.4</b> Attribute Tables</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="chp02_0.html"><a href="chp02_0.html#measurement-levels"><i class="fa fa-check"></i><b>2.4.1</b> Measurement Levels</a></li>
<li class="chapter" data-level="2.4.2" data-path="chp02_0.html"><a href="chp02_0.html#data-type"><i class="fa fa-check"></i><b>2.4.2</b> Data type</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="gis-data-management.html"><a href="gis-data-management.html"><i class="fa fa-check"></i><b>3</b> GIS Data Management</a>
<ul>
<li class="chapter" data-level="3.1" data-path="gis-data-management.html"><a href="gis-data-management.html#gis-file-data-formats"><i class="fa fa-check"></i><b>3.1</b> GIS File Data Formats</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="gis-data-management.html"><a href="gis-data-management.html#vector-data-file-formats"><i class="fa fa-check"></i><b>3.1.1</b> Vector Data File Formats</a></li>
<li class="chapter" data-level="3.1.2" data-path="gis-data-management.html"><a href="gis-data-management.html#raster-data-file-formats"><i class="fa fa-check"></i><b>3.1.2</b> Raster Data File Formats</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="gis-data-management.html"><a href="gis-data-management.html#managing-gis-files-in-arcgis"><i class="fa fa-check"></i><b>3.2</b> Managing GIS Files in ArcGIS</a></li>
<li class="chapter" data-level="3.3" data-path="gis-data-management.html"><a href="gis-data-management.html#managing-a-map-project-in-arcgis"><i class="fa fa-check"></i><b>3.3</b> Managing a Map Project in ArcGIS</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="symbolizing-features.html"><a href="symbolizing-features.html"><i class="fa fa-check"></i><b>4</b> Symbolizing features</a>
<ul>
<li class="chapter" data-level="4.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#color"><i class="fa fa-check"></i><b>4.1</b> Color</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#hue"><i class="fa fa-check"></i><b>4.1.1</b> Hue</a></li>
<li class="chapter" data-level="4.1.2" data-path="symbolizing-features.html"><a href="symbolizing-features.html#lightness"><i class="fa fa-check"></i><b>4.1.2</b> Lightness</a></li>
<li class="chapter" data-level="4.1.3" data-path="symbolizing-features.html"><a href="symbolizing-features.html#saturation"><i class="fa fa-check"></i><b>4.1.3</b> Saturation</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="symbolizing-features.html"><a href="symbolizing-features.html#color-space"><i class="fa fa-check"></i><b>4.2</b> Color Space</a></li>
<li class="chapter" data-level="4.3" data-path="symbolizing-features.html"><a href="symbolizing-features.html#classification"><i class="fa fa-check"></i><b>4.3</b> Classification</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#qualitative-color-scheme"><i class="fa fa-check"></i><b>4.3.1</b> Qualitative color scheme</a></li>
<li class="chapter" data-level="4.3.2" data-path="symbolizing-features.html"><a href="symbolizing-features.html#sequential-color-scheme"><i class="fa fa-check"></i><b>4.3.2</b> Sequential color scheme</a></li>
<li class="chapter" data-level="4.3.3" data-path="symbolizing-features.html"><a href="symbolizing-features.html#divergent-color-scheme"><i class="fa fa-check"></i><b>4.3.3</b> Divergent color scheme</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="symbolizing-features.html"><a href="symbolizing-features.html#so-how-do-i-find-a-proper-color-scheme-for-my-data"><i class="fa fa-check"></i><b>4.4</b> So how do I find a proper color scheme for my data?</a></li>
<li class="chapter" data-level="4.5" data-path="symbolizing-features.html"><a href="symbolizing-features.html#classification-intervals"><i class="fa fa-check"></i><b>4.5</b> Classification Intervals</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#an-interactive-example"><i class="fa fa-check"></i><b>4.5.1</b> An Interactive Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="statistical-maps.html"><a href="statistical-maps.html"><i class="fa fa-check"></i><b>5</b> Statistical maps</a>
<ul>
<li class="chapter" data-level="5.1" data-path="statistical-maps.html"><a href="statistical-maps.html#statistical-distribution-maps"><i class="fa fa-check"></i><b>5.1</b> Statistical distribution maps</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="statistical-maps.html"><a href="statistical-maps.html#quantile-map"><i class="fa fa-check"></i><b>5.1.1</b> Quantile map</a></li>
<li class="chapter" data-level="5.1.2" data-path="statistical-maps.html"><a href="statistical-maps.html#boxplot-map"><i class="fa fa-check"></i><b>5.1.2</b> Boxplot map</a></li>
<li class="chapter" data-level="5.1.3" data-path="statistical-maps.html"><a href="statistical-maps.html#iqr-map"><i class="fa fa-check"></i><b>5.1.3</b> IQR map</a></li>
<li class="chapter" data-level="5.1.4" data-path="statistical-maps.html"><a href="statistical-maps.html#standard-deviation-map"><i class="fa fa-check"></i><b>5.1.4</b> Standard deviation map</a></li>
<li class="chapter" data-level="5.1.5" data-path="statistical-maps.html"><a href="statistical-maps.html#outlier-maps"><i class="fa fa-check"></i><b>5.1.5</b> Outlier maps</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="statistical-maps.html"><a href="statistical-maps.html#mapping-uncertainty"><i class="fa fa-check"></i><b>5.2</b> Mapping uncertainty</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="statistical-maps.html"><a href="statistical-maps.html#problems-in-mapping-uncertainty"><i class="fa fa-check"></i><b>5.2.1</b> Problems in mapping uncertainty</a></li>
<li class="chapter" data-level="5.2.2" data-path="statistical-maps.html"><a href="statistical-maps.html#class-comparison-maps"><i class="fa fa-check"></i><b>5.2.2</b> Class comparison maps</a></li>
<li class="chapter" data-level="5.2.3" data-path="statistical-maps.html"><a href="statistical-maps.html#problem-when-performing-bivariate-analysis"><i class="fa fa-check"></i><b>5.2.3</b> Problem when performing bivariate analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html"><i class="fa fa-check"></i><b>6</b> Pitfalls to avoid</a>
<ul>
<li class="chapter" data-level="6.1" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#representing-count"><i class="fa fa-check"></i><b>6.1</b> Representing Count</a></li>
<li class="chapter" data-level="6.2" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#maup"><i class="fa fa-check"></i><b>6.2</b> MAUP</a></li>
<li class="chapter" data-level="6.3" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#ecological-fallacy"><i class="fa fa-check"></i><b>6.3</b> Ecological Fallacy</a></li>
<li class="chapter" data-level="6.4" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#mapping-rates"><i class="fa fa-check"></i><b>6.4</b> Mapping rates</a></li>
<li class="chapter" data-level="6.5" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#coping-with-unstable-rates"><i class="fa fa-check"></i><b>6.5</b> Coping with Unstable Rates</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html"><i class="fa fa-check"></i><b>7</b> Good Map Making Tips</a>
<ul>
<li class="chapter" data-level="7.1" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html#elements-of-a-map"><i class="fa fa-check"></i><b>7.1</b> Elements of a map</a></li>
<li class="chapter" data-level="7.2" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html#how-to-create-a-good-map"><i class="fa fa-check"></i><b>7.2</b> How to create a <em>good</em> map</a></li>
<li class="chapter" data-level="7.3" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html#typefaces-and-fonts"><i class="fa fa-check"></i><b>7.3</b> Typefaces and Fonts</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html"><i class="fa fa-check"></i><b>8</b> Spatial Operations and Vector Overlays</a>
<ul>
<li class="chapter" data-level="8.1" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#selection-by-attribute"><i class="fa fa-check"></i><b>8.1</b> Selection by Attribute</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#set-algebra"><i class="fa fa-check"></i><b>8.1.1</b> Set Algebra</a></li>
<li class="chapter" data-level="8.1.2" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#boolean-algebra"><i class="fa fa-check"></i><b>8.1.2</b> Boolean Algebra</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#selection-by-location"><i class="fa fa-check"></i><b>8.2</b> Selection by location</a></li>
<li class="chapter" data-level="8.3" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#vector-overlay"><i class="fa fa-check"></i><b>8.3</b> Vector Overlay</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#clip"><i class="fa fa-check"></i><b>8.3.1</b> Clip</a></li>
<li class="chapter" data-level="8.3.2" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#intersect"><i class="fa fa-check"></i><b>8.3.2</b> Intersect</a></li>
<li class="chapter" data-level="8.3.3" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#union"><i class="fa fa-check"></i><b>8.3.3</b> Union</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chp09_0.html"><a href="chp09_0.html"><i class="fa fa-check"></i><b>9</b> Coordinate Systems</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chp09_0.html"><a href="chp09_0.html#geographic-coordinate-systems"><i class="fa fa-check"></i><b>9.1</b> Geographic Coordinate Systems</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="chp09_0.html"><a href="chp09_0.html#sphere-and-ellipsoid"><i class="fa fa-check"></i><b>9.1.1</b> Sphere and Ellipsoid</a></li>
<li class="chapter" data-level="9.1.2" data-path="chp09_0.html"><a href="chp09_0.html#geoid"><i class="fa fa-check"></i><b>9.1.2</b> Geoid</a></li>
<li class="chapter" data-level="9.1.3" data-path="chp09_0.html"><a href="chp09_0.html#datum"><i class="fa fa-check"></i><b>9.1.3</b> Datum</a></li>
<li class="chapter" data-level="9.1.4" data-path="chp09_0.html"><a href="chp09_0.html#building-the-geographic-coordinate-system"><i class="fa fa-check"></i><b>9.1.4</b> Building the Geographic Coordinate System</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="chp09_0.html"><a href="chp09_0.html#projected-coordinate-systems"><i class="fa fa-check"></i><b>9.2</b> Projected Coordinate Systems</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="chp09_0.html"><a href="chp09_0.html#planar-projections"><i class="fa fa-check"></i><b>9.2.1</b> Planar Projections</a></li>
<li class="chapter" data-level="9.2.2" data-path="chp09_0.html"><a href="chp09_0.html#cylindrical-projection"><i class="fa fa-check"></i><b>9.2.2</b> Cylindrical Projection</a></li>
<li class="chapter" data-level="9.2.3" data-path="chp09_0.html"><a href="chp09_0.html#conical-projection"><i class="fa fa-check"></i><b>9.2.3</b> Conical Projection</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="chp09_0.html"><a href="chp09_0.html#spatial-properties"><i class="fa fa-check"></i><b>9.3</b> Spatial Properties</a></li>
<li class="chapter" data-level="9.4" data-path="chp09_0.html"><a href="chp09_0.html#geodesic-geometries"><i class="fa fa-check"></i><b>9.4</b> Geodesic geometries</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chp10_0.html"><a href="chp10_0.html"><i class="fa fa-check"></i><b>10</b> Map Algebra</a>
<ul>
<li class="chapter" data-level="10.1" data-path="chp10_0.html"><a href="chp10_0.html#local-operations-and-functions"><i class="fa fa-check"></i><b>10.1</b> Local operations and functions</a></li>
<li class="chapter" data-level="10.2" data-path="chp10_0.html"><a href="chp10_0.html#focal-operations-and-functions"><i class="fa fa-check"></i><b>10.2</b> Focal operations and functions</a></li>
<li class="chapter" data-level="10.3" data-path="chp10_0.html"><a href="chp10_0.html#zonal-operations-and-functions"><i class="fa fa-check"></i><b>10.3</b> Zonal operations and functions</a></li>
<li class="chapter" data-level="10.4" data-path="chp10_0.html"><a href="chp10_0.html#global-operations-and-functions"><i class="fa fa-check"></i><b>10.4</b> Global operations and functions</a></li>
<li class="chapter" data-level="10.5" data-path="chp10_0.html"><a href="chp10_0.html#operators-and-functions"><i class="fa fa-check"></i><b>10.5</b> Operators and functions</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="chp10_0.html"><a href="chp10_0.html#mathematical-operators-and-functions"><i class="fa fa-check"></i><b>10.5.1</b> Mathematical operators and functions</a></li>
<li class="chapter" data-level="10.5.2" data-path="chp10_0.html"><a href="chp10_0.html#logical-comparison"><i class="fa fa-check"></i><b>10.5.2</b> Logical comparison</a></li>
<li class="chapter" data-level="10.5.3" data-path="chp10_0.html"><a href="chp10_0.html#boolean-or-logical-operators"><i class="fa fa-check"></i><b>10.5.3</b> Boolean (or Logical) operators</a></li>
<li class="chapter" data-level="10.5.4" data-path="chp10_0.html"><a href="chp10_0.html#combining-operations"><i class="fa fa-check"></i><b>10.5.4</b> Combining operations</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>PART 2: Spatial Analysis</b></span></li>
<li class="chapter" data-level="11" data-path="chp11_0.html"><a href="chp11_0.html"><i class="fa fa-check"></i><b>11</b> Point Pattern Analysis</a>
<ul>
<li class="chapter" data-level="11.1" data-path="chp11_0.html"><a href="chp11_0.html#centrography"><i class="fa fa-check"></i><b>11.1</b> Centrography</a></li>
<li class="chapter" data-level="11.2" data-path="chp11_0.html"><a href="chp11_0.html#density-based-analysis"><i class="fa fa-check"></i><b>11.2</b> Density based analysis</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="chp11_0.html"><a href="chp11_0.html#global-density"><i class="fa fa-check"></i><b>11.2.1</b> Global density</a></li>
<li class="chapter" data-level="11.2.2" data-path="chp11_0.html"><a href="chp11_0.html#local-density"><i class="fa fa-check"></i><b>11.2.2</b> Local density</a></li>
<li class="chapter" data-level="11.2.3" data-path="chp11_0.html"><a href="chp11_0.html#modeling-intensity-as-a-function-of-a-covariate"><i class="fa fa-check"></i><b>11.2.3</b> Modeling intensity as a function of a covariate</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="chp11_0.html"><a href="chp11_0.html#distance-based-analysis"><i class="fa fa-check"></i><b>11.3</b> Distance based analysis</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="chp11_0.html"><a href="chp11_0.html#average-nearest-neighbor"><i class="fa fa-check"></i><b>11.3.1</b> Average Nearest Neighbor</a></li>
<li class="chapter" data-level="11.3.2" data-path="chp11_0.html"><a href="chp11_0.html#k-and-l-functions"><i class="fa fa-check"></i><b>11.3.2</b> K and L functions</a></li>
<li class="chapter" data-level="11.3.3" data-path="chp11_0.html"><a href="chp11_0.html#the-pair-correlation-function-g"><i class="fa fa-check"></i><b>11.3.3</b> The Pair Correlation Function <span class="math inline">\(g\)</span></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="chp11_0.html"><a href="chp11_0.html#first-and-second-order-effects"><i class="fa fa-check"></i><b>11.4</b> First and second order effects</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>12</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="12.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#irpcsr"><i class="fa fa-check"></i><b>12.1</b> IRP/CSR</a></li>
<li class="chapter" data-level="12.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#testing-for-csr-with-the-ann-tool"><i class="fa fa-check"></i><b>12.2</b> Testing for CSR with the ANN tool</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#arcgis-average-nearest-neighbor-tool"><i class="fa fa-check"></i><b>12.2.1</b> ArcGIS’ Average Nearest Neighbor Tool</a></li>
<li class="chapter" data-level="12.2.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#a-better-approach-a-monte-carlo-test"><i class="fa fa-check"></i><b>12.2.2</b> A better approach: a Monte Carlo test</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#alternatives-to-csrirp"><i class="fa fa-check"></i><b>12.3</b> Alternatives to CSR/IRP</a></li>
<li class="chapter" data-level="12.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#monte-carlo-test-with-k-and-l-functions"><i class="fa fa-check"></i><b>12.4</b> Monte Carlo test with K and L functions</a></li>
<li class="chapter" data-level="12.5" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#PPM"><i class="fa fa-check"></i><b>12.5</b> Testing for a covariate effect</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html"><i class="fa fa-check"></i><b>13</b> Spatial Autocorrelation</a>
<ul>
<li class="chapter" data-level="13.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#global-morans-i"><i class="fa fa-check"></i><b>13.1</b> Global Moran’s <em>I</em></a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#computing-the-morans-i"><i class="fa fa-check"></i><b>13.1.1</b> Computing the Moran’s <em>I</em></a></li>
<li class="chapter" data-level="13.1.2" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#monte-carlo-approach-to-estimating-significance"><i class="fa fa-check"></i><b>13.1.2</b> Monte Carlo approach to estimating significance</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#morans-i-at-different-lags"><i class="fa fa-check"></i><b>13.2</b> Moran’s <em>I</em> at different lags</a></li>
<li class="chapter" data-level="13.3" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#local-morans-i"><i class="fa fa-check"></i><b>13.3</b> Local Moran’s <em>I</em></a></li>
<li class="chapter" data-level="13.4" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#morans-i-equation-explained"><i class="fa fa-check"></i><b>13.4</b> Moran’s <em>I</em> equation explained</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#local-morans-i-1"><i class="fa fa-check"></i><b>13.4.1</b> Local Moran’s I</a></li>
<li class="chapter" data-level="13.4.2" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#global-morans-i-1"><i class="fa fa-check"></i><b>13.4.2</b> Global Moran’s I</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html"><i class="fa fa-check"></i><b>14</b> Spatial Interpolation</a>
<ul>
<li class="chapter" data-level="14.1" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#deterministic-approach-to-interpolation"><i class="fa fa-check"></i><b>14.1</b> Deterministic Approach to Interpolation</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#proximity-interpolation"><i class="fa fa-check"></i><b>14.1.1</b> Proximity interpolation</a></li>
<li class="chapter" data-level="14.1.2" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#inverse-distance-weighted-idw"><i class="fa fa-check"></i><b>14.1.2</b> Inverse Distance Weighted (IDW)</a></li>
<li class="chapter" data-level="14.1.3" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#fine-tuning-the-interpolation-parameters"><i class="fa fa-check"></i><b>14.1.3</b> Fine tuning the interpolation parameters</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#statistical-approach-to-interpolation"><i class="fa fa-check"></i><b>14.2</b> Statistical Approach to Interpolation</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#trend-surfaces"><i class="fa fa-check"></i><b>14.2.1</b> Trend Surfaces</a></li>
<li class="chapter" data-level="14.2.2" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#ordinary-kriging"><i class="fa fa-check"></i><b>14.2.2</b> Ordinary Kriging</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>15</b> References</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html"><i class="fa fa-check"></i><b>A</b> Reading and writing spatial data in R</a>
<ul>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_2"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_3"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_4"><i class="fa fa-check"></i>Creating spatial objects</a>
<ul>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_4_1"><i class="fa fa-check"></i>Reading a shapefile</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_4_2"><i class="fa fa-check"></i>Reading a GeoPackage</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_4_3"><i class="fa fa-check"></i>Reading a raster</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_4_5"><i class="fa fa-check"></i>Creating a spatial object from a data frame</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_4_6"><i class="fa fa-check"></i>Geocoding street addresses</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_5"><i class="fa fa-check"></i>Converting from an <code>sf</code> object</a>
<ul>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_5_1"><i class="fa fa-check"></i>Converting an <code>sf</code> object to a <code>Spatial*</code> object (<code>spdep</code>/<code>sp</code>)</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_5_2"><i class="fa fa-check"></i>Converting an <code>sf</code> polygon object to an <code>owin</code> object</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_5_3"><i class="fa fa-check"></i>Converting an <code>sf</code> point object to a <code>ppp</code> object</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_5_4"><i class="fa fa-check"></i>Converting a <code>SpatRaster</code> object to an <code>im</code> object</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_6"><i class="fa fa-check"></i>Converting to an <code>sf</code> object</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_7"><i class="fa fa-check"></i>Dissecting the <code>sf</code> file object</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_8"><i class="fa fa-check"></i>Exporting to different data file formats</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html"><i class="fa fa-check"></i><b>B</b> Mapping data in R</a>
<ul>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#sample-files-for-this-exercise"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#tmap"><i class="fa fa-check"></i><code>tmap</code></a>
<ul>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#the-basics"><i class="fa fa-check"></i>The basics</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#combining-layers"><i class="fa fa-check"></i>Combining layers</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#tweaking-classification-schemes"><i class="fa fa-check"></i>Tweaking classification schemes</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#tweaking-colors"><i class="fa fa-check"></i>Tweaking colors</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#adding-labels"><i class="fa fa-check"></i>Adding labels</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#adding-a-grid-or-graticule"><i class="fa fa-check"></i>Adding a grid or graticule</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#adding-statistical-plots"><i class="fa fa-check"></i>Adding statistical plots</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#mapping-raster-files"><i class="fa fa-check"></i>Mapping raster files</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#changing-coordinate-systems"><i class="fa fa-check"></i>Changing coordinate systems</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#side-by-side-maps"><i class="fa fa-check"></i>Side-by-side maps</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#splitting-data-by-polygons-or-group-of-polygons"><i class="fa fa-check"></i>Splitting data by polygons or group of polygons</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#ggplot2"><i class="fa fa-check"></i><code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#the-basics-1"><i class="fa fa-check"></i>The basics</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#tweaking-classification-schemes-1"><i class="fa fa-check"></i>Tweaking classification schemes</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#combining-layers-1"><i class="fa fa-check"></i>Combining layers</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#plot_sf"><i class="fa fa-check"></i><code>plot_sf</code></a>
<ul>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#the-basics-2"><i class="fa fa-check"></i>The basics</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#adding-a-graticule"><i class="fa fa-check"></i>Adding a graticule</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#combining-layers-2"><i class="fa fa-check"></i>Combining layers</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#tweaking-colors-1"><i class="fa fa-check"></i>Tweaking colors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html"><i class="fa fa-check"></i><b>C</b> Anatomy of simple feature objects</a>
<ul>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#creating-point-sf-objects"><i class="fa fa-check"></i>Creating point ‘sf’ objects</a>
<ul>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#step-1-create-the-point-geometry-sfg"><i class="fa fa-check"></i>Step 1: Create the point geometry: <code>sfg</code></a></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#step-2-create-a-column-of-simple-feature-geometries-sfc"><i class="fa fa-check"></i>Step 2: Create a column of simple feature geometries: <code>sfc</code></a></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#step-3-create-the-simple-feature-object-sf"><i class="fa fa-check"></i>Step 3: Create the simple feature object <code>sf</code></a></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#renaming-the-geometry-column"><i class="fa fa-check"></i>Renaming the geometry column</a></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#adding-attributes-to-an-sf-object"><i class="fa fa-check"></i>Adding attributes to an <code>sf</code> object</a></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#adding-a-geometry-column-to-an-existing-non-spatial-dataframe"><i class="fa fa-check"></i>Adding a geometry column to an existing non-spatial dataframe</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#creating-polyline-sf-objects"><i class="fa fa-check"></i>Creating polyline ‘sf’ objects</a>
<ul>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#creating-branching-polyline-features"><i class="fa fa-check"></i>Creating branching polyline features</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#creating-polygon-sf-objects"><i class="fa fa-check"></i>Creating polygon ‘sf’ objects</a>
<ul>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#polygon-simple-feature"><i class="fa fa-check"></i><code>POLYGON</code> simple feature</a></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#multipolygon-simple-feature-multipart-features"><i class="fa fa-check"></i><code>MULTIPOLYGON</code> simple feature: multipart features</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#extracting-geometry-from-an-sf-object"><i class="fa fa-check"></i>Extracting geometry from an <code>sf</code> object</a></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#alternative-syntax"><i class="fa fa-check"></i>Alternative syntax</a></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#additional-resources"><i class="fa fa-check"></i>Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html"><i class="fa fa-check"></i><b>D</b> Vector operations in R</a>
<ul>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#dissolving-geometries"><i class="fa fa-check"></i>Dissolving geometries</a>
<ul>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#dissolving-by-contiguous-shape"><i class="fa fa-check"></i>Dissolving by contiguous shape</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#dissolving-by-attribute"><i class="fa fa-check"></i>Dissolving by attribute</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#subsetting-by-attribute"><i class="fa fa-check"></i>Subsetting by attribute</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#intersecting-layers"><i class="fa fa-check"></i>Intersecting layers</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#clipping-spatial-objects-using-other-spatial-objects"><i class="fa fa-check"></i>Clipping spatial objects using other spatial objects</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#unioning-layers"><i class="fa fa-check"></i>Unioning layers</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#buffering-geometries"><i class="fa fa-check"></i>Buffering geometries</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html"><i class="fa fa-check"></i><b>E</b> Mapping rates in R</a>
<ul>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#raw-rates"><i class="fa fa-check"></i>Raw Rates</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#standardized-mortality-ratios-relative-risk"><i class="fa fa-check"></i>Standardized mortality ratios (relative risk)</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#dykes-and-unwins-chi-square-statistic"><i class="fa fa-check"></i>Dykes and Unwin’s chi-square statistic</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#unstable-ratios"><i class="fa fa-check"></i>Unstable ratios</a>
<ul>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#global-empirical-bayes-eb-rate-estimate"><i class="fa fa-check"></i>Global Empirical Bayes (EB) rate estimate</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#local-empirical-bayes-eb-rate-estimate"><i class="fa fa-check"></i>Local Empirical Bayes (EB) rate estimate</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="F" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html"><i class="fa fa-check"></i><b>F</b> Raster operations in R</a>
<ul>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#sample-files-for-this-exercise-1"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#local-operations-and-functions-1"><i class="fa fa-check"></i>Local operations and functions</a>
<ul>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#unary-operations-and-functions-applied-to-single-rasters"><i class="fa fa-check"></i>Unary operations and functions (applied to single rasters)</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#binary-operations-and-functions-where-two-rasters-are-used"><i class="fa fa-check"></i>Binary operations and functions (where two rasters are used)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#focal-operations-and-functions-1"><i class="fa fa-check"></i>Focal operations and functions</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#zonal-operations-and-functions-1"><i class="fa fa-check"></i>Zonal operations and functions</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#global-operations-and-functions-1"><i class="fa fa-check"></i>Global operations and functions</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#computing-cumulative-distances"><i class="fa fa-check"></i>Computing cumulative distances</a>
<ul>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#working-example"><i class="fa fa-check"></i>Working example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="G" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html"><i class="fa fa-check"></i><b>G</b> Coordinate Systems in R</a>
<ul>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#a-note-about-the-changes-to-the-proj-environment"><i class="fa fa-check"></i>A note about the changes to the <code>PROJ</code> environment</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#sample-files-for-this-exercise-2"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#loading-the-sf-package"><i class="fa fa-check"></i>Loading the <code>sf</code> package</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#checking-for-a-coordinate-system"><i class="fa fa-check"></i>Checking for a coordinate system</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#understanding-the-proj4-coordinate-syntax"><i class="fa fa-check"></i>Understanding the Proj4 coordinate syntax</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#assigning-a-coordinate-system"><i class="fa fa-check"></i>Assigning a coordinate system</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#transforming-coordinate-systems"><i class="fa fa-check"></i>Transforming coordinate systems</a>
<ul>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#reprojecting-to-a-new-meridian-center"><i class="fa fa-check"></i>Reprojecting to a new meridian center</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#a-note-about-containment"><i class="fa fa-check"></i>A note about containment</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#creating-tissot-indicatrix-circles"><i class="fa fa-check"></i>Creating Tissot indicatrix circles</a></li>
</ul></li>
<li class="chapter" data-level="H" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html"><i class="fa fa-check"></i><b>H</b> Point pattern analysis in R</a>
<ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#sample-files-for-this-exercise-3"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#prepping-the-data"><i class="fa fa-check"></i>Prepping the data</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#density-based-analysis-1"><i class="fa fa-check"></i>Density based analysis</a>
<ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#quadrat-density-1"><i class="fa fa-check"></i>Quadrat density</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#quadrat-density-on-a-tessellated-surface"><i class="fa fa-check"></i>Quadrat density on a tessellated surface</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#kernel-density-raster"><i class="fa fa-check"></i>Kernel density raster</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#kernel-density-adjusted-for-covariate-1"><i class="fa fa-check"></i>Kernel density adjusted for covariate</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#modeling-intensity-as-a-function-of-a-covariate-1"><i class="fa fa-check"></i>Modeling intensity as a function of a covariate</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#distance-based-analysis-1"><i class="fa fa-check"></i>Distance based analysis</a>
<ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#average-nearest-neighbor-analysis"><i class="fa fa-check"></i>Average nearest neighbor analysis</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#k-and-l-functions-1"><i class="fa fa-check"></i>K and L functions</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pair-correlation-function-g"><i class="fa fa-check"></i>Pair correlation function g</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#hypothesis-tests"><i class="fa fa-check"></i>Hypothesis tests</a>
<ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#test-for-clusteringdispersion"><i class="fa fa-check"></i>Test for clustering/dispersion</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#computing-a-pseudo-p-value-from-the-simulation"><i class="fa fa-check"></i>Computing a pseudo p-value from the simulation</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#test-for-a-poisson-point-process-model-with-a-covariate-effect"><i class="fa fa-check"></i>Test for a poisson point process model with a covariate effect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="I" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html"><i class="fa fa-check"></i><b>I</b> Spatial autocorrelation in R</a>
<ul>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_1"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_2"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_3"><i class="fa fa-check"></i>Define neighboring polygons</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_4"><i class="fa fa-check"></i>Computing the Moran’s I statistic: the hard way</a>
<ul>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#computing-a-pseudo-p-value-from-an-mc-simulation"><i class="fa fa-check"></i>Computing a pseudo p-value from an MC simulation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_5"><i class="fa fa-check"></i>Computing the Moran’s I statistic: the easy way</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_6"><i class="fa fa-check"></i>Moran’s I as a function of a distance band</a></li>
</ul></li>
<li class="chapter" data-level="J" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html"><i class="fa fa-check"></i><b>J</b> Interpolation in R</a>
<ul>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#thiessen-polygons"><i class="fa fa-check"></i>Thiessen polygons</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#idw"><i class="fa fa-check"></i>IDW</a>
<ul>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#fine-tuning-the-interpolation"><i class="fa fa-check"></i>Fine-tuning the interpolation</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#cross-validation"><i class="fa fa-check"></i>Cross-validation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#st-order-polynomial-fit"><i class="fa fa-check"></i>1<sup>st</sup> order polynomial fit</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#nd-order-polynomial"><i class="fa fa-check"></i>2<sup>nd</sup> order polynomial</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#kriging"><i class="fa fa-check"></i>Kriging</a>
<ul>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#fit-the-variogram-model"><i class="fa fa-check"></i>Fit the variogram model</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#generate-kriged-surface"><i class="fa fa-check"></i>Generate Kriged surface</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#generate-the-variance-and-confidence-interval-maps"><i class="fa fa-check"></i>Generate the variance and confidence interval maps</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Intro to GIS and Spatial Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="interpolation-in-r" class="section level1 hasAnchor" number="25">
<h1><span class="header-section-number">J</span> Interpolation in R<a href="interpolation-in-r.html#interpolation-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<table class="package_ver_table">
<tbody>
<tr>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
R
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
sf
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
tmap
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
spatstat
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
gstat
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
terra
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
sp
</td>
</tr>
<tr>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
4.3.2
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
1.0.14
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
3.3.4
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
3.0.7
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
2.1.1
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
1.7.55
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
2.1.1
</td>
</tr>
</tbody>
</table>
<p>First, let’s load the data from the website. The data are vector layers stored as <code>sf</code> objects.</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="interpolation-in-r.html#cb429-1" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb429-2"><a href="interpolation-in-r.html#cb429-2" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb429-3"><a href="interpolation-in-r.html#cb429-3" tabindex="-1"></a></span>
<span id="cb429-4"><a href="interpolation-in-r.html#cb429-4" tabindex="-1"></a><span class="co"># Load precipitation data</span></span>
<span id="cb429-5"><a href="interpolation-in-r.html#cb429-5" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">gzcon</span>(<span class="fu">url</span>(<span class="st">&quot;https://github.com/mgimond/Spatial/raw/main/Data/precip.rds&quot;</span>))</span>
<span id="cb429-6"><a href="interpolation-in-r.html#cb429-6" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(z)</span>
<span id="cb429-7"><a href="interpolation-in-r.html#cb429-7" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(P)</span>
<span id="cb429-8"><a href="interpolation-in-r.html#cb429-8" tabindex="-1"></a><span class="co"># Load Texas boudary map</span></span>
<span id="cb429-9"><a href="interpolation-in-r.html#cb429-9" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">gzcon</span>(<span class="fu">url</span>(<span class="st">&quot;https://github.com/mgimond/Spatial/raw/main/Data/texas.rds&quot;</span>))</span>
<span id="cb429-10"><a href="interpolation-in-r.html#cb429-10" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(z)</span>
<span id="cb429-11"><a href="interpolation-in-r.html#cb429-11" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(W)</span>
<span id="cb429-12"><a href="interpolation-in-r.html#cb429-12" tabindex="-1"></a></span>
<span id="cb429-13"><a href="interpolation-in-r.html#cb429-13" tabindex="-1"></a><span class="co"># # Replace point boundary extent with that of Texas</span></span>
<span id="cb429-14"><a href="interpolation-in-r.html#cb429-14" tabindex="-1"></a></span>
<span id="cb429-15"><a href="interpolation-in-r.html#cb429-15" tabindex="-1"></a><span class="fu">tm_shape</span>(w) <span class="sc">+</span> <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb429-16"><a href="interpolation-in-r.html#cb429-16" tabindex="-1"></a>  <span class="fu">tm_shape</span>(p) <span class="sc">+</span></span>
<span id="cb429-17"><a href="interpolation-in-r.html#cb429-17" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">&quot;Precip_in&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="at">auto.palette.mapping =</span> <span class="cn">FALSE</span>,</span>
<span id="cb429-18"><a href="interpolation-in-r.html#cb429-18" tabindex="-1"></a>             <span class="at">title=</span><span class="st">&quot;Sampled precipitation </span><span class="sc">\n</span><span class="st">(in inches)&quot;</span>, <span class="at">size=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb429-19"><a href="interpolation-in-r.html#cb429-19" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">&quot;Precip_in&quot;</span>, <span class="at">just=</span><span class="st">&quot;left&quot;</span>, <span class="at">xmod=</span>.<span class="dv">5</span>, <span class="at">size =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb429-20"><a href="interpolation-in-r.html#cb429-20" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">legend.outside=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="A10-Interpolation_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>The <code>p</code> point layer defines the sampled precipitation values. These points will be used to predict values at unsampled locations.</p>
<p>The <code>w</code> polygon layer defines the boundary of Texas. This will be the extent for which we will interpolate precipitation data.</p>
<div id="thiessen-polygons" class="section level2 unnumbered hasAnchor">
<h2>Thiessen polygons<a href="interpolation-in-r.html#thiessen-polygons" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Thiessen polygons (or proximity interpolation) can be created using <code>spatstat</code>’s <code>dirichlet</code> function. Note that this function will require that the input point layer be converted to a <code>spatstat</code> <code>ppp</code> object–hence the use of the inline <code>as.ppp(P)</code> syntax in the following code chunk.</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="interpolation-in-r.html#cb430-1" tabindex="-1"></a><span class="fu">library</span>(spatstat)  <span class="co"># Used for the dirichlet tessellation function</span></span>
<span id="cb430-2"><a href="interpolation-in-r.html#cb430-2" tabindex="-1"></a></span>
<span id="cb430-3"><a href="interpolation-in-r.html#cb430-3" tabindex="-1"></a><span class="co"># Create a tessellated surface</span></span>
<span id="cb430-4"><a href="interpolation-in-r.html#cb430-4" tabindex="-1"></a>th  <span class="ot">&lt;-</span> <span class="fu">dirichlet</span>(<span class="fu">as.ppp</span>(p)) <span class="sc">|&gt;</span> <span class="fu">st_as_sfc</span>() <span class="sc">|&gt;</span> <span class="fu">st_as_sf</span>()</span>
<span id="cb430-5"><a href="interpolation-in-r.html#cb430-5" tabindex="-1"></a></span>
<span id="cb430-6"><a href="interpolation-in-r.html#cb430-6" tabindex="-1"></a><span class="co"># The dirichlet function does not carry over projection information</span></span>
<span id="cb430-7"><a href="interpolation-in-r.html#cb430-7" tabindex="-1"></a><span class="co"># requiring that this information be added manually</span></span>
<span id="cb430-8"><a href="interpolation-in-r.html#cb430-8" tabindex="-1"></a><span class="fu">st_crs</span>(th) <span class="ot">&lt;-</span> <span class="fu">st_crs</span>(p)</span>
<span id="cb430-9"><a href="interpolation-in-r.html#cb430-9" tabindex="-1"></a></span>
<span id="cb430-10"><a href="interpolation-in-r.html#cb430-10" tabindex="-1"></a><span class="co"># The tessellated surface does not store attribute information</span></span>
<span id="cb430-11"><a href="interpolation-in-r.html#cb430-11" tabindex="-1"></a><span class="co"># from the point data layer. We&#39;ll join the point attributes to the polygons</span></span>
<span id="cb430-12"><a href="interpolation-in-r.html#cb430-12" tabindex="-1"></a>th2     <span class="ot">&lt;-</span> <span class="fu">st_join</span>(th, p, <span class="at">fn=</span>mean)</span>
<span id="cb430-13"><a href="interpolation-in-r.html#cb430-13" tabindex="-1"></a></span>
<span id="cb430-14"><a href="interpolation-in-r.html#cb430-14" tabindex="-1"></a><span class="co"># Finally, we&#39;ll clip the tessellated  surface to the Texas boundaries</span></span>
<span id="cb430-15"><a href="interpolation-in-r.html#cb430-15" tabindex="-1"></a>th.clp   <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(th2, w)</span>
<span id="cb430-16"><a href="interpolation-in-r.html#cb430-16" tabindex="-1"></a></span>
<span id="cb430-17"><a href="interpolation-in-r.html#cb430-17" tabindex="-1"></a><span class="co"># Map the data</span></span>
<span id="cb430-18"><a href="interpolation-in-r.html#cb430-18" tabindex="-1"></a><span class="fu">tm_shape</span>(th.clp) <span class="sc">+</span> </span>
<span id="cb430-19"><a href="interpolation-in-r.html#cb430-19" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col=</span><span class="st">&quot;Precip_in&quot;</span>, <span class="at">palette=</span><span class="st">&quot;RdBu&quot;</span>, </span>
<span id="cb430-20"><a href="interpolation-in-r.html#cb430-20" tabindex="-1"></a>              <span class="at">title=</span><span class="st">&quot;Predicted precipitation </span><span class="sc">\n</span><span class="st">(in inches)&quot;</span>) <span class="sc">+</span></span>
<span id="cb430-21"><a href="interpolation-in-r.html#cb430-21" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">legend.outside=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="A10-Interpolation_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div id="idw" class="section level2 unnumbered hasAnchor">
<h2>IDW<a href="interpolation-in-r.html#idw" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Unlike the Thiessen method shown in the previous section, the IDW interpolation will output a raster. This requires that we first create an empty raster grid, then interpolate the precipitation values to each unsampled grid cell. An IDW power value of 2 (<code>idp=2.0</code>) will be used in this example.</p>
<div class="warning">
<p>
Many packages share the same function names. This can be a problem
when these packages are loaded in a same R session. For example, the
<code>idw</code> function is available in both
<code>spatstat.explore</code> and <code>gstat</code>. Here, we make use
of <code>gstat</code>’s <code>idw</code> function. This requires that we
either detach the <code>spatstat.explore</code> package (this package
was automatically installed when we installed <code>spatstat</code>) or
that we explicitly identify the package by typing
<code>gstat::idw</code>. Here, we opted for the former approach.
</p>
</div>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="interpolation-in-r.html#cb431-1" tabindex="-1"></a><span class="fu">detach</span>(<span class="st">&quot;package:spatstat.explore&quot;</span>, <span class="at">unload =</span> <span class="cn">TRUE</span>, <span class="at">force=</span><span class="cn">TRUE</span>) </span>
<span id="cb431-2"><a href="interpolation-in-r.html#cb431-2" tabindex="-1"></a><span class="fu">library</span>(gstat) </span>
<span id="cb431-3"><a href="interpolation-in-r.html#cb431-3" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb431-4"><a href="interpolation-in-r.html#cb431-4" tabindex="-1"></a><span class="fu">library</span>(sp) </span>
<span id="cb431-5"><a href="interpolation-in-r.html#cb431-5" tabindex="-1"></a></span>
<span id="cb431-6"><a href="interpolation-in-r.html#cb431-6" tabindex="-1"></a><span class="co"># Create an empty grid where n is the total number of cells</span></span>
<span id="cb431-7"><a href="interpolation-in-r.html#cb431-7" tabindex="-1"></a>grd              <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">spsample</span>(P, <span class="st">&quot;regular&quot;</span>, <span class="at">n=</span><span class="dv">50000</span>))</span>
<span id="cb431-8"><a href="interpolation-in-r.html#cb431-8" tabindex="-1"></a><span class="fu">names</span>(grd)       <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb431-9"><a href="interpolation-in-r.html#cb431-9" tabindex="-1"></a><span class="fu">coordinates</span>(grd) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb431-10"><a href="interpolation-in-r.html#cb431-10" tabindex="-1"></a><span class="fu">gridded</span>(grd)     <span class="ot">&lt;-</span> <span class="cn">TRUE</span>  <span class="co"># Create SpatialPixel object</span></span>
<span id="cb431-11"><a href="interpolation-in-r.html#cb431-11" tabindex="-1"></a><span class="fu">fullgrid</span>(grd)    <span class="ot">&lt;-</span> <span class="cn">TRUE</span>  <span class="co"># Create SpatialGrid object</span></span>
<span id="cb431-12"><a href="interpolation-in-r.html#cb431-12" tabindex="-1"></a></span>
<span id="cb431-13"><a href="interpolation-in-r.html#cb431-13" tabindex="-1"></a><span class="co"># Add P&#39;s projection information to the empty grid</span></span>
<span id="cb431-14"><a href="interpolation-in-r.html#cb431-14" tabindex="-1"></a><span class="fu">crs</span>(grd) <span class="ot">&lt;-</span> <span class="fu">crs</span>(P)</span>
<span id="cb431-15"><a href="interpolation-in-r.html#cb431-15" tabindex="-1"></a></span>
<span id="cb431-16"><a href="interpolation-in-r.html#cb431-16" tabindex="-1"></a><span class="co"># Interpolate the grid cells using a power value of 2 (idp=2.0)</span></span>
<span id="cb431-17"><a href="interpolation-in-r.html#cb431-17" tabindex="-1"></a>P.idw <span class="ot">&lt;-</span> <span class="fu">idw</span>(Precip_in <span class="sc">~</span> <span class="dv">1</span>, P, <span class="at">newdata=</span>grd, <span class="at">idp =</span> <span class="fl">2.0</span>)</span>
<span id="cb431-18"><a href="interpolation-in-r.html#cb431-18" tabindex="-1"></a></span>
<span id="cb431-19"><a href="interpolation-in-r.html#cb431-19" tabindex="-1"></a><span class="co"># Convert to raster object then clip to Texas</span></span>
<span id="cb431-20"><a href="interpolation-in-r.html#cb431-20" tabindex="-1"></a>r       <span class="ot">&lt;-</span> <span class="fu">rast</span>(P.idw)</span>
<span id="cb431-21"><a href="interpolation-in-r.html#cb431-21" tabindex="-1"></a>r.m     <span class="ot">&lt;-</span> <span class="fu">mask</span>(r, <span class="fu">st_as_sf</span>(W))</span>
<span id="cb431-22"><a href="interpolation-in-r.html#cb431-22" tabindex="-1"></a></span>
<span id="cb431-23"><a href="interpolation-in-r.html#cb431-23" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb431-24"><a href="interpolation-in-r.html#cb431-24" tabindex="-1"></a><span class="fu">tm_shape</span>(r.m[<span class="st">&quot;var1.pred&quot;</span>]) <span class="sc">+</span> </span>
<span id="cb431-25"><a href="interpolation-in-r.html#cb431-25" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">n=</span><span class="dv">10</span>,<span class="at">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="at">auto.palette.mapping =</span> <span class="cn">FALSE</span>,</span>
<span id="cb431-26"><a href="interpolation-in-r.html#cb431-26" tabindex="-1"></a>            <span class="at">title=</span><span class="st">&quot;Predicted precipitation </span><span class="sc">\n</span><span class="st">(in inches)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb431-27"><a href="interpolation-in-r.html#cb431-27" tabindex="-1"></a>  <span class="fu">tm_shape</span>(P) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">size=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb431-28"><a href="interpolation-in-r.html#cb431-28" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">legend.outside=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="A10-Interpolation_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div id="fine-tuning-the-interpolation" class="section level3 unnumbered hasAnchor">
<h3>Fine-tuning the interpolation<a href="interpolation-in-r.html#fine-tuning-the-interpolation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The choice of power function can be subjective. To fine-tune the choice of the power parameter, you can perform a <em>leave-one-out</em> validation routine to measure the error in the interpolated values.</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="interpolation-in-r.html#cb432-1" tabindex="-1"></a><span class="co"># Leave-one-out validation routine</span></span>
<span id="cb432-2"><a href="interpolation-in-r.html#cb432-2" tabindex="-1"></a>IDW.out <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="fu">length</span>(P))</span>
<span id="cb432-3"><a href="interpolation-in-r.html#cb432-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(P)) {</span>
<span id="cb432-4"><a href="interpolation-in-r.html#cb432-4" tabindex="-1"></a>  IDW.out[i] <span class="ot">&lt;-</span> <span class="fu">idw</span>(Precip_in <span class="sc">~</span> <span class="dv">1</span>, P[<span class="sc">-</span>i,], P[i,], <span class="at">idp=</span><span class="fl">2.0</span>)<span class="sc">$</span>var1.pred</span>
<span id="cb432-5"><a href="interpolation-in-r.html#cb432-5" tabindex="-1"></a>}</span>
<span id="cb432-6"><a href="interpolation-in-r.html#cb432-6" tabindex="-1"></a></span>
<span id="cb432-7"><a href="interpolation-in-r.html#cb432-7" tabindex="-1"></a><span class="co"># Plot the differences</span></span>
<span id="cb432-8"><a href="interpolation-in-r.html#cb432-8" tabindex="-1"></a>OP <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">pty=</span><span class="st">&quot;s&quot;</span>, <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb432-9"><a href="interpolation-in-r.html#cb432-9" tabindex="-1"></a>  <span class="fu">plot</span>(IDW.out <span class="sc">~</span> P<span class="sc">$</span>Precip_in, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">xlab=</span><span class="st">&quot;Observed&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Predicted&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>,</span>
<span id="cb432-10"><a href="interpolation-in-r.html#cb432-10" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>))</span>
<span id="cb432-11"><a href="interpolation-in-r.html#cb432-11" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="fu">lm</span>(IDW.out <span class="sc">~</span> P<span class="sc">$</span>Precip_in), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lw=</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb432-12"><a href="interpolation-in-r.html#cb432-12" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb432-13"><a href="interpolation-in-r.html#cb432-13" tabindex="-1"></a><span class="fu">par</span>(OP)</span></code></pre></div>
<p><img src="A10-Interpolation_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>The RMSE can be computed from <code>IDW.out</code> as follows:</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="interpolation-in-r.html#cb433-1" tabindex="-1"></a><span class="co"># Compute RMSE</span></span>
<span id="cb433-2"><a href="interpolation-in-r.html#cb433-2" tabindex="-1"></a><span class="fu">sqrt</span>( <span class="fu">sum</span>((IDW.out <span class="sc">-</span> P<span class="sc">$</span>Precip_in)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">length</span>(P))</span></code></pre></div>
<pre><code>[1] 6.989294</code></pre>
</div>
<div id="cross-validation" class="section level3 unnumbered hasAnchor">
<h3>Cross-validation<a href="interpolation-in-r.html#cross-validation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In addition to generating an interpolated surface, you can create a 95% confidence interval map of the interpolation model. Here we’ll create a 95% CI map from an IDW interpolation that uses a power parameter of 2 (<code>idp=2.0</code>).</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="interpolation-in-r.html#cb435-1" tabindex="-1"></a><span class="co"># Create the interpolated surface (using gstat&#39;s idw function)</span></span>
<span id="cb435-2"><a href="interpolation-in-r.html#cb435-2" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">idw</span>(Precip_in<span class="sc">~</span><span class="dv">1</span>, P, <span class="at">newdata=</span>grd, <span class="at">idp=</span><span class="fl">2.0</span>)</span>
<span id="cb435-3"><a href="interpolation-in-r.html#cb435-3" tabindex="-1"></a>n   <span class="ot">&lt;-</span> <span class="fu">length</span>(P)</span>
<span id="cb435-4"><a href="interpolation-in-r.html#cb435-4" tabindex="-1"></a>Zi  <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="fu">length</span>(img<span class="sc">$</span>var1.pred), <span class="at">ncol =</span> n)</span>
<span id="cb435-5"><a href="interpolation-in-r.html#cb435-5" tabindex="-1"></a></span>
<span id="cb435-6"><a href="interpolation-in-r.html#cb435-6" tabindex="-1"></a><span class="co"># Remove a point then interpolate (do this n times for each point)</span></span>
<span id="cb435-7"><a href="interpolation-in-r.html#cb435-7" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">rast</span>()</span>
<span id="cb435-8"><a href="interpolation-in-r.html#cb435-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb435-9"><a href="interpolation-in-r.html#cb435-9" tabindex="-1"></a>  Z1 <span class="ot">&lt;-</span> gstat<span class="sc">::</span><span class="fu">idw</span>(Precip_in<span class="sc">~</span><span class="dv">1</span>, P[<span class="sc">-</span>i,], <span class="at">newdata=</span>grd, <span class="at">idp=</span><span class="fl">2.0</span>)</span>
<span id="cb435-10"><a href="interpolation-in-r.html#cb435-10" tabindex="-1"></a>  st <span class="ot">&lt;-</span> <span class="fu">c</span>(st,<span class="fu">rast</span>(Z1))</span>
<span id="cb435-11"><a href="interpolation-in-r.html#cb435-11" tabindex="-1"></a>  <span class="co"># Calculated pseudo-value Z at j</span></span>
<span id="cb435-12"><a href="interpolation-in-r.html#cb435-12" tabindex="-1"></a>  Zi[,i] <span class="ot">&lt;-</span> n <span class="sc">*</span> img<span class="sc">$</span>var1.pred <span class="sc">-</span> (n<span class="dv">-1</span>) <span class="sc">*</span> Z1<span class="sc">$</span>var1.pred</span>
<span id="cb435-13"><a href="interpolation-in-r.html#cb435-13" tabindex="-1"></a>}</span>
<span id="cb435-14"><a href="interpolation-in-r.html#cb435-14" tabindex="-1"></a></span>
<span id="cb435-15"><a href="interpolation-in-r.html#cb435-15" tabindex="-1"></a><span class="co"># Jackknife estimator of parameter Z at location j</span></span>
<span id="cb435-16"><a href="interpolation-in-r.html#cb435-16" tabindex="-1"></a>Zj <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">apply</span>(Zi, <span class="dv">1</span>, sum, <span class="at">na.rm=</span>T) <span class="sc">/</span> n )</span>
<span id="cb435-17"><a href="interpolation-in-r.html#cb435-17" tabindex="-1"></a></span>
<span id="cb435-18"><a href="interpolation-in-r.html#cb435-18" tabindex="-1"></a><span class="co"># Compute (Zi* - Zj)^2</span></span>
<span id="cb435-19"><a href="interpolation-in-r.html#cb435-19" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">apply</span>(Zi,<span class="dv">2</span>,<span class="st">&#39;-&#39;</span>,Zj)            <span class="co"># Compute the difference</span></span>
<span id="cb435-20"><a href="interpolation-in-r.html#cb435-20" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">apply</span>(c1<span class="sc">^</span><span class="dv">2</span>, <span class="dv">1</span>, sum, <span class="at">na.rm=</span>T ) <span class="co"># Sum the square of the difference</span></span>
<span id="cb435-21"><a href="interpolation-in-r.html#cb435-21" tabindex="-1"></a></span>
<span id="cb435-22"><a href="interpolation-in-r.html#cb435-22" tabindex="-1"></a><span class="co"># Compute the confidence interval</span></span>
<span id="cb435-23"><a href="interpolation-in-r.html#cb435-23" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">sqrt</span>( <span class="dv">1</span><span class="sc">/</span>(n<span class="sc">*</span>(n<span class="dv">-1</span>)) <span class="sc">*</span> c1)</span>
<span id="cb435-24"><a href="interpolation-in-r.html#cb435-24" tabindex="-1"></a></span>
<span id="cb435-25"><a href="interpolation-in-r.html#cb435-25" tabindex="-1"></a><span class="co"># Create (CI / interpolated value) raster</span></span>
<span id="cb435-26"><a href="interpolation-in-r.html#cb435-26" tabindex="-1"></a>img.sig   <span class="ot">&lt;-</span> img</span>
<span id="cb435-27"><a href="interpolation-in-r.html#cb435-27" tabindex="-1"></a>img.sig<span class="sc">$</span>v <span class="ot">&lt;-</span> CI <span class="sc">/</span>img<span class="sc">$</span>var1.pred </span>
<span id="cb435-28"><a href="interpolation-in-r.html#cb435-28" tabindex="-1"></a></span>
<span id="cb435-29"><a href="interpolation-in-r.html#cb435-29" tabindex="-1"></a><span class="co"># Clip the confidence raster to Texas</span></span>
<span id="cb435-30"><a href="interpolation-in-r.html#cb435-30" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">rast</span>(img.sig, <span class="at">layer=</span><span class="st">&quot;v&quot;</span>)</span>
<span id="cb435-31"><a href="interpolation-in-r.html#cb435-31" tabindex="-1"></a>r.m <span class="ot">&lt;-</span> <span class="fu">mask</span>(r, <span class="fu">st_as_sf</span>(W))</span>
<span id="cb435-32"><a href="interpolation-in-r.html#cb435-32" tabindex="-1"></a></span>
<span id="cb435-33"><a href="interpolation-in-r.html#cb435-33" tabindex="-1"></a><span class="co"># Plot the map</span></span>
<span id="cb435-34"><a href="interpolation-in-r.html#cb435-34" tabindex="-1"></a><span class="fu">tm_shape</span>(r.m[<span class="st">&quot;var1.pred&quot;</span>]) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">n=</span><span class="dv">7</span>,<span class="at">title=</span><span class="st">&quot;95% confidence interval </span><span class="sc">\n</span><span class="st">(in inches)&quot;</span>) <span class="sc">+</span></span>
<span id="cb435-35"><a href="interpolation-in-r.html#cb435-35" tabindex="-1"></a>  <span class="fu">tm_shape</span>(P) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">size=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb435-36"><a href="interpolation-in-r.html#cb435-36" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">legend.outside=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="A10-Interpolation_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
</div>
<div id="st-order-polynomial-fit" class="section level2 unnumbered hasAnchor">
<h2>1<sup>st</sup> order polynomial fit<a href="interpolation-in-r.html#st-order-polynomial-fit" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To fit a first order polynomial model of the form <span class="math inline">\(precip = intercept + aX + bY\)</span> to the data,</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="interpolation-in-r.html#cb436-1" tabindex="-1"></a><span class="co"># Define the 1st order polynomial equation</span></span>
<span id="cb436-2"><a href="interpolation-in-r.html#cb436-2" tabindex="-1"></a>f<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(Precip_in <span class="sc">~</span> X <span class="sc">+</span> Y) </span>
<span id="cb436-3"><a href="interpolation-in-r.html#cb436-3" tabindex="-1"></a> </span>
<span id="cb436-4"><a href="interpolation-in-r.html#cb436-4" tabindex="-1"></a><span class="co"># Add X and Y to P</span></span>
<span id="cb436-5"><a href="interpolation-in-r.html#cb436-5" tabindex="-1"></a>P<span class="sc">$</span>X <span class="ot">&lt;-</span> <span class="fu">coordinates</span>(P)[,<span class="dv">1</span>]</span>
<span id="cb436-6"><a href="interpolation-in-r.html#cb436-6" tabindex="-1"></a>P<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">coordinates</span>(P)[,<span class="dv">2</span>]</span>
<span id="cb436-7"><a href="interpolation-in-r.html#cb436-7" tabindex="-1"></a></span>
<span id="cb436-8"><a href="interpolation-in-r.html#cb436-8" tabindex="-1"></a><span class="co"># Run the regression model</span></span>
<span id="cb436-9"><a href="interpolation-in-r.html#cb436-9" tabindex="-1"></a>lm<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>( f<span class="fl">.1</span>, <span class="at">data=</span>P)</span>
<span id="cb436-10"><a href="interpolation-in-r.html#cb436-10" tabindex="-1"></a></span>
<span id="cb436-11"><a href="interpolation-in-r.html#cb436-11" tabindex="-1"></a><span class="co"># Use the regression model output to interpolate the surface</span></span>
<span id="cb436-12"><a href="interpolation-in-r.html#cb436-12" tabindex="-1"></a>dat<span class="fl">.1</span>st <span class="ot">&lt;-</span> <span class="fu">SpatialGridDataFrame</span>(grd, <span class="fu">data.frame</span>(<span class="at">var1.pred =</span> <span class="fu">predict</span>(lm<span class="fl">.1</span>, <span class="at">newdata=</span>grd))) </span>
<span id="cb436-13"><a href="interpolation-in-r.html#cb436-13" tabindex="-1"></a></span>
<span id="cb436-14"><a href="interpolation-in-r.html#cb436-14" tabindex="-1"></a><span class="co"># Clip the interpolated raster to Texas</span></span>
<span id="cb436-15"><a href="interpolation-in-r.html#cb436-15" tabindex="-1"></a>r   <span class="ot">&lt;-</span> <span class="fu">rast</span>(dat<span class="fl">.1</span>st)</span>
<span id="cb436-16"><a href="interpolation-in-r.html#cb436-16" tabindex="-1"></a>r.m <span class="ot">&lt;-</span> <span class="fu">mask</span>(r, <span class="fu">st_as_sf</span>(W))</span>
<span id="cb436-17"><a href="interpolation-in-r.html#cb436-17" tabindex="-1"></a></span>
<span id="cb436-18"><a href="interpolation-in-r.html#cb436-18" tabindex="-1"></a><span class="co"># Plot the map</span></span>
<span id="cb436-19"><a href="interpolation-in-r.html#cb436-19" tabindex="-1"></a><span class="fu">tm_shape</span>(r.m) <span class="sc">+</span> </span>
<span id="cb436-20"><a href="interpolation-in-r.html#cb436-20" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">palette=</span><span class="st">&quot;RdBu&quot;</span>, </span>
<span id="cb436-21"><a href="interpolation-in-r.html#cb436-21" tabindex="-1"></a>            <span class="at">title=</span><span class="st">&quot;Predicted precipitation </span><span class="sc">\n</span><span class="st">(in inches)&quot;</span>) <span class="sc">+</span></span>
<span id="cb436-22"><a href="interpolation-in-r.html#cb436-22" tabindex="-1"></a>  <span class="fu">tm_shape</span>(P) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">size=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb436-23"><a href="interpolation-in-r.html#cb436-23" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">legend.outside=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="A10-Interpolation_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="nd-order-polynomial" class="section level2 unnumbered hasAnchor">
<h2>2<sup>nd</sup> order polynomial<a href="interpolation-in-r.html#nd-order-polynomial" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To fit a second order polynomial model of the form <span class="math inline">\(precip = intercept + aX + bY + dX^2 + eY^2 +fXY\)</span> to the data,</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="interpolation-in-r.html#cb437-1" tabindex="-1"></a><span class="co"># Define the 2nd order polynomial equation</span></span>
<span id="cb437-2"><a href="interpolation-in-r.html#cb437-2" tabindex="-1"></a>f<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(Precip_in <span class="sc">~</span> X <span class="sc">+</span> Y <span class="sc">+</span> <span class="fu">I</span>(X<span class="sc">*</span>X)<span class="sc">+</span><span class="fu">I</span>(Y<span class="sc">*</span>Y) <span class="sc">+</span> <span class="fu">I</span>(X<span class="sc">*</span>Y))</span>
<span id="cb437-3"><a href="interpolation-in-r.html#cb437-3" tabindex="-1"></a></span>
<span id="cb437-4"><a href="interpolation-in-r.html#cb437-4" tabindex="-1"></a><span class="co"># Add X and Y to P</span></span>
<span id="cb437-5"><a href="interpolation-in-r.html#cb437-5" tabindex="-1"></a>P<span class="sc">$</span>X <span class="ot">&lt;-</span> <span class="fu">coordinates</span>(P)[,<span class="dv">1</span>]</span>
<span id="cb437-6"><a href="interpolation-in-r.html#cb437-6" tabindex="-1"></a>P<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">coordinates</span>(P)[,<span class="dv">2</span>]</span>
<span id="cb437-7"><a href="interpolation-in-r.html#cb437-7" tabindex="-1"></a> </span>
<span id="cb437-8"><a href="interpolation-in-r.html#cb437-8" tabindex="-1"></a><span class="co"># Run the regression model</span></span>
<span id="cb437-9"><a href="interpolation-in-r.html#cb437-9" tabindex="-1"></a>lm<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>( f<span class="fl">.2</span>, <span class="at">data=</span>P)</span>
<span id="cb437-10"><a href="interpolation-in-r.html#cb437-10" tabindex="-1"></a></span>
<span id="cb437-11"><a href="interpolation-in-r.html#cb437-11" tabindex="-1"></a><span class="co"># Use the regression model output to interpolate the surface</span></span>
<span id="cb437-12"><a href="interpolation-in-r.html#cb437-12" tabindex="-1"></a>dat<span class="fl">.2</span>nd <span class="ot">&lt;-</span> <span class="fu">SpatialGridDataFrame</span>(grd, <span class="fu">data.frame</span>(<span class="at">var1.pred =</span> <span class="fu">predict</span>(lm<span class="fl">.2</span>, <span class="at">newdata=</span>grd))) </span>
<span id="cb437-13"><a href="interpolation-in-r.html#cb437-13" tabindex="-1"></a></span>
<span id="cb437-14"><a href="interpolation-in-r.html#cb437-14" tabindex="-1"></a><span class="co"># Clip the interpolated raster to Texas</span></span>
<span id="cb437-15"><a href="interpolation-in-r.html#cb437-15" tabindex="-1"></a>r   <span class="ot">&lt;-</span> <span class="fu">rast</span>(dat<span class="fl">.2</span>nd)</span>
<span id="cb437-16"><a href="interpolation-in-r.html#cb437-16" tabindex="-1"></a>r.m <span class="ot">&lt;-</span> <span class="fu">mask</span>(r, <span class="fu">st_as_sf</span>(W))</span>
<span id="cb437-17"><a href="interpolation-in-r.html#cb437-17" tabindex="-1"></a></span>
<span id="cb437-18"><a href="interpolation-in-r.html#cb437-18" tabindex="-1"></a><span class="co"># Plot the map</span></span>
<span id="cb437-19"><a href="interpolation-in-r.html#cb437-19" tabindex="-1"></a><span class="fu">tm_shape</span>(r.m) <span class="sc">+</span> </span>
<span id="cb437-20"><a href="interpolation-in-r.html#cb437-20" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">palette=</span><span class="st">&quot;RdBu&quot;</span>, </span>
<span id="cb437-21"><a href="interpolation-in-r.html#cb437-21" tabindex="-1"></a>            <span class="at">title=</span><span class="st">&quot;Predicted precipitation </span><span class="sc">\n</span><span class="st">(in inches)&quot;</span>) <span class="sc">+</span></span>
<span id="cb437-22"><a href="interpolation-in-r.html#cb437-22" tabindex="-1"></a>  <span class="fu">tm_shape</span>(P) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">size=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb437-23"><a href="interpolation-in-r.html#cb437-23" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">legend.outside=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="A10-Interpolation_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
<div id="kriging" class="section level2 unnumbered hasAnchor">
<h2>Kriging<a href="interpolation-in-r.html#kriging" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="fit-the-variogram-model" class="section level3 unnumbered hasAnchor">
<h3>Fit the variogram model<a href="interpolation-in-r.html#fit-the-variogram-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, we need to create a variogram model. Note that the variogram model is computed on the <strong>de-trended</strong> data. This is implemented in the following chunk of code by passing the 1<sup>st</sup> order trend model (defined in an earlier code chunk as formula object <code>f.1</code>) to the <code>variogram</code> function.</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="interpolation-in-r.html#cb438-1" tabindex="-1"></a><span class="co"># Define the 1st order polynomial equation</span></span>
<span id="cb438-2"><a href="interpolation-in-r.html#cb438-2" tabindex="-1"></a>f<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(Precip_in <span class="sc">~</span> X <span class="sc">+</span> Y) </span>
<span id="cb438-3"><a href="interpolation-in-r.html#cb438-3" tabindex="-1"></a></span>
<span id="cb438-4"><a href="interpolation-in-r.html#cb438-4" tabindex="-1"></a><span class="co"># Compute the sample variogram; note that the f.1 trend model is one of the</span></span>
<span id="cb438-5"><a href="interpolation-in-r.html#cb438-5" tabindex="-1"></a><span class="co"># parameters passed to variogram(). This tells the function to create the </span></span>
<span id="cb438-6"><a href="interpolation-in-r.html#cb438-6" tabindex="-1"></a><span class="co"># variogram on the de-trended data.</span></span>
<span id="cb438-7"><a href="interpolation-in-r.html#cb438-7" tabindex="-1"></a>var.smpl <span class="ot">&lt;-</span> <span class="fu">variogram</span>(f<span class="fl">.1</span>, P, <span class="at">cloud =</span> <span class="cn">FALSE</span>, <span class="at">cutoff=</span><span class="dv">1000000</span>, <span class="at">width=</span><span class="dv">89900</span>)</span>
<span id="cb438-8"><a href="interpolation-in-r.html#cb438-8" tabindex="-1"></a></span>
<span id="cb438-9"><a href="interpolation-in-r.html#cb438-9" tabindex="-1"></a><span class="co"># Compute the variogram model by passing the nugget, sill and range values</span></span>
<span id="cb438-10"><a href="interpolation-in-r.html#cb438-10" tabindex="-1"></a><span class="co"># to fit.variogram() via the vgm() function.</span></span>
<span id="cb438-11"><a href="interpolation-in-r.html#cb438-11" tabindex="-1"></a>dat.fit  <span class="ot">&lt;-</span> <span class="fu">fit.variogram</span>(var.smpl, <span class="at">fit.ranges =</span> <span class="cn">FALSE</span>, <span class="at">fit.sills =</span> <span class="cn">FALSE</span>,</span>
<span id="cb438-12"><a href="interpolation-in-r.html#cb438-12" tabindex="-1"></a>                          <span class="fu">vgm</span>(<span class="at">psill=</span><span class="dv">14</span>, <span class="at">model=</span><span class="st">&quot;Sph&quot;</span>, <span class="at">range=</span><span class="dv">590000</span>, <span class="at">nugget=</span><span class="dv">0</span>))</span>
<span id="cb438-13"><a href="interpolation-in-r.html#cb438-13" tabindex="-1"></a></span>
<span id="cb438-14"><a href="interpolation-in-r.html#cb438-14" tabindex="-1"></a><span class="co"># The following plot allows us to assess the fit</span></span>
<span id="cb438-15"><a href="interpolation-in-r.html#cb438-15" tabindex="-1"></a><span class="fu">plot</span>(var.smpl, dat.fit, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1000000</span>))</span></code></pre></div>
<p><img src="A10-Interpolation_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="generate-kriged-surface" class="section level3 unnumbered hasAnchor">
<h3>Generate Kriged surface<a href="interpolation-in-r.html#generate-kriged-surface" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next, use the variogram model <code>dat.fit</code> to generate a kriged interpolated surface. The <code>krige</code> function allows us to include the trend model thus saving us from having to de-trend the data, krige the residuals, then combine the two rasters. Instead, all we need to do is pass <code>krige</code> the trend formula <code>f.1</code>.</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="interpolation-in-r.html#cb439-1" tabindex="-1"></a><span class="co"># Define the trend model</span></span>
<span id="cb439-2"><a href="interpolation-in-r.html#cb439-2" tabindex="-1"></a>f<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(Precip_in <span class="sc">~</span> X <span class="sc">+</span> Y) </span>
<span id="cb439-3"><a href="interpolation-in-r.html#cb439-3" tabindex="-1"></a></span>
<span id="cb439-4"><a href="interpolation-in-r.html#cb439-4" tabindex="-1"></a><span class="co"># Perform the krige interpolation (note the use of the variogram model</span></span>
<span id="cb439-5"><a href="interpolation-in-r.html#cb439-5" tabindex="-1"></a><span class="co"># created in the earlier step)</span></span>
<span id="cb439-6"><a href="interpolation-in-r.html#cb439-6" tabindex="-1"></a>dat.krg <span class="ot">&lt;-</span> <span class="fu">krige</span>( f<span class="fl">.1</span>, P, grd, dat.fit)</span>
<span id="cb439-7"><a href="interpolation-in-r.html#cb439-7" tabindex="-1"></a></span>
<span id="cb439-8"><a href="interpolation-in-r.html#cb439-8" tabindex="-1"></a><span class="co"># Convert kriged surface to a raster object for clipping</span></span>
<span id="cb439-9"><a href="interpolation-in-r.html#cb439-9" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">rast</span>(dat.krg)</span>
<span id="cb439-10"><a href="interpolation-in-r.html#cb439-10" tabindex="-1"></a>r.m <span class="ot">&lt;-</span> <span class="fu">mask</span>(r, <span class="fu">st_as_sf</span>(W))</span>
<span id="cb439-11"><a href="interpolation-in-r.html#cb439-11" tabindex="-1"></a></span>
<span id="cb439-12"><a href="interpolation-in-r.html#cb439-12" tabindex="-1"></a><span class="co"># Plot the map</span></span>
<span id="cb439-13"><a href="interpolation-in-r.html#cb439-13" tabindex="-1"></a><span class="fu">tm_shape</span>(r.m[<span class="st">&quot;var1.pred&quot;</span>]) <span class="sc">+</span> </span>
<span id="cb439-14"><a href="interpolation-in-r.html#cb439-14" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">palette=</span><span class="st">&quot;RdBu&quot;</span>, </span>
<span id="cb439-15"><a href="interpolation-in-r.html#cb439-15" tabindex="-1"></a>            <span class="at">title=</span><span class="st">&quot;Predicted precipitation </span><span class="sc">\n</span><span class="st">(in inches)&quot;</span>) <span class="sc">+</span></span>
<span id="cb439-16"><a href="interpolation-in-r.html#cb439-16" tabindex="-1"></a>  <span class="fu">tm_shape</span>(P) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">size=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb439-17"><a href="interpolation-in-r.html#cb439-17" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">legend.outside=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="A10-Interpolation_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="generate-the-variance-and-confidence-interval-maps" class="section level3 unnumbered hasAnchor">
<h3>Generate the variance and confidence interval maps<a href="interpolation-in-r.html#generate-the-variance-and-confidence-interval-maps" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>dat.krg</code> object stores not just the interpolated values, but the variance values as well. These are also passed to the raster object for mapping as follows:</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="interpolation-in-r.html#cb440-1" tabindex="-1"></a><span class="fu">tm_shape</span>(r.m[<span class="st">&quot;var1.var&quot;</span>]) <span class="sc">+</span> </span>
<span id="cb440-2"><a href="interpolation-in-r.html#cb440-2" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">n=</span><span class="dv">7</span>, <span class="at">palette =</span><span class="st">&quot;Reds&quot;</span>,</span>
<span id="cb440-3"><a href="interpolation-in-r.html#cb440-3" tabindex="-1"></a>            <span class="at">title=</span><span class="st">&quot;Variance map </span><span class="sc">\n</span><span class="st">(in squared inches)&quot;</span>) <span class="sc">+</span><span class="fu">tm_shape</span>(P) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">size=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb440-4"><a href="interpolation-in-r.html#cb440-4" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">legend.outside=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="A10-Interpolation_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>A more readily interpretable map is the 95% confidence interval map which can be generated from the variance object as follows (the map values should be interpreted as the number of inches above and below the estimated rainfall amount).</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="interpolation-in-r.html#cb441-1" tabindex="-1"></a>r   <span class="ot">&lt;-</span> <span class="fu">rast</span>(dat.krg)</span>
<span id="cb441-2"><a href="interpolation-in-r.html#cb441-2" tabindex="-1"></a>r.m <span class="ot">&lt;-</span> <span class="fu">mask</span>(<span class="fu">sqrt</span>(r[<span class="st">&quot;var1.var&quot;</span>])<span class="sc">*</span> <span class="fl">1.96</span>, <span class="fu">st_as_sf</span>(W))</span>
<span id="cb441-3"><a href="interpolation-in-r.html#cb441-3" tabindex="-1"></a></span>
<span id="cb441-4"><a href="interpolation-in-r.html#cb441-4" tabindex="-1"></a><span class="fu">tm_shape</span>(r.m) <span class="sc">+</span> </span>
<span id="cb441-5"><a href="interpolation-in-r.html#cb441-5" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">n=</span><span class="dv">7</span>, <span class="at">palette =</span><span class="st">&quot;Reds&quot;</span>,</span>
<span id="cb441-6"><a href="interpolation-in-r.html#cb441-6" tabindex="-1"></a>            <span class="at">title=</span><span class="st">&quot;95% CI map </span><span class="sc">\n</span><span class="st">(in inches)&quot;</span>) <span class="sc">+</span><span class="fu">tm_shape</span>(P) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">size=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb441-7"><a href="interpolation-in-r.html#cb441-7" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">legend.outside=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="A10-Interpolation_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>

</div>
</div>
</div>






            </section>

          </div>
        </div>
      </div>
<a href="spatial-autocorrelation-in-r.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false,
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": {},
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
