<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>I Spatial autocorrelation in R | Intro to GIS and Spatial Analysis</title>
  <meta name="description" content="This is a compilation of lecture notes that accompany my Intro to GIS and Spatial Analysis course." />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="I Spatial autocorrelation in R | Intro to GIS and Spatial Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a compilation of lecture notes that accompany my Intro to GIS and Spatial Analysis course." />
  <meta name="github-repo" content="mgimond/spatial" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="I Spatial autocorrelation in R | Intro to GIS and Spatial Analysis" />
  
  <meta name="twitter:description" content="This is a compilation of lecture notes that accompany my Intro to GIS and Spatial Analysis course." />
  

<meta name="author" content="Manuel Gimond" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="point-pattern-analysis-in-r.html"/>
<link rel="next" href="interpolation-in-r.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-71085TV4MB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-71085TV4MB');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introGIS.html"><a href="introGIS.html"><i class="fa fa-check"></i><b>1</b> Introduction to GIS</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introGIS.html"><a href="introGIS.html#what-is-a-gis"><i class="fa fa-check"></i><b>1.1</b> What is a GIS?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introGIS.html"><a href="introGIS.html#gis-software"><i class="fa fa-check"></i><b>1.1.1</b> GIS software</a></li>
<li class="chapter" data-level="1.1.2" data-path="introGIS.html"><a href="introGIS.html#qgis"><i class="fa fa-check"></i><b>1.1.2</b> QGIS</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introGIS.html"><a href="introGIS.html#what-is-spatial-analysis"><i class="fa fa-check"></i><b>1.2</b> What is Spatial Analysis?</a></li>
<li class="chapter" data-level="1.3" data-path="introGIS.html"><a href="introGIS.html#whats-in-an-acronym"><i class="fa fa-check"></i><b>1.3</b> What’s in an Acronym?</a></li>
</ul></li>
<li class="part"><span><b>PART 1: Working with spatial data</b></span></li>
<li class="chapter" data-level="2" data-path="chp02_0.html"><a href="chp02_0.html"><i class="fa fa-check"></i><b>2</b> Feature Representation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chp02_0.html"><a href="chp02_0.html#vector-vs.-raster"><i class="fa fa-check"></i><b>2.1</b> Vector vs. Raster</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chp02_0.html"><a href="chp02_0.html#vector"><i class="fa fa-check"></i><b>2.1.1</b> Vector</a></li>
<li class="chapter" data-level="2.1.2" data-path="chp02_0.html"><a href="chp02_0.html#raster"><i class="fa fa-check"></i><b>2.1.2</b> Raster</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chp02_0.html"><a href="chp02_0.html#object-vs.-field"><i class="fa fa-check"></i><b>2.2</b> Object vs. Field</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chp02_0.html"><a href="chp02_0.html#object-view"><i class="fa fa-check"></i><b>2.2.1</b> Object View</a></li>
<li class="chapter" data-level="2.2.2" data-path="chp02_0.html"><a href="chp02_0.html#field-view"><i class="fa fa-check"></i><b>2.2.2</b> Field View</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="chp02_0.html"><a href="chp02_0.html#scale"><i class="fa fa-check"></i><b>2.3</b> Scale</a></li>
<li class="chapter" data-level="2.4" data-path="chp02_0.html"><a href="chp02_0.html#attribute-tables"><i class="fa fa-check"></i><b>2.4</b> Attribute Tables</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="chp02_0.html"><a href="chp02_0.html#measurement-levels"><i class="fa fa-check"></i><b>2.4.1</b> Measurement Levels</a></li>
<li class="chapter" data-level="2.4.2" data-path="chp02_0.html"><a href="chp02_0.html#data-type"><i class="fa fa-check"></i><b>2.4.2</b> Data type</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="gis-data-management.html"><a href="gis-data-management.html"><i class="fa fa-check"></i><b>3</b> GIS Data Management</a>
<ul>
<li class="chapter" data-level="3.1" data-path="gis-data-management.html"><a href="gis-data-management.html#gis-file-data-formats"><i class="fa fa-check"></i><b>3.1</b> GIS File Data Formats</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="gis-data-management.html"><a href="gis-data-management.html#vector-data-file-formats"><i class="fa fa-check"></i><b>3.1.1</b> Vector Data File Formats</a></li>
<li class="chapter" data-level="3.1.2" data-path="gis-data-management.html"><a href="gis-data-management.html#raster-data-file-formats"><i class="fa fa-check"></i><b>3.1.2</b> Raster Data File Formats</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="gis-data-management.html"><a href="gis-data-management.html#managing-gis-files-in-arcgis"><i class="fa fa-check"></i><b>3.2</b> Managing GIS Files in ArcGIS</a></li>
<li class="chapter" data-level="3.3" data-path="gis-data-management.html"><a href="gis-data-management.html#managing-a-map-project-in-arcgis"><i class="fa fa-check"></i><b>3.3</b> Managing a Map Project in ArcGIS</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="symbolizing-features.html"><a href="symbolizing-features.html"><i class="fa fa-check"></i><b>4</b> Symbolizing features</a>
<ul>
<li class="chapter" data-level="4.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#color"><i class="fa fa-check"></i><b>4.1</b> Color</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#hue"><i class="fa fa-check"></i><b>4.1.1</b> Hue</a></li>
<li class="chapter" data-level="4.1.2" data-path="symbolizing-features.html"><a href="symbolizing-features.html#lightness"><i class="fa fa-check"></i><b>4.1.2</b> Lightness</a></li>
<li class="chapter" data-level="4.1.3" data-path="symbolizing-features.html"><a href="symbolizing-features.html#saturation"><i class="fa fa-check"></i><b>4.1.3</b> Saturation</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="symbolizing-features.html"><a href="symbolizing-features.html#color-space"><i class="fa fa-check"></i><b>4.2</b> Color Space</a></li>
<li class="chapter" data-level="4.3" data-path="symbolizing-features.html"><a href="symbolizing-features.html#classification"><i class="fa fa-check"></i><b>4.3</b> Classification</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#qualitative-color-scheme"><i class="fa fa-check"></i><b>4.3.1</b> Qualitative color scheme</a></li>
<li class="chapter" data-level="4.3.2" data-path="symbolizing-features.html"><a href="symbolizing-features.html#sequential-color-scheme"><i class="fa fa-check"></i><b>4.3.2</b> Sequential color scheme</a></li>
<li class="chapter" data-level="4.3.3" data-path="symbolizing-features.html"><a href="symbolizing-features.html#divergent-color-scheme"><i class="fa fa-check"></i><b>4.3.3</b> Divergent color scheme</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="symbolizing-features.html"><a href="symbolizing-features.html#so-how-do-i-find-a-proper-color-scheme-for-my-data"><i class="fa fa-check"></i><b>4.4</b> So how do I find a proper color scheme for my data?</a></li>
<li class="chapter" data-level="4.5" data-path="symbolizing-features.html"><a href="symbolizing-features.html#classification-intervals"><i class="fa fa-check"></i><b>4.5</b> Classification Intervals</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#an-interactive-example"><i class="fa fa-check"></i><b>4.5.1</b> An Interactive Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="statistical-maps.html"><a href="statistical-maps.html"><i class="fa fa-check"></i><b>5</b> Statistical maps</a>
<ul>
<li class="chapter" data-level="5.1" data-path="statistical-maps.html"><a href="statistical-maps.html#statistical-distribution-maps"><i class="fa fa-check"></i><b>5.1</b> Statistical distribution maps</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="statistical-maps.html"><a href="statistical-maps.html#quantile-map"><i class="fa fa-check"></i><b>5.1.1</b> Quantile map</a></li>
<li class="chapter" data-level="5.1.2" data-path="statistical-maps.html"><a href="statistical-maps.html#boxplot-map"><i class="fa fa-check"></i><b>5.1.2</b> Boxplot map</a></li>
<li class="chapter" data-level="5.1.3" data-path="statistical-maps.html"><a href="statistical-maps.html#iqr-map"><i class="fa fa-check"></i><b>5.1.3</b> IQR map</a></li>
<li class="chapter" data-level="5.1.4" data-path="statistical-maps.html"><a href="statistical-maps.html#standard-deviation-map"><i class="fa fa-check"></i><b>5.1.4</b> Standard deviation map</a></li>
<li class="chapter" data-level="5.1.5" data-path="statistical-maps.html"><a href="statistical-maps.html#outlier-maps"><i class="fa fa-check"></i><b>5.1.5</b> Outlier maps</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="statistical-maps.html"><a href="statistical-maps.html#mapping-uncertainty"><i class="fa fa-check"></i><b>5.2</b> Mapping uncertainty</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="statistical-maps.html"><a href="statistical-maps.html#problems-in-mapping-uncertainty"><i class="fa fa-check"></i><b>5.2.1</b> Problems in mapping uncertainty</a></li>
<li class="chapter" data-level="5.2.2" data-path="statistical-maps.html"><a href="statistical-maps.html#class-comparison-maps"><i class="fa fa-check"></i><b>5.2.2</b> Class comparison maps</a></li>
<li class="chapter" data-level="5.2.3" data-path="statistical-maps.html"><a href="statistical-maps.html#problem-when-performing-bivariate-analysis"><i class="fa fa-check"></i><b>5.2.3</b> Problem when performing bivariate analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html"><i class="fa fa-check"></i><b>6</b> Pitfalls to avoid</a>
<ul>
<li class="chapter" data-level="6.1" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#representing-count"><i class="fa fa-check"></i><b>6.1</b> Representing Count</a></li>
<li class="chapter" data-level="6.2" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#maup"><i class="fa fa-check"></i><b>6.2</b> MAUP</a></li>
<li class="chapter" data-level="6.3" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#ecological-fallacy"><i class="fa fa-check"></i><b>6.3</b> Ecological Fallacy</a></li>
<li class="chapter" data-level="6.4" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#mapping-rates"><i class="fa fa-check"></i><b>6.4</b> Mapping rates</a></li>
<li class="chapter" data-level="6.5" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#coping-with-unstable-rates"><i class="fa fa-check"></i><b>6.5</b> Coping with Unstable Rates</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html"><i class="fa fa-check"></i><b>7</b> Good Map Making Tips</a>
<ul>
<li class="chapter" data-level="7.1" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html#elements-of-a-map"><i class="fa fa-check"></i><b>7.1</b> Elements of a map</a></li>
<li class="chapter" data-level="7.2" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html#how-to-create-a-good-map"><i class="fa fa-check"></i><b>7.2</b> How to create a <em>good</em> map</a></li>
<li class="chapter" data-level="7.3" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html#typefaces-and-fonts"><i class="fa fa-check"></i><b>7.3</b> Typefaces and Fonts</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html"><i class="fa fa-check"></i><b>8</b> Spatial Operations and Vector Overlays</a>
<ul>
<li class="chapter" data-level="8.1" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#selection-by-attribute"><i class="fa fa-check"></i><b>8.1</b> Selection by Attribute</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#set-algebra"><i class="fa fa-check"></i><b>8.1.1</b> Set Algebra</a></li>
<li class="chapter" data-level="8.1.2" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#boolean-algebra"><i class="fa fa-check"></i><b>8.1.2</b> Boolean Algebra</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#selection-by-location"><i class="fa fa-check"></i><b>8.2</b> Selection by location</a></li>
<li class="chapter" data-level="8.3" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#vector-overlay"><i class="fa fa-check"></i><b>8.3</b> Vector Overlay</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#clip"><i class="fa fa-check"></i><b>8.3.1</b> Clip</a></li>
<li class="chapter" data-level="8.3.2" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#intersect"><i class="fa fa-check"></i><b>8.3.2</b> Intersect</a></li>
<li class="chapter" data-level="8.3.3" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#union"><i class="fa fa-check"></i><b>8.3.3</b> Union</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chp09_0.html"><a href="chp09_0.html"><i class="fa fa-check"></i><b>9</b> Coordinate Systems</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chp09_0.html"><a href="chp09_0.html#geographic-coordinate-systems"><i class="fa fa-check"></i><b>9.1</b> Geographic Coordinate Systems</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="chp09_0.html"><a href="chp09_0.html#sphere-and-ellipsoid"><i class="fa fa-check"></i><b>9.1.1</b> Sphere and Ellipsoid</a></li>
<li class="chapter" data-level="9.1.2" data-path="chp09_0.html"><a href="chp09_0.html#geoid"><i class="fa fa-check"></i><b>9.1.2</b> Geoid</a></li>
<li class="chapter" data-level="9.1.3" data-path="chp09_0.html"><a href="chp09_0.html#datum"><i class="fa fa-check"></i><b>9.1.3</b> Datum</a></li>
<li class="chapter" data-level="9.1.4" data-path="chp09_0.html"><a href="chp09_0.html#building-the-geographic-coordinate-system"><i class="fa fa-check"></i><b>9.1.4</b> Building the Geographic Coordinate System</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="chp09_0.html"><a href="chp09_0.html#projected-coordinate-systems"><i class="fa fa-check"></i><b>9.2</b> Projected Coordinate Systems</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="chp09_0.html"><a href="chp09_0.html#planar-projections"><i class="fa fa-check"></i><b>9.2.1</b> Planar Projections</a></li>
<li class="chapter" data-level="9.2.2" data-path="chp09_0.html"><a href="chp09_0.html#cylindrical-projection"><i class="fa fa-check"></i><b>9.2.2</b> Cylindrical Projection</a></li>
<li class="chapter" data-level="9.2.3" data-path="chp09_0.html"><a href="chp09_0.html#conical-projection"><i class="fa fa-check"></i><b>9.2.3</b> Conical Projection</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="chp09_0.html"><a href="chp09_0.html#spatial-properties"><i class="fa fa-check"></i><b>9.3</b> Spatial Properties</a></li>
<li class="chapter" data-level="9.4" data-path="chp09_0.html"><a href="chp09_0.html#geodesic-geometries"><i class="fa fa-check"></i><b>9.4</b> Geodesic geometries</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chp10_0.html"><a href="chp10_0.html"><i class="fa fa-check"></i><b>10</b> Map Algebra</a>
<ul>
<li class="chapter" data-level="10.1" data-path="chp10_0.html"><a href="chp10_0.html#local-operations-and-functions"><i class="fa fa-check"></i><b>10.1</b> Local operations and functions</a></li>
<li class="chapter" data-level="10.2" data-path="chp10_0.html"><a href="chp10_0.html#focal-operations-and-functions"><i class="fa fa-check"></i><b>10.2</b> Focal operations and functions</a></li>
<li class="chapter" data-level="10.3" data-path="chp10_0.html"><a href="chp10_0.html#zonal-operations-and-functions"><i class="fa fa-check"></i><b>10.3</b> Zonal operations and functions</a></li>
<li class="chapter" data-level="10.4" data-path="chp10_0.html"><a href="chp10_0.html#global-operations-and-functions"><i class="fa fa-check"></i><b>10.4</b> Global operations and functions</a></li>
<li class="chapter" data-level="10.5" data-path="chp10_0.html"><a href="chp10_0.html#operators-and-functions"><i class="fa fa-check"></i><b>10.5</b> Operators and functions</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="chp10_0.html"><a href="chp10_0.html#mathematical-operators-and-functions"><i class="fa fa-check"></i><b>10.5.1</b> Mathematical operators and functions</a></li>
<li class="chapter" data-level="10.5.2" data-path="chp10_0.html"><a href="chp10_0.html#logical-comparison"><i class="fa fa-check"></i><b>10.5.2</b> Logical comparison</a></li>
<li class="chapter" data-level="10.5.3" data-path="chp10_0.html"><a href="chp10_0.html#boolean-or-logical-operators"><i class="fa fa-check"></i><b>10.5.3</b> Boolean (or Logical) operators</a></li>
<li class="chapter" data-level="10.5.4" data-path="chp10_0.html"><a href="chp10_0.html#combining-operations"><i class="fa fa-check"></i><b>10.5.4</b> Combining operations</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>PART 2: Spatial Analysis</b></span></li>
<li class="chapter" data-level="11" data-path="chp11_0.html"><a href="chp11_0.html"><i class="fa fa-check"></i><b>11</b> Point Pattern Analysis</a>
<ul>
<li class="chapter" data-level="11.1" data-path="chp11_0.html"><a href="chp11_0.html#centrography"><i class="fa fa-check"></i><b>11.1</b> Centrography</a></li>
<li class="chapter" data-level="11.2" data-path="chp11_0.html"><a href="chp11_0.html#density-based-analysis"><i class="fa fa-check"></i><b>11.2</b> Density based analysis</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="chp11_0.html"><a href="chp11_0.html#global-density"><i class="fa fa-check"></i><b>11.2.1</b> Global density</a></li>
<li class="chapter" data-level="11.2.2" data-path="chp11_0.html"><a href="chp11_0.html#local-density"><i class="fa fa-check"></i><b>11.2.2</b> Local density</a></li>
<li class="chapter" data-level="11.2.3" data-path="chp11_0.html"><a href="chp11_0.html#modeling-intensity-as-a-function-of-a-covariate"><i class="fa fa-check"></i><b>11.2.3</b> Modeling intensity as a function of a covariate</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="chp11_0.html"><a href="chp11_0.html#distance-based-analysis"><i class="fa fa-check"></i><b>11.3</b> Distance based analysis</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="chp11_0.html"><a href="chp11_0.html#average-nearest-neighbor"><i class="fa fa-check"></i><b>11.3.1</b> Average Nearest Neighbor</a></li>
<li class="chapter" data-level="11.3.2" data-path="chp11_0.html"><a href="chp11_0.html#k-and-l-functions"><i class="fa fa-check"></i><b>11.3.2</b> K and L functions</a></li>
<li class="chapter" data-level="11.3.3" data-path="chp11_0.html"><a href="chp11_0.html#the-pair-correlation-function-g"><i class="fa fa-check"></i><b>11.3.3</b> The Pair Correlation Function <span class="math inline">\(g\)</span></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="chp11_0.html"><a href="chp11_0.html#first-and-second-order-effects"><i class="fa fa-check"></i><b>11.4</b> First and second order effects</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>12</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="12.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#irpcsr"><i class="fa fa-check"></i><b>12.1</b> IRP/CSR</a></li>
<li class="chapter" data-level="12.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#testing-for-csr-with-the-ann-tool"><i class="fa fa-check"></i><b>12.2</b> Testing for CSR with the ANN tool</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#arcgis-average-nearest-neighbor-tool"><i class="fa fa-check"></i><b>12.2.1</b> ArcGIS’ Average Nearest Neighbor Tool</a></li>
<li class="chapter" data-level="12.2.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#a-better-approach-a-monte-carlo-test"><i class="fa fa-check"></i><b>12.2.2</b> A better approach: a Monte Carlo test</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#alternatives-to-csrirp"><i class="fa fa-check"></i><b>12.3</b> Alternatives to CSR/IRP</a></li>
<li class="chapter" data-level="12.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#monte-carlo-test-with-k-and-l-functions"><i class="fa fa-check"></i><b>12.4</b> Monte Carlo test with K and L functions</a></li>
<li class="chapter" data-level="12.5" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#PPM"><i class="fa fa-check"></i><b>12.5</b> Testing for a covariate effect</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html"><i class="fa fa-check"></i><b>13</b> Spatial Autocorrelation</a>
<ul>
<li class="chapter" data-level="13.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#global-morans-i"><i class="fa fa-check"></i><b>13.1</b> Global Moran’s <em>I</em></a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#computing-the-morans-i"><i class="fa fa-check"></i><b>13.1.1</b> Computing the Moran’s <em>I</em></a></li>
<li class="chapter" data-level="13.1.2" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#monte-carlo-approach-to-estimating-significance"><i class="fa fa-check"></i><b>13.1.2</b> Monte Carlo approach to estimating significance</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#morans-i-at-different-lags"><i class="fa fa-check"></i><b>13.2</b> Moran’s <em>I</em> at different lags</a></li>
<li class="chapter" data-level="13.3" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#local-morans-i"><i class="fa fa-check"></i><b>13.3</b> Local Moran’s <em>I</em></a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#a-note-about-interpreting-the-pseudo-p-value"><i class="fa fa-check"></i><b>13.3.1</b> A note about interpreting the pseudo p-value</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#morans-i-equation-explained"><i class="fa fa-check"></i><b>13.4</b> Moran’s <em>I</em> equation explained</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#local-morans-i-1"><i class="fa fa-check"></i><b>13.4.1</b> Local Moran’s I</a></li>
<li class="chapter" data-level="13.4.2" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#global-morans-i-1"><i class="fa fa-check"></i><b>13.4.2</b> Global Moran’s I</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html"><i class="fa fa-check"></i><b>14</b> Spatial Interpolation</a>
<ul>
<li class="chapter" data-level="14.1" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#deterministic-approach-to-interpolation"><i class="fa fa-check"></i><b>14.1</b> Deterministic Approach to Interpolation</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#proximity-interpolation"><i class="fa fa-check"></i><b>14.1.1</b> Proximity interpolation</a></li>
<li class="chapter" data-level="14.1.2" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#inverse-distance-weighted-idw"><i class="fa fa-check"></i><b>14.1.2</b> Inverse Distance Weighted (IDW)</a></li>
<li class="chapter" data-level="14.1.3" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#fine-tuning-the-interpolation-parameters"><i class="fa fa-check"></i><b>14.1.3</b> Fine tuning the interpolation parameters</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#statistical-approach-to-interpolation"><i class="fa fa-check"></i><b>14.2</b> Statistical Approach to Interpolation</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#trend-surfaces"><i class="fa fa-check"></i><b>14.2.1</b> Trend Surfaces</a></li>
<li class="chapter" data-level="14.2.2" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#ordinary-kriging"><i class="fa fa-check"></i><b>14.2.2</b> Ordinary Kriging</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>15</b> References</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html"><i class="fa fa-check"></i><b>A</b> Reading and writing spatial data in R</a>
<ul>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_2"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_3"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_4"><i class="fa fa-check"></i>Creating spatial objects</a>
<ul>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_4_1"><i class="fa fa-check"></i>Reading a shapefile</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_4_2"><i class="fa fa-check"></i>Reading a GeoPackage</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_4_3"><i class="fa fa-check"></i>Reading a raster</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_4_5"><i class="fa fa-check"></i>Creating a spatial object from a data frame</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_4_6"><i class="fa fa-check"></i>Geocoding street addresses</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_5"><i class="fa fa-check"></i>Converting from an <code>sf</code> object</a>
<ul>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_5_1"><i class="fa fa-check"></i>Converting an <code>sf</code> object to a <code>Spatial*</code> object (<code>spdep</code>/<code>sp</code>)</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_5_2"><i class="fa fa-check"></i>Converting an <code>sf</code> polygon object to an <code>owin</code> object</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_5_3"><i class="fa fa-check"></i>Converting an <code>sf</code> point object to a <code>ppp</code> object</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_5_4"><i class="fa fa-check"></i>Converting a <code>SpatRaster</code> object to an <code>im</code> object</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_6"><i class="fa fa-check"></i>Converting to an <code>sf</code> object</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_7"><i class="fa fa-check"></i>Dissecting the <code>sf</code> file object</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_8"><i class="fa fa-check"></i>Exporting to different data file formats</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html"><i class="fa fa-check"></i><b>B</b> Mapping data in R</a>
<ul>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#sample-files-for-this-exercise"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#tmap"><i class="fa fa-check"></i><code>tmap</code></a>
<ul>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#the-basics"><i class="fa fa-check"></i>The basics</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#combining-layers"><i class="fa fa-check"></i>Combining layers</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#tweaking-classification-schemes"><i class="fa fa-check"></i>Tweaking classification schemes</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#tweaking-colors"><i class="fa fa-check"></i>Tweaking colors</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#adding-labels"><i class="fa fa-check"></i>Adding labels</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#adding-a-grid-or-graticule"><i class="fa fa-check"></i>Adding a grid or graticule</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#adding-statistical-plots"><i class="fa fa-check"></i>Adding statistical plots</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#mapping-raster-files"><i class="fa fa-check"></i>Mapping raster files</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#changing-coordinate-systems"><i class="fa fa-check"></i>Changing coordinate systems</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#side-by-side-maps"><i class="fa fa-check"></i>Side-by-side maps</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#splitting-data-by-polygons-or-group-of-polygons"><i class="fa fa-check"></i>Splitting data by polygons or group of polygons</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#ggplot2"><i class="fa fa-check"></i><code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#the-basics-1"><i class="fa fa-check"></i>The basics</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#tweaking-classification-schemes-1"><i class="fa fa-check"></i>Tweaking classification schemes</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#combining-layers-1"><i class="fa fa-check"></i>Combining layers</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#plot_sf"><i class="fa fa-check"></i><code>plot_sf</code></a>
<ul>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#the-basics-2"><i class="fa fa-check"></i>The basics</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#adding-a-graticule"><i class="fa fa-check"></i>Adding a graticule</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#combining-layers-2"><i class="fa fa-check"></i>Combining layers</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#tweaking-colors-1"><i class="fa fa-check"></i>Tweaking colors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html"><i class="fa fa-check"></i><b>C</b> Anatomy of simple feature objects</a>
<ul>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#creating-point-sf-objects"><i class="fa fa-check"></i>Creating point ‘sf’ objects</a>
<ul>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#step-1-create-the-point-geometry-sfg"><i class="fa fa-check"></i>Step 1: Create the point geometry: <code>sfg</code></a></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#step-2-create-a-column-of-simple-feature-geometries-sfc"><i class="fa fa-check"></i>Step 2: Create a column of simple feature geometries: <code>sfc</code></a></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#step-3-create-the-simple-feature-object-sf"><i class="fa fa-check"></i>Step 3: Create the simple feature object <code>sf</code></a></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#renaming-the-geometry-column"><i class="fa fa-check"></i>Renaming the geometry column</a></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#adding-attributes-to-an-sf-object"><i class="fa fa-check"></i>Adding attributes to an <code>sf</code> object</a></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#adding-a-geometry-column-to-an-existing-non-spatial-dataframe"><i class="fa fa-check"></i>Adding a geometry column to an existing non-spatial dataframe</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#creating-polyline-sf-objects"><i class="fa fa-check"></i>Creating polyline ‘sf’ objects</a>
<ul>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#creating-branching-polyline-features"><i class="fa fa-check"></i>Creating branching polyline features</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#creating-polygon-sf-objects"><i class="fa fa-check"></i>Creating polygon ‘sf’ objects</a>
<ul>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#polygon-simple-feature"><i class="fa fa-check"></i><code>POLYGON</code> simple feature</a></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#multipolygon-simple-feature-multipart-features"><i class="fa fa-check"></i><code>MULTIPOLYGON</code> simple feature: multipart features</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#extracting-geometry-from-an-sf-object"><i class="fa fa-check"></i>Extracting geometry from an <code>sf</code> object</a></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#alternative-syntax"><i class="fa fa-check"></i>Alternative syntax</a></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#additional-resources"><i class="fa fa-check"></i>Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html"><i class="fa fa-check"></i><b>D</b> Vector operations in R</a>
<ul>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#dissolving-geometries"><i class="fa fa-check"></i>Dissolving geometries</a>
<ul>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#dissolving-by-contiguous-shape"><i class="fa fa-check"></i>Dissolving by contiguous shape</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#dissolving-by-attribute"><i class="fa fa-check"></i>Dissolving by attribute</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#subsetting-by-attribute"><i class="fa fa-check"></i>Subsetting by attribute</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#intersecting-layers"><i class="fa fa-check"></i>Intersecting layers</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#clipping-spatial-objects-using-other-spatial-objects"><i class="fa fa-check"></i>Clipping spatial objects using other spatial objects</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#unioning-layers"><i class="fa fa-check"></i>Unioning layers</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#buffering-geometries"><i class="fa fa-check"></i>Buffering geometries</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html"><i class="fa fa-check"></i><b>E</b> Mapping rates in R</a>
<ul>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#raw-rates"><i class="fa fa-check"></i>Raw Rates</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#standardized-mortality-ratios-relative-risk"><i class="fa fa-check"></i>Standardized mortality ratios (relative risk)</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#dykes-and-unwins-chi-square-statistic"><i class="fa fa-check"></i>Dykes and Unwin’s chi-square statistic</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#unstable-ratios"><i class="fa fa-check"></i>Unstable ratios</a>
<ul>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#global-empirical-bayes-eb-rate-estimate"><i class="fa fa-check"></i>Global Empirical Bayes (EB) rate estimate</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#local-empirical-bayes-eb-rate-estimate"><i class="fa fa-check"></i>Local Empirical Bayes (EB) rate estimate</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="F" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html"><i class="fa fa-check"></i><b>F</b> Raster operations in R</a>
<ul>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#sample-files-for-this-exercise-1"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#local-operations-and-functions-1"><i class="fa fa-check"></i>Local operations and functions</a>
<ul>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#unary-operations-and-functions-applied-to-single-rasters"><i class="fa fa-check"></i>Unary operations and functions (applied to single rasters)</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#binary-operations-and-functions-where-two-rasters-are-used"><i class="fa fa-check"></i>Binary operations and functions (where two rasters are used)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#focal-operations-and-functions-1"><i class="fa fa-check"></i>Focal operations and functions</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#zonal-operations-and-functions-1"><i class="fa fa-check"></i>Zonal operations and functions</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#global-operations-and-functions-1"><i class="fa fa-check"></i>Global operations and functions</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#computing-cumulative-distances"><i class="fa fa-check"></i>Computing cumulative distances</a>
<ul>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#working-example"><i class="fa fa-check"></i>Working example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="G" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html"><i class="fa fa-check"></i><b>G</b> Coordinate Systems in R</a>
<ul>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#a-note-about-the-changes-to-the-proj-environment"><i class="fa fa-check"></i>A note about the changes to the <code>PROJ</code> environment</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#sample-files-for-this-exercise-2"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#loading-the-sf-package"><i class="fa fa-check"></i>Loading the <code>sf</code> package</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#checking-for-a-coordinate-system"><i class="fa fa-check"></i>Checking for a coordinate system</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#understanding-the-proj4-coordinate-syntax"><i class="fa fa-check"></i>Understanding the Proj4 coordinate syntax</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#assigning-a-coordinate-system"><i class="fa fa-check"></i>Assigning a coordinate system</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#transforming-coordinate-systems"><i class="fa fa-check"></i>Transforming coordinate systems</a>
<ul>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#reprojecting-to-a-new-meridian-center"><i class="fa fa-check"></i>Reprojecting to a new meridian center</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#a-note-about-containment"><i class="fa fa-check"></i>A note about containment</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#creating-tissot-indicatrix-circles"><i class="fa fa-check"></i>Creating Tissot indicatrix circles</a></li>
</ul></li>
<li class="chapter" data-level="H" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html"><i class="fa fa-check"></i><b>H</b> Point pattern analysis in R</a>
<ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#sample-files-for-this-exercise-3"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#prepping-the-data"><i class="fa fa-check"></i>Prepping the data</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#density-based-analysis-1"><i class="fa fa-check"></i>Density based analysis</a>
<ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#quadrat-density-1"><i class="fa fa-check"></i>Quadrat density</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#quadrat-density-on-a-tessellated-surface"><i class="fa fa-check"></i>Quadrat density on a tessellated surface</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#kernel-density-raster"><i class="fa fa-check"></i>Kernel density raster</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#kernel-density-adjusted-for-covariate-1"><i class="fa fa-check"></i>Kernel density adjusted for covariate</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#modeling-intensity-as-a-function-of-a-covariate-1"><i class="fa fa-check"></i>Modeling intensity as a function of a covariate</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#distance-based-analysis-1"><i class="fa fa-check"></i>Distance based analysis</a>
<ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#average-nearest-neighbor-analysis"><i class="fa fa-check"></i>Average nearest neighbor analysis</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#k-and-l-functions-1"><i class="fa fa-check"></i>K and L functions</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pair-correlation-function-g"><i class="fa fa-check"></i>Pair correlation function g</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#hypothesis-tests"><i class="fa fa-check"></i>Hypothesis tests</a>
<ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#test-for-clusteringdispersion"><i class="fa fa-check"></i>Test for clustering/dispersion</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#computing-a-pseudo-p-value-from-the-simulation"><i class="fa fa-check"></i>Computing a pseudo p-value from the simulation</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#test-for-a-poisson-point-process-model-with-a-covariate-effect"><i class="fa fa-check"></i>Test for a poisson point process model with a covariate effect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="I" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html"><i class="fa fa-check"></i><b>I</b> Spatial autocorrelation in R</a>
<ul>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_1"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_2"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_3"><i class="fa fa-check"></i>Define neighboring polygons</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_4"><i class="fa fa-check"></i>Generating a Moran’s I scatter plot</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_4b"><i class="fa fa-check"></i>Computing the Moran’s I coefficient</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_5"><i class="fa fa-check"></i>Assessing statistical significance</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_6"><i class="fa fa-check"></i>Moran’s I as a function of a distance band</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_7"><i class="fa fa-check"></i>Local Moran’s I</a>
<ul>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_7_1"><i class="fa fa-check"></i>Correcting for multiple comparisons</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="J" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html"><i class="fa fa-check"></i><b>J</b> Interpolation in R</a>
<ul>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#thiessen-polygons"><i class="fa fa-check"></i>Thiessen polygons</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#idw"><i class="fa fa-check"></i>IDW</a>
<ul>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#fine-tuning-the-interpolation"><i class="fa fa-check"></i>Fine-tuning the interpolation</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#cross-validation"><i class="fa fa-check"></i>Cross-validation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#st-order-polynomial-fit"><i class="fa fa-check"></i>1<sup>st</sup> order polynomial fit</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#nd-order-polynomial"><i class="fa fa-check"></i>2<sup>nd</sup> order polynomial</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#kriging"><i class="fa fa-check"></i>Kriging</a>
<ul>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#fit-the-variogram-model"><i class="fa fa-check"></i>Fit the variogram model</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#generate-kriged-surface"><i class="fa fa-check"></i>Generate Kriged surface</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#generate-the-variance-and-confidence-interval-maps"><i class="fa fa-check"></i>Generate the variance and confidence interval maps</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Intro to GIS and Spatial Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="spatial-autocorrelation-in-r" class="section level1 hasAnchor" number="24">
<h1><span class="header-section-number">I</span> Spatial autocorrelation in R<a href="spatial-autocorrelation-in-r.html#spatial-autocorrelation-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<table class="package_ver_table">
<tbody>
<tr>
<td style="text-align:left;color: black !important;background-color: rgba(255, 193, 120, 255) !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
R
</td>
<td style="text-align:left;color: black !important;background-color: rgba(255, 193, 120, 255) !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
sf
</td>
<td style="text-align:left;color: black !important;background-color: rgba(255, 193, 120, 255) !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
tmap
</td>
<td style="text-align:left;color: black !important;background-color: rgba(255, 193, 120, 255) !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
spatstat
</td>
<td style="text-align:left;color: black !important;background-color: rgba(255, 193, 120, 255) !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
gstat
</td>
<td style="text-align:left;color: black !important;background-color: rgba(255, 193, 120, 255) !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
terra
</td>
<td style="text-align:left;color: black !important;background-color: rgba(255, 193, 120, 255) !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
sp
</td>
</tr>
<tr>
<td style="text-align:left;color: white !important;background-color: rgba(170, 170, 170, 255) !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
4.5.1
</td>
<td style="text-align:left;color: white !important;background-color: rgba(170, 170, 170, 255) !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
1.0.21
</td>
<td style="text-align:left;color: white !important;background-color: rgba(170, 170, 170, 255) !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
4.1
</td>
<td style="text-align:left;color: white !important;background-color: rgba(170, 170, 170, 255) !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
3.4.0
</td>
<td style="text-align:left;color: white !important;background-color: rgba(170, 170, 170, 255) !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
2.1.4
</td>
<td style="text-align:left;color: white !important;background-color: rgba(170, 170, 170, 255) !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
1.8.60
</td>
<td style="text-align:left;color: white !important;background-color: rgba(170, 170, 170, 255) !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
2.2.0
</td>
</tr>
</tbody>
</table>
<p>For a basic theoretical treatise on spatial autocorrelation the reader is encouraged to review the <a href="./spatial-autocorrelation.html">lecture notes</a>. This section is intended to supplement the lecture notes by implementing spatial autocorrelation techniques in the R programming environment.</p>
<div id="app8_1" class="section level2 unnumbered hasAnchor">
<h2>Sample files for this exercise<a href="spatial-autocorrelation-in-r.html#app8_1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Data used in the following exercises can be loaded into your current R session by running the following chunk of code.</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="spatial-autocorrelation-in-r.html#cb396-1" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">gzcon</span>(<span class="fu">url</span>(<span class="st">&quot;https://github.com/mgimond/Spatial/raw/main/Data/ma2.rds&quot;</span>))</span>
<span id="cb396-2"><a href="spatial-autocorrelation-in-r.html#cb396-2" tabindex="-1"></a>ma <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(z)</span></code></pre></div>
<p>The <code>ma</code> object consists of an <code>sf</code> vector layer representing census data aggregated at the county subdivision level for 2021 <em>(src. Census Bureau 5-year ACS)</em>.</p>
</div>
<div id="app8_2" class="section level2 unnumbered hasAnchor">
<h2>Introduction<a href="spatial-autocorrelation-in-r.html#app8_2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The spatial object <code>ma</code> has nine attributes with the first being a <a href="https://en.wikipedia.org/wiki/Federal_Information_Processing_Standards">FIPS</a> identifier. The one of interest for this exercise is <code>house_inc</code> (median household income for 2021, in units of dollars). The following table shows just the first few records of the 343 polygon layer (FIPS and geometry columns are not shown).</p>
<p><img src="A09-Spatial-Autocorrelation_files/figure-html/unnamed-chunk-3-1.png" width="960" /></p>
<p>A map of the income distribution using an equal interval classification scheme is generated using the <code>tmap</code> package.</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="spatial-autocorrelation-in-r.html#cb397-1" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb397-2"><a href="spatial-autocorrelation-in-r.html#cb397-2" tabindex="-1"></a></span>
<span id="cb397-3"><a href="spatial-autocorrelation-in-r.html#cb397-3" tabindex="-1"></a><span class="fu">tm_shape</span>(ma) <span class="sc">+</span> <span class="fu">tm_polygons</span>(<span class="at">style=</span><span class="st">&quot;equal&quot;</span>, <span class="at">border.col =</span> <span class="st">&quot;grey80&quot;</span>, <span class="at">lwd =</span> <span class="fl">0.5</span>,</span>
<span id="cb397-4"><a href="spatial-autocorrelation-in-r.html#cb397-4" tabindex="-1"></a>                           <span class="at">col =</span> <span class="st">&quot;house_inc&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Greens&quot;</span>) <span class="sc">+</span></span>
<span id="cb397-5"><a href="spatial-autocorrelation-in-r.html#cb397-5" tabindex="-1"></a>               <span class="fu">tm_legend</span>(<span class="at">outside =</span> <span class="cn">TRUE</span>, <span class="at">text.size =</span> .<span class="dv">8</span>)  <span class="sc">+</span></span>
<span id="cb397-6"><a href="spatial-autocorrelation-in-r.html#cb397-6" tabindex="-1"></a>               <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="A09-Spatial-Autocorrelation_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="app8_3" class="section level2 unnumbered hasAnchor">
<h2>Define neighboring polygons<a href="spatial-autocorrelation-in-r.html#app8_3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We must first define what is meant by “neighboring” polygons. This can refer to contiguous polygons, polygons within a certain distance band, or it could be non-spatial in nature and defined by social, political or cultural “neighbors”.</p>
<p>In this example, we’ll adopt a contiguous neighbor definition where we’ll accept any contiguous polygon that shares at least on <em>vertex</em> (this is the “queen” case and is defined by setting the parameter <code>queen=TRUE</code> in the <code>poly2nb()</code> function). If we required that at least one <em>edge</em> be shared between polygons then we would set <code>queen=FALSE</code>.</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="spatial-autocorrelation-in-r.html#cb398-1" tabindex="-1"></a><span class="fu">library</span>(spdep)</span>
<span id="cb398-2"><a href="spatial-autocorrelation-in-r.html#cb398-2" tabindex="-1"></a>nb <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(ma, <span class="at">queen=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>Other neighborhood functions that can be implemented in <code>spdep</code> include:</p>
<table>
<colgroup>
<col width="31%" />
<col width="44%" />
<col width="23%" />
</colgroup>
<tbody>
<tr class="odd">
<td><code>dnearneigh</code></td>
<td>distance based neighbor (allows for annulus neighbors)</td>
<td>For point geometry</td>
</tr>
<tr class="even">
<td><code>knearneigh</code> + <code>knn2nb</code></td>
<td>k nearest neighbor</td>
<td>For point geometry</td>
</tr>
</tbody>
</table>
<p>For each polygon in our polygon object, <code>nb</code> lists all polygons deemed <em>contiguous</em>. For example, to see the neighbors for the first polygon in the object, type:</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="spatial-autocorrelation-in-r.html#cb399-1" tabindex="-1"></a>nb[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>[1]   3  34 149 150</code></pre>
<p>Polygon <code>1</code> has 4 neighbors. The numbers represent the polygon IDs as stored in the spatial object <code>ma</code>. Polygon <code>1</code> is associated with the following <code>name</code> attribute:</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="spatial-autocorrelation-in-r.html#cb401-1" tabindex="-1"></a>ma<span class="sc">$</span>name[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>[1] &quot;Hanover town, Plymouth County, Massachusetts&quot;</code></pre>
<p>Its four neighboring polygons are associated with the counties:</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="spatial-autocorrelation-in-r.html#cb403-1" tabindex="-1"></a>ma<span class="sc">$</span>name[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)]</span></code></pre></div>
<pre><code>[1] &quot;Marshfield town, Plymouth County, Massachusetts&quot; 
[2] &quot;Norwell town, Plymouth County, Massachusetts&quot;    
[3] &quot;Wareham town, Plymouth County, Massachusetts&quot;    
[4] &quot;Framingham city, Middlesex County, Massachusetts&quot;</code></pre>
<p>Next, we need to assign weights to each neighboring polygon. In our case, each neighboring polygon will be multiplied by the weight <span class="math inline">\(1/ (\#\ of\ neighbors)\)</span> (<code>style="W"</code>–note the uppercase <code>"W"</code>) such that the sum of the weights equal <code>1</code>. If a binary weight is desired (i.e. one where each neighboring polygon is a assigned a weight of <code>1</code>, regardless of the number of neighbors), set <code>style="B"</code>.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="spatial-autocorrelation-in-r.html#cb405-1" tabindex="-1"></a>lw <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(nb, <span class="at">style=</span><span class="st">&quot;W&quot;</span>, <span class="at">zero.policy=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>The <code>zero.policy=TRUE</code> option allows for lists of non-neighbors. This should be used with caution since the user may not be aware of missing neighbors in their dataset. Setting <code>zero.policy</code> to <code>FALSE</code> will return an <code>error</code> if at least one polygon has no neighbor.</p>
<p>To see the weight of the first polygon’s four neighbors type:</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="spatial-autocorrelation-in-r.html#cb406-1" tabindex="-1"></a>lw<span class="sc">$</span>weights[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>[[1]]
[1] 0.25 0.25 0.25 0.25</code></pre>
<p>For polygon <code>1</code>, each neighbor is assigned a quarter of the total weight. This means that when R computes the neighboring income values, each neighbor’s income will be multiplied by <code>0.25</code> before being summed thus giving us the arithmetic mean of polygon <code>1</code>’s neighbors.</p>
</div>
<div id="app8_4" class="section level2 unnumbered hasAnchor">
<h2>Generating a Moran’s I scatter plot<a href="spatial-autocorrelation-in-r.html#app8_4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you wish to view the relationship between each polygon’s value (<code>house_inc</code> in this working example) and its spatially lagged values, you need to first extract the lagged values from the <code>lw</code> object.</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="spatial-autocorrelation-in-r.html#cb408-1" tabindex="-1"></a>ma<span class="sc">$</span>lag <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(lw, ma<span class="sc">$</span>house_inc)</span></code></pre></div>
<p>We can plot <em>lagged income</em> vs. <em>income</em> and fit a linear regression model to the data.</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="spatial-autocorrelation-in-r.html#cb409-1" tabindex="-1"></a><span class="co"># Create a regression model</span></span>
<span id="cb409-2"><a href="spatial-autocorrelation-in-r.html#cb409-2" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>(lag <span class="sc">~</span> house_inc, ma)</span>
<span id="cb409-3"><a href="spatial-autocorrelation-in-r.html#cb409-3" tabindex="-1"></a></span>
<span id="cb409-4"><a href="spatial-autocorrelation-in-r.html#cb409-4" tabindex="-1"></a><span class="co"># Plot the data</span></span>
<span id="cb409-5"><a href="spatial-autocorrelation-in-r.html#cb409-5" tabindex="-1"></a><span class="fu">plot</span>( lag <span class="sc">~</span> house_inc, ma, <span class="at">pch=</span><span class="dv">21</span>, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">las=</span><span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;grey40&quot;</span>, <span class="at">bg=</span><span class="st">&quot;grey80&quot;</span>)</span>
<span id="cb409-6"><a href="spatial-autocorrelation-in-r.html#cb409-6" tabindex="-1"></a><span class="fu">abline</span>(M, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>) <span class="co"># Add the regression line from model M</span></span>
<span id="cb409-7"><a href="spatial-autocorrelation-in-r.html#cb409-7" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(ma<span class="sc">$</span>house_inc), <span class="at">lty=</span><span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;grey80&quot;</span>)</span>
<span id="cb409-8"><a href="spatial-autocorrelation-in-r.html#cb409-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(ma<span class="sc">$</span>house_inc), <span class="at">lty=</span><span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;grey80&quot;</span>)</span></code></pre></div>
<p><img src="A09-Spatial-Autocorrelation_files/figure-html/unnamed-chunk-12-1.png" width="336" /></p>
<p>The slope of the regression model <em>is</em> the Moran’s I coefficient. The next step will show you how to compute this statistic without needing to compute the lagged values and fitting a regression model.</p>
</div>
<div id="app8_4b" class="section level2 unnumbered hasAnchor">
<h2>Computing the Moran’s I coefficient<a href="spatial-autocorrelation-in-r.html#app8_4b" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Moran’s I global statistic can be computed uisng the <code>moran</code> function. Note that you need to specify the attribute value (<code>house_inc</code> in this example) and not just the geometric elements.</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="spatial-autocorrelation-in-r.html#cb410-1" tabindex="-1"></a><span class="fu">moran</span>(ma<span class="sc">$</span>house_inc, <span class="at">listw =</span> lw, <span class="at">n =</span> <span class="fu">length</span>(nb), <span class="at">S0 =</span> <span class="fu">Szero</span>(lw))</span></code></pre></div>
<pre><code>$I
[1] 0.5199357

$K
[1] 4.602809</code></pre>
<p><code>listw</code> is passed the weights list. <code>n</code> is the total number of features having at least one neighbor. This values can be extracted via <code>length(nb)</code> . <code>S0</code> is the sum of all weights which, in our example should sum to the number of observations with non-zero neighbors. Here too, we make use of another function, <code>Szero(lw)</code> (note the uppercase <code>S</code>) to extract that number.</p>
</div>
<div id="app8_5" class="section level2 unnumbered hasAnchor">
<h2>Assessing statistical significance<a href="spatial-autocorrelation-in-r.html#app8_5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To assess if the Moran’s I statistic (i.e. the slope in the scatter plot) is significantly different from zero, we can <em>randomly</em> permute the income values across all polygons (i.e. we are not imposing any spatial autocorrelation structure), then we compute a Moran’s I coefficient for each permuted set of values. This gives us the distribution of Moran’s I values we could expect to get under the null hypothesis that the income values are randomly distributed across all census units. We then compare the observed Moran’s I value to this distribution. In this example, we’ll permute the data 999 times by setting <code>nsim = 999</code>.</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="spatial-autocorrelation-in-r.html#cb412-1" tabindex="-1"></a>MC<span class="ot">&lt;-</span> <span class="fu">moran.mc</span>(ma<span class="sc">$</span>house_inc, lw, <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb412-2"><a href="spatial-autocorrelation-in-r.html#cb412-2" tabindex="-1"></a></span>
<span id="cb412-3"><a href="spatial-autocorrelation-in-r.html#cb412-3" tabindex="-1"></a><span class="co"># View results (including pseudo p-value)</span></span>
<span id="cb412-4"><a href="spatial-autocorrelation-in-r.html#cb412-4" tabindex="-1"></a>MC</span></code></pre></div>
<pre><code>
    Monte-Carlo simulation of Moran I

data:  ma$house_inc 
weights: lw  
number of simulations + 1: 1000 

statistic = 0.51994, observed rank = 1000, p-value = 0.001
alternative hypothesis: greater</code></pre>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="spatial-autocorrelation-in-r.html#cb414-1" tabindex="-1"></a><span class="co"># Plot the distribution (note that this is a density plot instead of a histogram)</span></span>
<span id="cb414-2"><a href="spatial-autocorrelation-in-r.html#cb414-2" tabindex="-1"></a><span class="fu">plot</span>(MC, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">las=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="A09-Spatial-Autocorrelation_files/figure-html/unnamed-chunk-14-1.png" width="288" /></p>
<p>The simulation suggests that our observed Moran’s I value is not consistent with a Moran’s I value one would expect to get if the income values were not spatially autocorrelated. The pseudo p-value can be extracted from the <code>MC</code> model as:</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="spatial-autocorrelation-in-r.html#cb415-1" tabindex="-1"></a>MC<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>[1] 0.001</code></pre>
<p>In our simulation, none of the Moran’s statistics computed from the permuted data was more extreme than our observed Moran’s I value. The p-value is therefore capped by the number of simulations. in other words, we cannot compute a p-value less than <span class="math inline">\(1/(1 + N)\)</span> (where <code>N</code> is the total number of simulations) or <code>1/(1 + 999)</code> = <code>0.001</code>.</p>
<p>Note that by default, the <code>moran.mc</code> function will compute the number of simulations greater than the observed statistic. So, if the observed statistic is on the left side of the distribution, the pseudo p-value will be greater than <code>0.5</code> (note that this is a one-sided test). You can change the <em>alternative hypothesis</em> to one where we may expect a more dispersed pattern by setting the parameter <code>alternative</code> to <code>"less"</code>.</p>
</div>
<div id="app8_6" class="section level2 unnumbered hasAnchor">
<h2>Moran’s I as a function of a distance band<a href="spatial-autocorrelation-in-r.html#app8_6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this section, we will explore spatial autocorrelation as a function of distance bands.</p>
<p>Instead of defining neighbors as contiguous polygons, we will define neighbors based on distances to polygon centers. We therefore need to extract the center of each polygon.</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="spatial-autocorrelation-in-r.html#cb417-1" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">st_centroid</span>(ma)</span></code></pre></div>
<p>The object <code>xy</code> stores all 343 pairs of coordinate values (i.e. the same number of points as polygons).</p>
<p>Next, we will define the search radius to include all neighboring polygon centers that are at least 70 km away but less than 80 km away.</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="spatial-autocorrelation-in-r.html#cb418-1" tabindex="-1"></a>s.dist  <span class="ot">&lt;-</span>  <span class="fu">dnearneigh</span>(xy, <span class="dv">70000</span>, <span class="dv">80000</span>)  </span></code></pre></div>
<p>The <code>dnearneigh</code> function takes three parameters: the coordinate values <code>xy</code>, the radius for the inner radius of the annulus band, and the radius for the outer annulus band. In our example, the inner annulus radius is <code>70</code>km which implies that <strong>all</strong> polygon centers <strong>up to</strong> 70km are not included in the lagged value calculation.</p>
<p>Polygon <code>1</code> has 26 polygons as neighbors when adopting the annulus definition.</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="spatial-autocorrelation-in-r.html#cb419-1" tabindex="-1"></a>s.dist[[<span class="dv">1</span>]] <span class="sc">|&gt;</span> <span class="fu">length</span>()</span></code></pre></div>
<pre><code>[1] 26</code></pre>
<p>You can map the neighbors for polygon <code>1</code> as follows. (Polygon <code>1</code> is shown with a red fill color).</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="spatial-autocorrelation-in-r.html#cb421-1" tabindex="-1"></a>annulus1 <span class="ot">&lt;-</span> ma[s.dist[[<span class="dv">1</span>]], <span class="st">&quot;house_inc&quot;</span>] <span class="co"># Extract polygon 1&#39;s neighbors</span></span>
<span id="cb421-2"><a href="spatial-autocorrelation-in-r.html#cb421-2" tabindex="-1"></a></span>
<span id="cb421-3"><a href="spatial-autocorrelation-in-r.html#cb421-3" tabindex="-1"></a><span class="fu">tm_shape</span>(ma) <span class="sc">+</span> <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">&quot;grey80&quot;</span>) <span class="sc">+</span></span>
<span id="cb421-4"><a href="spatial-autocorrelation-in-r.html#cb421-4" tabindex="-1"></a><span class="fu">tm_shape</span>(ma[<span class="dv">1</span>,]) <span class="sc">+</span> <span class="fu">tm_fill</span>(<span class="at">col=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb421-5"><a href="spatial-autocorrelation-in-r.html#cb421-5" tabindex="-1"></a><span class="fu">tm_shape</span>(annulus1) <span class="sc">+</span> <span class="fu">tm_polygons</span>(<span class="at">style=</span><span class="st">&quot;equal&quot;</span>, <span class="at">border.col =</span> <span class="st">&quot;grey80&quot;</span>, <span class="at">lwd =</span> <span class="fl">0.5</span>,</span>
<span id="cb421-6"><a href="spatial-autocorrelation-in-r.html#cb421-6" tabindex="-1"></a>                           <span class="at">col =</span> <span class="st">&quot;house_inc&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Greens&quot;</span>) <span class="sc">+</span></span>
<span id="cb421-7"><a href="spatial-autocorrelation-in-r.html#cb421-7" tabindex="-1"></a>               <span class="fu">tm_legend</span>(<span class="at">outside =</span> <span class="cn">TRUE</span>, <span class="at">text.size =</span> .<span class="dv">8</span>)  <span class="sc">+</span></span>
<span id="cb421-8"><a href="spatial-autocorrelation-in-r.html#cb421-8" tabindex="-1"></a>               <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="A09-Spatial-Autocorrelation_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>Now that we defined the distance based neighbors for all polygons, we need to compute their weights. We will adopt the same weighing scheme used in the contiguous definition of neighbors in the earlier example.</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="spatial-autocorrelation-in-r.html#cb422-1" tabindex="-1"></a>lw <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(s.dist, <span class="at">style=</span><span class="st">&quot;W&quot;</span>, <span class="at">zero.policy=</span>T) </span></code></pre></div>
<p>The polygon <code>1</code>’s neighbors are each assigned a weight of 0.0384615.</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="spatial-autocorrelation-in-r.html#cb423-1" tabindex="-1"></a>lw<span class="sc">$</span>weights[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code> [1] 0.03846154 0.03846154 0.03846154 0.03846154 0.03846154 0.03846154
 [7] 0.03846154 0.03846154 0.03846154 0.03846154 0.03846154 0.03846154
[13] 0.03846154 0.03846154 0.03846154 0.03846154 0.03846154 0.03846154
[19] 0.03846154 0.03846154 0.03846154 0.03846154 0.03846154 0.03846154
[25] 0.03846154 0.03846154</code></pre>
<p>Run the MC simulation.</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="spatial-autocorrelation-in-r.html#cb425-1" tabindex="-1"></a>MC  <span class="ot">&lt;-</span>  <span class="fu">moran.mc</span>(ma<span class="sc">$</span>house_inc, lw, <span class="at">nsim=</span><span class="dv">599</span>, <span class="at">zero.policy=</span>T) </span></code></pre></div>
<p>Plot the results.</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="spatial-autocorrelation-in-r.html#cb426-1" tabindex="-1"></a><span class="fu">plot</span>(MC, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">las=</span><span class="dv">1</span>) </span></code></pre></div>
<p><img src="A09-Spatial-Autocorrelation_files/figure-html/unnamed-chunk-23-1.png" width="288" /></p>
<p>Here, we are observing a different statistical outcome. The observed Moran’s I coefficient is on the left side of the distribution suggesting that income values tend to be more different than similar when separated by a 50 km distance.</p>
<p>Display p-value and other summary statistics.</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="spatial-autocorrelation-in-r.html#cb427-1" tabindex="-1"></a>MC</span></code></pre></div>
<pre><code>
    Monte-Carlo simulation of Moran I

data:  ma$house_inc 
weights: lw  
number of simulations + 1: 600 

statistic = -0.027383, observed rank = 32, p-value = 0.9467
alternative hypothesis: greater</code></pre>
<p>Since we went with the default alternative parameter of <code>"greater"</code> in the <code>moran.mc</code> function, the output is giving us the fraction of simulated values greater than our observed value–about 94.7% in our example. Given that our observed statistic is on the left side of the distribution, it’s best to report the p-value as (1 - 0.947) or 0.053 with the alternative hypothesis that the values are more dissimilar than expected.</p>
</div>
<div id="app8_7" class="section level2 unnumbered hasAnchor">
<h2>Local Moran’s I<a href="spatial-autocorrelation-in-r.html#app8_7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To compute local indicators of spatial autocorrelation (Local Moran’s I), we can make use of the <code>localmoran</code> function from the <code>spdep</code> package. However, this function adopts an analytical approach to computing the p-value. It’s best to adopt a Monte Carlo approach. This can be performed using the <code>localmoran_perm</code> function. In this example, we will run <code>9999</code> permutations for each polygon.</p>
<p>We’ll first revert to our earlier definition of neighbor (i.e. one of contiguity).</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="spatial-autocorrelation-in-r.html#cb429-1" tabindex="-1"></a>lw <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(nb, <span class="at">style=</span><span class="st">&quot;W&quot;</span>, <span class="at">zero.policy=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>Next, we’ll run the local Moran’s I analysis using the <code>localmoran_perm</code> function.</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="spatial-autocorrelation-in-r.html#cb430-1" tabindex="-1"></a>MCi <span class="ot">&lt;-</span> <span class="fu">localmoran_perm</span>(ma<span class="sc">$</span>house_inc, lw, <span class="at">nsim =</span> <span class="dv">9999</span>)</span>
<span id="cb430-2"><a href="spatial-autocorrelation-in-r.html#cb430-2" tabindex="-1"></a>MCi.df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(MCi) </span></code></pre></div>
<p>The object <code>MCi</code> stores several parameters including the local Moran’s statistic for each polygon, <span class="math inline">\(I_i\)</span>, and its associated pseudo p-value. <code>MCi.df</code> is a dataframe version of the <code>MCi</code>object.</p>
<p>Next, we’ll add the pseudo p-values to the <code>ma</code> spatial object.</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="spatial-autocorrelation-in-r.html#cb431-1" tabindex="-1"></a>ma<span class="sc">$</span>p  <span class="ot">&lt;-</span> MCi.df<span class="sc">$</span><span class="st">`</span><span class="at">Pr(folded) Sim</span><span class="st">`</span></span></code></pre></div>
<p>Note that the <code>localmoran_perm</code> function generates two different p-values: <code>MCi.df$`Pr(z != E(Ii)) Sim`</code> and <code>MCi.df$`Pr(folded) Sim`</code>. The former is for a two sided test (<code>alternative = "two.sided"</code>) and the latter is a “folded” p-value for a one-sided test.</p>
<p>We can generate a map of the pseudo p-values as follows:</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="spatial-autocorrelation-in-r.html#cb432-1" tabindex="-1"></a>pal1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#DE2D26&quot;</span>,<span class="st">&quot;#FC9272&quot;</span>, <span class="st">&quot;#FEE0D2&quot;</span>, <span class="st">&quot;grey90&quot;</span>)</span>
<span id="cb432-2"><a href="spatial-autocorrelation-in-r.html#cb432-2" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb432-3"><a href="spatial-autocorrelation-in-r.html#cb432-3" tabindex="-1"></a><span class="fu">tm_shape</span>(ma) <span class="sc">+</span> <span class="fu">tm_polygons</span>(<span class="at">style=</span><span class="st">&quot;fixed&quot;</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.5</span>),</span>
<span id="cb432-4"><a href="spatial-autocorrelation-in-r.html#cb432-4" tabindex="-1"></a>                           <span class="at">col =</span> <span class="st">&quot;p&quot;</span>, <span class="at">palette=</span>pal1, <span class="at">border.col =</span> <span class="st">&quot;grey80&quot;</span>, <span class="at">lwd =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb432-5"><a href="spatial-autocorrelation-in-r.html#cb432-5" tabindex="-1"></a>               <span class="fu">tm_legend</span>(<span class="at">outside =</span> <span class="cn">TRUE</span>, <span class="at">text.size =</span> .<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb432-6"><a href="spatial-autocorrelation-in-r.html#cb432-6" tabindex="-1"></a>               <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>) </span></code></pre></div>
<p><img src="A09-Spatial-Autocorrelation_files/figure-html/unnamed-chunk-28-1.png" width="576" /></p>
<p>Next, we’ll map the significant clusters.</p>
<p>First, we will use the <code>hotspot</code> function to identify “significant” clusters using a p-value cutoff of <code>0.05</code>. Since the output is a factor, a manipulation of its levels is made to facilitate the assignment of colors when generating the map.</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="spatial-autocorrelation-in-r.html#cb433-1" tabindex="-1"></a>ma<span class="sc">$</span>Ii <span class="ot">&lt;-</span> <span class="fu">hotspot</span>(MCi, <span class="at">Prname=</span><span class="st">&quot;Pr(folded) Sim&quot;</span>, <span class="at">cutoff =</span> <span class="fl">0.05</span>, <span class="at">p.adjust =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb433-2"><a href="spatial-autocorrelation-in-r.html#cb433-2" tabindex="-1"></a></span>
<span id="cb433-3"><a href="spatial-autocorrelation-in-r.html#cb433-3" tabindex="-1"></a><span class="co"># Replace NA with &quot;&gt;0.05&quot;. This requires that the Ii factor be re-leveled</span></span>
<span id="cb433-4"><a href="spatial-autocorrelation-in-r.html#cb433-4" tabindex="-1"></a>ma<span class="sc">$</span>Ii <span class="ot">&lt;-</span> <span class="fu">factor</span>(ma<span class="sc">$</span>Ii, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;High-High&quot;</span>,<span class="st">&quot;Low-Low&quot;</span>, <span class="st">&quot;Low-High&quot;</span>, <span class="st">&quot;High-Low&quot;</span>, <span class="st">&quot;&gt;0.05&quot;</span>))</span>
<span id="cb433-5"><a href="spatial-autocorrelation-in-r.html#cb433-5" tabindex="-1"></a>ma<span class="sc">$</span>Ii[<span class="fu">is.na</span>(ma<span class="sc">$</span>Ii)] <span class="ot">&lt;-</span> <span class="st">&quot;&gt;0.05&quot;</span></span></code></pre></div>
<p>Next, we define the color palette, then we generate the map.</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="spatial-autocorrelation-in-r.html#cb434-1" tabindex="-1"></a>pal2 <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">&quot;#FF0000&quot;</span>, <span class="st">&quot;#0000FF&quot;</span>, <span class="st">&quot;#a7adf9&quot;</span>, <span class="st">&quot;#f4ada8&quot;</span>,<span class="st">&quot;#ededed&quot;</span>)</span>
<span id="cb434-2"><a href="spatial-autocorrelation-in-r.html#cb434-2" tabindex="-1"></a></span>
<span id="cb434-3"><a href="spatial-autocorrelation-in-r.html#cb434-3" tabindex="-1"></a><span class="fu">tm_shape</span>(ma) <span class="sc">+</span> <span class="fu">tm_polygons</span>(<span class="at">style=</span><span class="st">&quot;cat&quot;</span>, <span class="at">border.col =</span> <span class="st">&quot;grey80&quot;</span>, <span class="at">lwd =</span> <span class="fl">0.5</span>,</span>
<span id="cb434-4"><a href="spatial-autocorrelation-in-r.html#cb434-4" tabindex="-1"></a>                           <span class="at">col =</span> <span class="st">&quot;Ii&quot;</span>, <span class="at">palette=</span>pal2) <span class="sc">+</span></span>
<span id="cb434-5"><a href="spatial-autocorrelation-in-r.html#cb434-5" tabindex="-1"></a>               <span class="fu">tm_legend</span>(<span class="at">outside =</span> <span class="cn">TRUE</span>, <span class="at">text.size =</span> .<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb434-6"><a href="spatial-autocorrelation-in-r.html#cb434-6" tabindex="-1"></a>               <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="A09-Spatial-Autocorrelation_files/figure-html/unnamed-chunk-30-1.png" width="576" /></p>
<div id="app8_7_1" class="section level3 unnumbered hasAnchor">
<h3>Correcting for multiple comparisons<a href="spatial-autocorrelation-in-r.html#app8_7_1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>p.adjust</code> parameter in the <code>hotspot</code> function can be used to correct for multiple tests. One popular correction is the False Discovery Rate (FDR) that can be implemented by setting <code>p.adjust</code> to <code>"fdr"</code>.</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="spatial-autocorrelation-in-r.html#cb435-1" tabindex="-1"></a>ma<span class="sc">$</span>Ii <span class="ot">&lt;-</span> <span class="fu">hotspot</span>(MCi, <span class="at">Prname=</span><span class="st">&quot;Pr(folded) Sim&quot;</span>, <span class="at">cutoff =</span> <span class="fl">0.05</span>, <span class="at">p.adjust =</span> <span class="st">&quot;fdr&quot;</span>)</span>
<span id="cb435-2"><a href="spatial-autocorrelation-in-r.html#cb435-2" tabindex="-1"></a></span>
<span id="cb435-3"><a href="spatial-autocorrelation-in-r.html#cb435-3" tabindex="-1"></a><span class="co"># Replace NA with &quot;&gt;0.05&quot;. This requires that the Ii factor be re-leveled</span></span>
<span id="cb435-4"><a href="spatial-autocorrelation-in-r.html#cb435-4" tabindex="-1"></a>ma<span class="sc">$</span>Ii <span class="ot">&lt;-</span> <span class="fu">factor</span>(ma<span class="sc">$</span>Ii, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;High-High&quot;</span>,<span class="st">&quot;Low-Low&quot;</span>, <span class="st">&quot;Low-High&quot;</span>, <span class="st">&quot;High-Low&quot;</span>, <span class="st">&quot;&gt;0.05 corrected&quot;</span>))</span>
<span id="cb435-5"><a href="spatial-autocorrelation-in-r.html#cb435-5" tabindex="-1"></a>ma<span class="sc">$</span>Ii[<span class="fu">is.na</span>(ma<span class="sc">$</span>Ii)] <span class="ot">&lt;-</span> <span class="st">&quot;&gt;0.05 corrected&quot;</span></span></code></pre></div>
<p>We now have a more stringent implementation of the p-value.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="spatial-autocorrelation-in-r.html#cb436-1" tabindex="-1"></a><span class="fu">tm_shape</span>(ma) <span class="sc">+</span> <span class="fu">tm_polygons</span>(<span class="at">style=</span><span class="st">&quot;cat&quot;</span>, <span class="at">border.col =</span> <span class="st">&quot;grey80&quot;</span>, <span class="at">lwd =</span> <span class="fl">0.5</span>,</span>
<span id="cb436-2"><a href="spatial-autocorrelation-in-r.html#cb436-2" tabindex="-1"></a>                           <span class="at">col =</span> <span class="st">&quot;Ii&quot;</span>, <span class="at">palette=</span>pal2) <span class="sc">+</span></span>
<span id="cb436-3"><a href="spatial-autocorrelation-in-r.html#cb436-3" tabindex="-1"></a>               <span class="fu">tm_legend</span>(<span class="at">outside =</span> <span class="cn">TRUE</span>, <span class="at">text.size =</span> .<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb436-4"><a href="spatial-autocorrelation-in-r.html#cb436-4" tabindex="-1"></a>               <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>) </span></code></pre></div>
<p><img src="A09-Spatial-Autocorrelation_files/figure-html/unnamed-chunk-32-1.png" width="576" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="point-pattern-analysis-in-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="interpolation-in-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": false,
    "twitter": false,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": false,
    "google": false,
    "instapper": false
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": {},
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section",
    "scroll_highlight": true
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
