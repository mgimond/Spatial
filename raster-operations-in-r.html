<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>F Raster operations in R | Intro to GIS and Spatial Analysis</title>
  <meta name="description" content="This is a compilation of lecture notes that accompany my Intro to GIS and Spatial Analysis course." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="F Raster operations in R | Intro to GIS and Spatial Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a compilation of lecture notes that accompany my Intro to GIS and Spatial Analysis course." />
  <meta name="github-repo" content="mgimond/spatial" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="F Raster operations in R | Intro to GIS and Spatial Analysis" />
  
  <meta name="twitter:description" content="This is a compilation of lecture notes that accompany my Intro to GIS and Spatial Analysis course." />
  

<meta name="author" content="Manuel Gimond" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mapping-rates-in-r.html"/>
<link rel="next" href="coordinate-systems-in-r.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introGIS.html"><a href="introGIS.html"><i class="fa fa-check"></i><b>1</b> Introduction to GIS</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introGIS.html"><a href="introGIS.html#what-is-a-gis"><i class="fa fa-check"></i><b>1.1</b> What is a GIS?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introGIS.html"><a href="introGIS.html#gis-software"><i class="fa fa-check"></i><b>1.1.1</b> GIS software</a></li>
<li class="chapter" data-level="1.1.2" data-path="introGIS.html"><a href="introGIS.html#qgis"><i class="fa fa-check"></i><b>1.1.2</b> QGIS</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introGIS.html"><a href="introGIS.html#what-is-spatial-analysis"><i class="fa fa-check"></i><b>1.2</b> What is Spatial Analysis?</a></li>
<li class="chapter" data-level="1.3" data-path="introGIS.html"><a href="introGIS.html#whats-in-an-acronym"><i class="fa fa-check"></i><b>1.3</b> What’s in an Acronym?</a></li>
</ul></li>
<li class="part"><span><b>PART 1: Working with spatial data</b></span></li>
<li class="chapter" data-level="2" data-path="chp02_0.html"><a href="chp02_0.html"><i class="fa fa-check"></i><b>2</b> Feature Representation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chp02_0.html"><a href="chp02_0.html#vector-vs.-raster"><i class="fa fa-check"></i><b>2.1</b> Vector vs. Raster</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chp02_0.html"><a href="chp02_0.html#vector"><i class="fa fa-check"></i><b>2.1.1</b> Vector</a></li>
<li class="chapter" data-level="2.1.2" data-path="chp02_0.html"><a href="chp02_0.html#raster"><i class="fa fa-check"></i><b>2.1.2</b> Raster</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chp02_0.html"><a href="chp02_0.html#object-vs.-field"><i class="fa fa-check"></i><b>2.2</b> Object vs. Field</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chp02_0.html"><a href="chp02_0.html#object-view"><i class="fa fa-check"></i><b>2.2.1</b> Object View</a></li>
<li class="chapter" data-level="2.2.2" data-path="chp02_0.html"><a href="chp02_0.html#field-view"><i class="fa fa-check"></i><b>2.2.2</b> Field View</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="chp02_0.html"><a href="chp02_0.html#scale"><i class="fa fa-check"></i><b>2.3</b> Scale</a></li>
<li class="chapter" data-level="2.4" data-path="chp02_0.html"><a href="chp02_0.html#attribute-tables"><i class="fa fa-check"></i><b>2.4</b> Attribute Tables</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="chp02_0.html"><a href="chp02_0.html#measurement-levels"><i class="fa fa-check"></i><b>2.4.1</b> Measurement Levels</a></li>
<li class="chapter" data-level="2.4.2" data-path="chp02_0.html"><a href="chp02_0.html#data-type"><i class="fa fa-check"></i><b>2.4.2</b> Data type</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="gis-data-management.html"><a href="gis-data-management.html"><i class="fa fa-check"></i><b>3</b> GIS Data Management</a>
<ul>
<li class="chapter" data-level="3.1" data-path="gis-data-management.html"><a href="gis-data-management.html#gis-file-data-formats"><i class="fa fa-check"></i><b>3.1</b> GIS File Data Formats</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="gis-data-management.html"><a href="gis-data-management.html#vector-data-file-formats"><i class="fa fa-check"></i><b>3.1.1</b> Vector Data File Formats</a></li>
<li class="chapter" data-level="3.1.2" data-path="gis-data-management.html"><a href="gis-data-management.html#raster-data-file-formats"><i class="fa fa-check"></i><b>3.1.2</b> Raster Data File Formats</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="gis-data-management.html"><a href="gis-data-management.html#managing-gis-files-in-arcgis"><i class="fa fa-check"></i><b>3.2</b> Managing GIS Files in ArcGIS</a></li>
<li class="chapter" data-level="3.3" data-path="gis-data-management.html"><a href="gis-data-management.html#managing-a-map-project-in-arcgis"><i class="fa fa-check"></i><b>3.3</b> Managing a Map Project in ArcGIS</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="symbolizing-features.html"><a href="symbolizing-features.html"><i class="fa fa-check"></i><b>4</b> Symbolizing features</a>
<ul>
<li class="chapter" data-level="4.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#color"><i class="fa fa-check"></i><b>4.1</b> Color</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#hue"><i class="fa fa-check"></i><b>4.1.1</b> Hue</a></li>
<li class="chapter" data-level="4.1.2" data-path="symbolizing-features.html"><a href="symbolizing-features.html#lightness"><i class="fa fa-check"></i><b>4.1.2</b> Lightness</a></li>
<li class="chapter" data-level="4.1.3" data-path="symbolizing-features.html"><a href="symbolizing-features.html#saturation"><i class="fa fa-check"></i><b>4.1.3</b> Saturation</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="symbolizing-features.html"><a href="symbolizing-features.html#color-space"><i class="fa fa-check"></i><b>4.2</b> Color Space</a></li>
<li class="chapter" data-level="4.3" data-path="symbolizing-features.html"><a href="symbolizing-features.html#classification"><i class="fa fa-check"></i><b>4.3</b> Classification</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#qualitative-color-scheme"><i class="fa fa-check"></i><b>4.3.1</b> Qualitative color scheme</a></li>
<li class="chapter" data-level="4.3.2" data-path="symbolizing-features.html"><a href="symbolizing-features.html#sequential-color-scheme"><i class="fa fa-check"></i><b>4.3.2</b> Sequential color scheme</a></li>
<li class="chapter" data-level="4.3.3" data-path="symbolizing-features.html"><a href="symbolizing-features.html#divergent-color-scheme"><i class="fa fa-check"></i><b>4.3.3</b> Divergent color scheme</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="symbolizing-features.html"><a href="symbolizing-features.html#so-how-do-i-find-a-proper-color-scheme-for-my-data"><i class="fa fa-check"></i><b>4.4</b> So how do I find a proper color scheme for my data?</a></li>
<li class="chapter" data-level="4.5" data-path="symbolizing-features.html"><a href="symbolizing-features.html#classification-intervals"><i class="fa fa-check"></i><b>4.5</b> Classification Intervals</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#an-interactive-example"><i class="fa fa-check"></i><b>4.5.1</b> An Interactive Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html"><i class="fa fa-check"></i><b>5</b> Pitfalls to avoid</a>
<ul>
<li class="chapter" data-level="5.1" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#representing-count"><i class="fa fa-check"></i><b>5.1</b> Representing Count</a></li>
<li class="chapter" data-level="5.2" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#maup"><i class="fa fa-check"></i><b>5.2</b> MAUP</a></li>
<li class="chapter" data-level="5.3" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#ecological-fallacy"><i class="fa fa-check"></i><b>5.3</b> Ecological Fallacy</a></li>
<li class="chapter" data-level="5.4" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#mapping-rates"><i class="fa fa-check"></i><b>5.4</b> Mapping rates</a></li>
<li class="chapter" data-level="5.5" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#coping-with-unstable-rates"><i class="fa fa-check"></i><b>5.5</b> Coping with Unstable Rates</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html"><i class="fa fa-check"></i><b>6</b> Good Map Making Tips</a>
<ul>
<li class="chapter" data-level="6.1" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html#elements-of-a-map"><i class="fa fa-check"></i><b>6.1</b> Elements of a map</a></li>
<li class="chapter" data-level="6.2" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html#how-to-create-a-good-map"><i class="fa fa-check"></i><b>6.2</b> How to create a <em>good</em> map</a></li>
<li class="chapter" data-level="6.3" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html#typefaces-and-fonts"><i class="fa fa-check"></i><b>6.3</b> Typefaces and Fonts</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html"><i class="fa fa-check"></i><b>7</b> Uncertainty in Census Data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#mapping-uncertainty"><i class="fa fa-check"></i><b>7.2</b> Mapping uncertainty</a></li>
<li class="chapter" data-level="7.3" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#problems-in-mapping-uncertainty"><i class="fa fa-check"></i><b>7.3</b> Problems in mapping uncertainty</a></li>
<li class="chapter" data-level="7.4" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#class-comparison-maps"><i class="fa fa-check"></i><b>7.4</b> Class comparison maps</a></li>
<li class="chapter" data-level="7.5" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#problem-when-performing-bivariate-analysis"><i class="fa fa-check"></i><b>7.5</b> Problem when performing bivariate analysis</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html"><i class="fa fa-check"></i><b>8</b> Spatial Operations and Vector Overlays</a>
<ul>
<li class="chapter" data-level="8.1" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#selection-by-attribute"><i class="fa fa-check"></i><b>8.1</b> Selection by Attribute</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#set-algebra"><i class="fa fa-check"></i><b>8.1.1</b> Set Algebra</a></li>
<li class="chapter" data-level="8.1.2" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#boolean-algebra"><i class="fa fa-check"></i><b>8.1.2</b> Boolean Algebra</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#selection-by-location"><i class="fa fa-check"></i><b>8.2</b> Selection by location</a></li>
<li class="chapter" data-level="8.3" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#vector-overlay"><i class="fa fa-check"></i><b>8.3</b> Vector Overlay</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#clip"><i class="fa fa-check"></i><b>8.3.1</b> Clip</a></li>
<li class="chapter" data-level="8.3.2" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#intersect"><i class="fa fa-check"></i><b>8.3.2</b> Intersect</a></li>
<li class="chapter" data-level="8.3.3" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#union"><i class="fa fa-check"></i><b>8.3.3</b> Union</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chp09_0.html"><a href="chp09_0.html"><i class="fa fa-check"></i><b>9</b> Coordinate Systems</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chp09_0.html"><a href="chp09_0.html#geographic-coordinate-systems"><i class="fa fa-check"></i><b>9.1</b> Geographic Coordinate Systems</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="chp09_0.html"><a href="chp09_0.html#sphere-and-ellipsoid"><i class="fa fa-check"></i><b>9.1.1</b> Sphere and Ellipsoid</a></li>
<li class="chapter" data-level="9.1.2" data-path="chp09_0.html"><a href="chp09_0.html#geoid"><i class="fa fa-check"></i><b>9.1.2</b> Geoid</a></li>
<li class="chapter" data-level="9.1.3" data-path="chp09_0.html"><a href="chp09_0.html#datum"><i class="fa fa-check"></i><b>9.1.3</b> Datum</a></li>
<li class="chapter" data-level="9.1.4" data-path="chp09_0.html"><a href="chp09_0.html#building-the-geographic-coordinate-system"><i class="fa fa-check"></i><b>9.1.4</b> Building the Geographic Coordinate System</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="chp09_0.html"><a href="chp09_0.html#projected-coordinate-systems"><i class="fa fa-check"></i><b>9.2</b> Projected Coordinate Systems</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="chp09_0.html"><a href="chp09_0.html#planar-projections"><i class="fa fa-check"></i><b>9.2.1</b> Planar Projections</a></li>
<li class="chapter" data-level="9.2.2" data-path="chp09_0.html"><a href="chp09_0.html#cylindrical-projection"><i class="fa fa-check"></i><b>9.2.2</b> Cylindrical Projection</a></li>
<li class="chapter" data-level="9.2.3" data-path="chp09_0.html"><a href="chp09_0.html#conical-projection"><i class="fa fa-check"></i><b>9.2.3</b> Conical Projection</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="chp09_0.html"><a href="chp09_0.html#spatial-properties"><i class="fa fa-check"></i><b>9.3</b> Spatial Properties</a></li>
<li class="chapter" data-level="9.4" data-path="chp09_0.html"><a href="chp09_0.html#geodesic-geometries"><i class="fa fa-check"></i><b>9.4</b> Geodesic geometries</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chp10_0.html"><a href="chp10_0.html"><i class="fa fa-check"></i><b>10</b> Map Algebra</a>
<ul>
<li class="chapter" data-level="10.1" data-path="chp10_0.html"><a href="chp10_0.html#local-operations-and-functions"><i class="fa fa-check"></i><b>10.1</b> Local operations and functions</a></li>
<li class="chapter" data-level="10.2" data-path="chp10_0.html"><a href="chp10_0.html#focal-operations-and-functions"><i class="fa fa-check"></i><b>10.2</b> Focal operations and functions</a></li>
<li class="chapter" data-level="10.3" data-path="chp10_0.html"><a href="chp10_0.html#zonal-operations-and-functions"><i class="fa fa-check"></i><b>10.3</b> Zonal operations and functions</a></li>
<li class="chapter" data-level="10.4" data-path="chp10_0.html"><a href="chp10_0.html#global-operations-and-functions"><i class="fa fa-check"></i><b>10.4</b> Global operations and functions</a></li>
<li class="chapter" data-level="10.5" data-path="chp10_0.html"><a href="chp10_0.html#operators-and-functions"><i class="fa fa-check"></i><b>10.5</b> Operators and functions</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="chp10_0.html"><a href="chp10_0.html#mathematical-operators-and-functions"><i class="fa fa-check"></i><b>10.5.1</b> Mathematical operators and functions</a></li>
<li class="chapter" data-level="10.5.2" data-path="chp10_0.html"><a href="chp10_0.html#logical-comparison"><i class="fa fa-check"></i><b>10.5.2</b> Logical comparison</a></li>
<li class="chapter" data-level="10.5.3" data-path="chp10_0.html"><a href="chp10_0.html#boolean-or-logical-operators"><i class="fa fa-check"></i><b>10.5.3</b> Boolean (or Logical) operators</a></li>
<li class="chapter" data-level="10.5.4" data-path="chp10_0.html"><a href="chp10_0.html#combining-operations"><i class="fa fa-check"></i><b>10.5.4</b> Combining operations</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>PART 2: Spatial Analysis</b></span></li>
<li class="chapter" data-level="11" data-path="chp11_0.html"><a href="chp11_0.html"><i class="fa fa-check"></i><b>11</b> Point Pattern Analysis</a>
<ul>
<li class="chapter" data-level="11.1" data-path="chp11_0.html"><a href="chp11_0.html#centrography"><i class="fa fa-check"></i><b>11.1</b> Centrography</a></li>
<li class="chapter" data-level="11.2" data-path="chp11_0.html"><a href="chp11_0.html#density-based-analysis"><i class="fa fa-check"></i><b>11.2</b> Density based analysis</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="chp11_0.html"><a href="chp11_0.html#global-density"><i class="fa fa-check"></i><b>11.2.1</b> Global density</a></li>
<li class="chapter" data-level="11.2.2" data-path="chp11_0.html"><a href="chp11_0.html#local-density"><i class="fa fa-check"></i><b>11.2.2</b> Local density</a></li>
<li class="chapter" data-level="11.2.3" data-path="chp11_0.html"><a href="chp11_0.html#modeling-intensity-as-a-function-of-a-covariate"><i class="fa fa-check"></i><b>11.2.3</b> Modeling intensity as a function of a covariate</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="chp11_0.html"><a href="chp11_0.html#distance-based-analysis"><i class="fa fa-check"></i><b>11.3</b> Distance based analysis</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="chp11_0.html"><a href="chp11_0.html#average-nearest-neighbor"><i class="fa fa-check"></i><b>11.3.1</b> Average Nearest Neighbor</a></li>
<li class="chapter" data-level="11.3.2" data-path="chp11_0.html"><a href="chp11_0.html#k-and-l-functions"><i class="fa fa-check"></i><b>11.3.2</b> K and L functions</a></li>
<li class="chapter" data-level="11.3.3" data-path="chp11_0.html"><a href="chp11_0.html#the-pair-correlation-function-g"><i class="fa fa-check"></i><b>11.3.3</b> The Pair Correlation Function <span class="math inline">\(g\)</span></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="chp11_0.html"><a href="chp11_0.html#first-and-second-order-effects"><i class="fa fa-check"></i><b>11.4</b> First and second order effects</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>12</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="12.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#irpcsr"><i class="fa fa-check"></i><b>12.1</b> IRP/CSR</a></li>
<li class="chapter" data-level="12.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#testing-for-csr-with-the-ann-tool"><i class="fa fa-check"></i><b>12.2</b> Testing for CSR with the ANN tool</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#arcgis-average-nearest-neighbor-tool"><i class="fa fa-check"></i><b>12.2.1</b> ArcGIS’ Average Nearest Neighbor Tool</a></li>
<li class="chapter" data-level="12.2.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#a-better-approach-a-monte-carlo-test"><i class="fa fa-check"></i><b>12.2.2</b> A better approach: a Monte Carlo test</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#alternatives-to-csrirp"><i class="fa fa-check"></i><b>12.3</b> Alternatives to CSR/IRP</a></li>
<li class="chapter" data-level="12.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#monte-carlo-test-with-k-and-l-functions"><i class="fa fa-check"></i><b>12.4</b> Monte Carlo test with K and L functions</a></li>
<li class="chapter" data-level="12.5" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#PPM"><i class="fa fa-check"></i><b>12.5</b> Testing for a covariate effect</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html"><i class="fa fa-check"></i><b>13</b> Spatial Autocorrelation</a>
<ul>
<li class="chapter" data-level="13.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#global-morans-i"><i class="fa fa-check"></i><b>13.1</b> Global Moran’s I</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#computing-the-morans-i"><i class="fa fa-check"></i><b>13.1.1</b> Computing the Moran’s I</a></li>
<li class="chapter" data-level="13.1.2" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#monte-carlo-approach-to-estimating-significance"><i class="fa fa-check"></i><b>13.1.2</b> Monte Carlo approach to estimating significance</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#morans-i-at-different-lags"><i class="fa fa-check"></i><b>13.2</b> Moran’s I at different lags</a></li>
<li class="chapter" data-level="13.3" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#local-morans-i"><i class="fa fa-check"></i><b>13.3</b> Local Moran’s I</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html"><i class="fa fa-check"></i><b>14</b> Spatial Interpolation</a>
<ul>
<li class="chapter" data-level="14.1" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#deterministic-approach-to-interpolation"><i class="fa fa-check"></i><b>14.1</b> Deterministic Approach to Interpolation</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#proximity-interpolation"><i class="fa fa-check"></i><b>14.1.1</b> Proximity interpolation</a></li>
<li class="chapter" data-level="14.1.2" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#inverse-distance-weighted-idw"><i class="fa fa-check"></i><b>14.1.2</b> Inverse Distance Weighted (IDW)</a></li>
<li class="chapter" data-level="14.1.3" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#fine-tuning-the-interpolation-parameters"><i class="fa fa-check"></i><b>14.1.3</b> Fine tuning the interpolation parameters</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#statistical-approach-to-interpolation"><i class="fa fa-check"></i><b>14.2</b> Statistical Approach to Interpolation</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#trend-surfaces"><i class="fa fa-check"></i><b>14.2.1</b> Trend Surfaces</a></li>
<li class="chapter" data-level="14.2.2" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#ordinary-kriging"><i class="fa fa-check"></i><b>14.2.2</b> Ordinary Kriging</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>15</b> References</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html"><i class="fa fa-check"></i><b>A</b> Reading and writing spatial data in R</a>
<ul>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_2"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_3"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_4"><i class="fa fa-check"></i>Creating spatial objects</a>
<ul>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_4_1"><i class="fa fa-check"></i>Reading a shapefile</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_4_2"><i class="fa fa-check"></i>Reading a GeoPackage</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_4_3"><i class="fa fa-check"></i>Reading a raster</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_4_5"><i class="fa fa-check"></i>Creating a spatial object from a data frame</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_4_6"><i class="fa fa-check"></i>Geocoding street addresses</a></li>
</ul></li>
<li><a href="reading-and-writing-spatial-data-in-r.html#app1_5">Converting from an <code>sf</code> object</a>
<ul>
<li><a href="reading-and-writing-spatial-data-in-r.html#app1_5_1">Converting an <code>sf</code> object to a <code>Spatial*</code> object (<code>spdep</code>/<code>sp</code>)</a></li>
<li><a href="reading-and-writing-spatial-data-in-r.html#app1_5_2">Converting an <code>sf</code> polygon object to an <code>owin</code> object</a></li>
<li><a href="reading-and-writing-spatial-data-in-r.html#app1_5_3">Converting an <code>sf</code> point object to a <code>ppp</code> object</a></li>
<li><a href="reading-and-writing-spatial-data-in-r.html#app1_5_4">Converting a <code>raster</code> object to an <code>im</code> object (<code>spatstat</code>)</a></li>
</ul></li>
<li><a href="reading-and-writing-spatial-data-in-r.html#app1_6">Converting to an <code>sf</code> object</a></li>
<li><a href="reading-and-writing-spatial-data-in-r.html#app1_7">Dissecting the <code>sf</code> file object</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-spatial-data-in-r.html"><a href="reading-and-writing-spatial-data-in-r.html#app1_8"><i class="fa fa-check"></i>Exporting to different data file formats</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html"><i class="fa fa-check"></i><b>B</b> Mapping data in R</a>
<ul>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#sample-files-for-this-exercise"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li><a href="mapping-data-in-r.html#tmap"><code>tmap</code></a>
<ul>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#the-basics"><i class="fa fa-check"></i>The basics</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#combining-layers"><i class="fa fa-check"></i>Combining layers</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#tweaking-classification-schemes"><i class="fa fa-check"></i>Tweaking classification schemes</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#tweaking-colors"><i class="fa fa-check"></i>Tweaking colors</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#adding-labels"><i class="fa fa-check"></i>Adding labels</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#adding-a-grid-or-graticule"><i class="fa fa-check"></i>Adding a grid or graticule</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#adding-statistical-plots"><i class="fa fa-check"></i>Adding statistical plots</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#mapping-raster-files"><i class="fa fa-check"></i>Mapping raster files</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#changing-coordinate-systems"><i class="fa fa-check"></i>Changing coordinate systems</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#side-by-side-maps"><i class="fa fa-check"></i>Side-by-side maps</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#splitting-data-by-polygons-or-group-of-polygons"><i class="fa fa-check"></i>Splitting data by polygons or group of polygons</a></li>
</ul></li>
<li><a href="mapping-data-in-r.html#ggplot2"><code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#the-basics-1"><i class="fa fa-check"></i>The basics</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#tweaking-classification-schemes-1"><i class="fa fa-check"></i>Tweaking classification schemes</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#combining-layers-1"><i class="fa fa-check"></i>Combining layers</a></li>
</ul></li>
<li><a href="mapping-data-in-r.html#plot_sf"><code>plot_sf</code></a>
<ul>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#the-basics-2"><i class="fa fa-check"></i>The basics</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#adding-a-graticule"><i class="fa fa-check"></i>Adding a graticule</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#combining-layers-2"><i class="fa fa-check"></i>Combining layers</a></li>
<li class="chapter" data-level="" data-path="mapping-data-in-r.html"><a href="mapping-data-in-r.html#tweaking-colors-1"><i class="fa fa-check"></i>Tweaking colors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html"><i class="fa fa-check"></i><b>C</b> Anatomy of simple feature objects</a>
<ul>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#creating-point-sf-objects"><i class="fa fa-check"></i>Creating point ‘sf’ objects</a>
<ul>
<li><a href="anatomy-of-simple-feature-objects.html#step-1-create-the-point-geometry-sfg">Step 1: Create the point geometry: <code>sfg</code></a></li>
<li><a href="anatomy-of-simple-feature-objects.html#step-2-create-a-column-of-simple-feature-geometries-sfc">Step 2: Create a column of simple feature geometries: <code>sfc</code></a></li>
<li><a href="anatomy-of-simple-feature-objects.html#step-3-create-the-simple-feature-object-sf">Step 3: Create the simple feature object <code>sf</code></a></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#renaming-the-geometry-column"><i class="fa fa-check"></i>Renaming the geometry column</a></li>
<li><a href="anatomy-of-simple-feature-objects.html#adding-attributes-to-an-sf-object">Adding attributes to an <code>sf</code> object</a></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#adding-a-geometry-column-to-an-existing-non-spatial-dataframe"><i class="fa fa-check"></i>Adding a geometry column to an existing non-spatial dataframe</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#creating-polyline-sf-objects"><i class="fa fa-check"></i>Creating polyline ‘sf’ objects</a>
<ul>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#creating-branching-polyline-features"><i class="fa fa-check"></i>Creating branching polyline features</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#creating-polygon-sf-objects"><i class="fa fa-check"></i>Creating polygon ‘sf’ objects</a>
<ul>
<li><a href="anatomy-of-simple-feature-objects.html#polygon-simple-feature"><code>POLYGON</code> simple feature</a></li>
<li><a href="anatomy-of-simple-feature-objects.html#multipolygon-simple-feature-multipart-features"><code>MULTIPOLYGON</code> simple feature: multipart features</a></li>
</ul></li>
<li><a href="anatomy-of-simple-feature-objects.html#extracting-geometry-from-an-sf-object">Extracting geometry from an <code>sf</code> object</a></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#alternative-syntax"><i class="fa fa-check"></i>Alternative syntax</a></li>
<li class="chapter" data-level="" data-path="anatomy-of-simple-feature-objects.html"><a href="anatomy-of-simple-feature-objects.html#additional-resources"><i class="fa fa-check"></i>Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html"><i class="fa fa-check"></i><b>D</b> Vector operations in R</a>
<ul>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#dissolving-geometries"><i class="fa fa-check"></i>Dissolving geometries</a>
<ul>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#dissolving-by-contiguous-shape"><i class="fa fa-check"></i>Dissolving by contiguous shape</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#dissolving-by-attribute"><i class="fa fa-check"></i>Dissolving by attribute</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#subsetting-by-attribute"><i class="fa fa-check"></i>Subsetting by attribute</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#intersecting-layers"><i class="fa fa-check"></i>Intersecting layers</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#clipping-spatial-objects-using-other-spatial-objects"><i class="fa fa-check"></i>Clipping spatial objects using other spatial objects</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#unioning-layers"><i class="fa fa-check"></i>Unioning layers</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#buffering-geometries"><i class="fa fa-check"></i>Buffering geometries</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html"><i class="fa fa-check"></i><b>E</b> Mapping rates in R</a>
<ul>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#raw-rates"><i class="fa fa-check"></i>Raw Rates</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#standardized-mortality-ratios-relative-risk."><i class="fa fa-check"></i>Standardized mortality ratios (relative risk).</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#dykes-and-unwins-chi-square-statistic"><i class="fa fa-check"></i>Dykes and Unwin’s chi-square statistic</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#unstable-ratios"><i class="fa fa-check"></i>Unstable ratios</a>
<ul>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#global-empirical-bayes-eb-rate-estimate"><i class="fa fa-check"></i>Global Empirical Bayes (EB) rate estimate</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#local-empirical-bayes-eb-rate-estimate"><i class="fa fa-check"></i>Local Empirical Bayes (EB) rate estimate</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="F" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html"><i class="fa fa-check"></i><b>F</b> Raster operations in R</a>
<ul>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#sample-files-for-this-exercise-1"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#local-operations-and-functions-1"><i class="fa fa-check"></i>Local operations and functions</a>
<ul>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#unary-operations-and-functions-applied-to-single-rasters"><i class="fa fa-check"></i>Unary operations and functions (applied to single rasters)</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#binary-operations-and-functions-where-two-rasters-are-used"><i class="fa fa-check"></i>Binary operations and functions (where two rasters are used)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#focal-operations-and-functions-1"><i class="fa fa-check"></i>Focal operations and functions</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#zonal-operations-and-functions-1"><i class="fa fa-check"></i>Zonal operations and functions</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#global-operations-and-functions-1"><i class="fa fa-check"></i>Global operations and functions</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#computing-cumulative-distances"><i class="fa fa-check"></i>Computing cumulative distances</a>
<ul>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#working-example"><i class="fa fa-check"></i>Working example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="G" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html"><i class="fa fa-check"></i><b>G</b> Coordinate Systems in R</a>
<ul>
<li><a href="coordinate-systems-in-r.html#a-note-about-the-changes-to-the-proj-environment">A note about the changes to the <code>PROJ</code> environment</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#sample-files-for-this-exercise-2"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li><a href="coordinate-systems-in-r.html#loading-the-sf-package">Loading the <code>sf</code> package</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#checking-for-a-coordinate-system"><i class="fa fa-check"></i>Checking for a coordinate system</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#understanding-the-proj4-coordinate-syntax"><i class="fa fa-check"></i>Understanding the Proj4 coordinate syntax</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#assigning-a-coordinate-system"><i class="fa fa-check"></i>Assigning a coordinate system</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#transforming-coordinate-systems"><i class="fa fa-check"></i>Transforming coordinate systems</a>
<ul>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#example-of-a-failed-transformation"><i class="fa fa-check"></i>Example of a failed transformation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#a-note-about-containment"><i class="fa fa-check"></i>A note about containment</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#creating-tissot-indicatrix-circles"><i class="fa fa-check"></i>Creating Tissot indicatrix circles</a></li>
</ul></li>
<li class="chapter" data-level="H" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html"><i class="fa fa-check"></i><b>H</b> Point pattern analysis in R</a>
<ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#sample-files-for-this-exercise-3"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li><a href="point-pattern-analysis-in-r.html#getting-external-data-into-a-spatstat-format">Getting external data into a <code>spatstat</code> format</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#prepping-the-data"><i class="fa fa-check"></i>Prepping the data</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#density-based-analysis-1"><i class="fa fa-check"></i>Density based analysis</a>
<ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#quadrat-density-1"><i class="fa fa-check"></i>Quadrat density</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#quadrat-density-on-a-tessellated-surface"><i class="fa fa-check"></i>Quadrat density on a tessellated surface</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#kernel-density-raster"><i class="fa fa-check"></i>Kernel density raster</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#kernel-density-adjusted-for-covariate-1"><i class="fa fa-check"></i>Kernel density adjusted for covariate</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#modeling-intensity-as-a-function-of-a-covariate-1"><i class="fa fa-check"></i>Modeling intensity as a function of a covariate</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#distance-based-analysis-1"><i class="fa fa-check"></i>Distance based analysis</a>
<ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#average-nearest-neighbor-analysis"><i class="fa fa-check"></i>Average nearest neighbor analysis</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#k-and-l-functions-1"><i class="fa fa-check"></i>K and L functions</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#pair-correlation-function-g"><i class="fa fa-check"></i>Pair correlation function g</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#hypothesis-tests"><i class="fa fa-check"></i>Hypothesis tests</a>
<ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#test-for-clusteringdispersion"><i class="fa fa-check"></i>Test for clustering/dispersion</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#computing-a-pseudo-p-value-from-the-simulation"><i class="fa fa-check"></i>Computing a pseudo p-value from the simulation</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#test-for-a-poisson-point-process-model-with-a-covariate-effect"><i class="fa fa-check"></i>Test for a poisson point process model with a covariate effect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="I" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html"><i class="fa fa-check"></i><b>I</b> Spatial autocorrelation in R</a>
<ul>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_1"><i class="fa fa-check"></i>Sample files for this exercise</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_2"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_3"><i class="fa fa-check"></i>Define neighboring polygons</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_4"><i class="fa fa-check"></i>Computing the Moran’s I statistic: the hard way</a>
<ul>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#computing-a-pseudo-p-value-from-an-mc-simulation"><i class="fa fa-check"></i>Computing a pseudo p-value from an MC simulation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_5"><i class="fa fa-check"></i>Computing the Moran’s I statistic: the easy way</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#app8_6"><i class="fa fa-check"></i>Moran’s I as a function of a distance band</a></li>
</ul></li>
<li class="chapter" data-level="J" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html"><i class="fa fa-check"></i><b>J</b> Interpolation in R</a>
<ul>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#thiessen-polygons"><i class="fa fa-check"></i>Thiessen polygons</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#idw"><i class="fa fa-check"></i>IDW</a>
<ul>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#fine-tuning-the-interpolation"><i class="fa fa-check"></i>Fine-tuning the interpolation</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#cross-validation"><i class="fa fa-check"></i>Cross-validation</a></li>
</ul></li>
<li><a href="interpolation-in-r.html#st-order-polynomial-fit">1<sup>st</sup> order polynomial fit</a></li>
<li><a href="interpolation-in-r.html#nd-order-polynomial">2<sup>nd</sup> order polynomial</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#kriging"><i class="fa fa-check"></i>Kriging</a>
<ul>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#fit-the-variogram-model"><i class="fa fa-check"></i>Fit the variogram model</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#generate-kriged-surface"><i class="fa fa-check"></i>Generate Kriged surface</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#generate-the-variance-and-confidence-interval-maps"><i class="fa fa-check"></i>Generate the variance and confidence interval maps</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Intro to GIS and Spatial Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="raster-operations-in-r" class="section level1" number="21">
<h1><span class="header-section-number">F</span> Raster operations in R</h1>
<table class="package_ver_table">
<tbody>
<tr>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
R
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
raster
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
tmap
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
sf
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
gdistance
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
ggplot2
</td>
<td style="text-align:left;color: black !important;background-color: #ffc178 !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
rasterVis
</td>
</tr>
<tr>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
4.1.1
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
3.4.13
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
3.3.2
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
1.0.2
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
1.3.6
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
3.3.5
</td>
<td style="text-align:left;color: white !important;background-color: #AAAAAA !important;text-align: center;font-size: 12px !important; 
              margin:5px; 
              border-radius: 8px;
              border: 2px solid white;
              padding-top: 1px;
              padding-bottom: 1px;
              padding-left: 4px;
              padding-right: 4px;">
0.50.3
</td>
</tr>
</tbody>
</table>
<div id="sample-files-for-this-exercise-1" class="section level2 unnumbered">
<h2>Sample files for this exercise</h2>
<p>We’ll first load spatial objects used in this exercise from a remote website: an elevation <code>raster</code> object, a bathymetry <code>raster</code> object and a continents <code>sf</code> vector object</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="raster-operations-in-r.html#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">url</span>(<span class="st">&quot;https://github.com/mgimond/Spatial/raw/main/Data/raster.RData&quot;</span>))</span></code></pre></div>
<p>Both rasters cover the entire globe. Elevation below mean sea level are encoded as <code>0</code> in the elevation raster. Likewise, bathymetry values above mean sea level are encoded as <code>0</code>.</p>
<p>Note that most of the map algebra operations and functions covered in this tutorial are implemented using the <code>raster</code> package. See chapter 10 for a theoretical discussion of map algebra operations.</p>
</div>
<div id="local-operations-and-functions-1" class="section level2 unnumbered">
<h2>Local operations and functions</h2>
<div id="unary-operations-and-functions-applied-to-single-rasters" class="section level3 unnumbered">
<h3>Unary operations and functions (applied to single rasters)</h3>
<p>Most algebraic operations can be applied to rasters as they would with any vector element. For example, to convert all bathymetric values in <code>bath</code> (currently recorded as positive values) to <em>negative</em> values simply multiply the raster by <code>-1</code>.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="raster-operations-in-r.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb220-2"><a href="raster-operations-in-r.html#cb220-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-3"><a href="raster-operations-in-r.html#cb220-3" aria-hidden="true" tabindex="-1"></a>bath2 <span class="ot">&lt;-</span> bath <span class="sc">*</span> (<span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<p>Another unary operation that can be applied to a raster is reclassification. In the following example, we will assign all <code>bath2</code> values that are less than zero a <code>1</code> and all zero values will remain unchanged. A simple way to do this is to apply a conditional statement.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="raster-operations-in-r.html#cb221-1" aria-hidden="true" tabindex="-1"></a>bath3 <span class="ot">&lt;-</span> bath2 <span class="sc">&lt;</span> <span class="dv">0</span></span></code></pre></div>
<p>Let’s look at the output. Note that all <code>0</code> pixels are coded as <code>FALSE</code> and all <code>1</code> pixels are coded as <code>TRUE</code>.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="raster-operations-in-r.html#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb222-2"><a href="raster-operations-in-r.html#cb222-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(bath3) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="st">&quot;Greys&quot;</span>) <span class="sc">+</span> </span>
<span id="cb222-3"><a href="raster-operations-in-r.html#cb222-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">outside =</span> <span class="cn">TRUE</span>, <span class="at">text.size =</span> .<span class="dv">8</span>) </span></code></pre></div>
<p><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>If a more elaborate form of reclassification is desired, you can use the <code>reclassify</code> function. In the following example, the raster object <code>bath</code> is reclassified to 4 unique values: 100, 500, 1000 and 11000 as follows:</p>
<table>
<thead>
<tr class="header">
<th>Original depth values</th>
<th>Reclassified values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0 - 100</td>
<td>100</td>
</tr>
<tr class="even">
<td>101 - 500</td>
<td>500</td>
</tr>
<tr class="odd">
<td>501 - 1000</td>
<td>1000</td>
</tr>
<tr class="even">
<td>1001 - 11000</td>
<td>11000</td>
</tr>
</tbody>
</table>
<p>The first step is to create a plain matrix where the first and second columns list the starting and ending values of the range of input values that are to be reclassified, and where the third column lists the new raster cell values.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="raster-operations-in-r.html#cb223-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">100</span>,  <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">500</span>,  <span class="dv">500</span>, </span>
<span id="cb223-2"><a href="raster-operations-in-r.html#cb223-2" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1000</span>,  <span class="dv">1000</span>, <span class="dv">1000</span>, <span class="dv">11000</span>, <span class="dv">11000</span>)</span>
<span id="cb223-3"><a href="raster-operations-in-r.html#cb223-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(m, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">byrow =</span> T)</span>
<span id="cb223-4"><a href="raster-operations-in-r.html#cb223-4" aria-hidden="true" tabindex="-1"></a>m</span></code></pre></div>
<pre><code>     [,1]  [,2]  [,3]
[1,]    0   100   100
[2,]  100   500   500
[3,]  500  1000  1000
[4,] 1000 11000 11000</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="raster-operations-in-r.html#cb225-1" aria-hidden="true" tabindex="-1"></a>bath3 <span class="ot">&lt;-</span> <span class="fu">reclassify</span>(bath, m, <span class="at">right =</span> T)</span></code></pre></div>
<p>The <code>right=T</code> parameter indicates that the intervals should be closed to the right (i.e. the second column of the reclassification matrix is inclusive).</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="raster-operations-in-r.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(bath3) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">style=</span><span class="st">&quot;cat&quot;</span>) <span class="sc">+</span> <span class="fu">tm_legend</span>(<span class="at">outside =</span> <span class="cn">TRUE</span>, <span class="at">text.size =</span> .<span class="dv">8</span>) </span></code></pre></div>
<p><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>You can also assign <code>NA</code> (missing) values to pixels. For example, to assign <code>NA</code> values to cells that are equal to 100, type</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="raster-operations-in-r.html#cb227-1" aria-hidden="true" tabindex="-1"></a>bath3[bath3 <span class="sc">==</span> <span class="dv">100</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
<p>The following chunk of code highlights all <code>NA</code> pixels in grey and labels them as missing.</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="raster-operations-in-r.html#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(bath3) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">showNA=</span><span class="cn">TRUE</span>, <span class="at">colorNA=</span><span class="st">&quot;grey&quot;</span>) <span class="sc">+</span> </span>
<span id="cb228-2"><a href="raster-operations-in-r.html#cb228-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">outside =</span> <span class="cn">TRUE</span>, <span class="at">text.size =</span> .<span class="dv">8</span>) </span></code></pre></div>
<p><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
<div id="binary-operations-and-functions-where-two-rasters-are-used" class="section level3 unnumbered">
<h3>Binary operations and functions (where two rasters are used)</h3>
<p>In the following example, <code>elev</code> (elevation raster) is added to <code>bath</code> (bathymetry raster) to create a single elevation raster for the globe. Note that the bathymetric raster will need to be multiplied by <code>-1</code> to differentiate above mean sea level elevation from below mean sea level depth.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="raster-operations-in-r.html#cb229-1" aria-hidden="true" tabindex="-1"></a>elevation <span class="ot">&lt;-</span> elev <span class="sc">-</span> bath</span></code></pre></div>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="raster-operations-in-r.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(elevation) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">palette=</span><span class="st">&quot;-RdBu&quot;</span>,<span class="at">n=</span><span class="dv">6</span>) <span class="sc">+</span> </span>
<span id="cb230-2"><a href="raster-operations-in-r.html#cb230-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">outside =</span> <span class="cn">TRUE</span>, <span class="at">text.size =</span> .<span class="dv">8</span>) </span></code></pre></div>
<p><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
</div>
<div id="focal-operations-and-functions-1" class="section level2 unnumbered">
<h2>Focal operations and functions</h2>
<p>Operations or functions applied focally to rasters involve user defined neighboring cells. For example, a cell output value can be the average of all 121 cells–an 11x11 kernel–centered on the cell whose value is being estimated (this is an example of a <em>smoothing function</em>).</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="raster-operations-in-r.html#cb231-1" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">focal</span>(elevation, <span class="at">w=</span><span class="fu">matrix</span>(<span class="dv">1</span>,<span class="at">nrow=</span><span class="dv">11</span>,<span class="at">ncol=</span><span class="dv">11</span>)  , <span class="at">fun=</span>mean)</span></code></pre></div>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="raster-operations-in-r.html#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(f1) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">palette=</span><span class="st">&quot;-RdBu&quot;</span>,<span class="at">n=</span><span class="dv">6</span>) <span class="sc">+</span> </span>
<span id="cb232-2"><a href="raster-operations-in-r.html#cb232-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">outside =</span> <span class="cn">TRUE</span>, <span class="at">text.size =</span> .<span class="dv">8</span>) </span></code></pre></div>
<p><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>By default edge cells are assigned a value of <code>NA</code>. This is because cells outside of the input raster extent have no value but may fall inside the kernel window when edge cells are computed. You can remedy this by passing the parameters <code>na.rm=TRUE</code> and <code>pad=TRUE</code> to the function.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="raster-operations-in-r.html#cb233-1" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">focal</span>(elevation, <span class="at">w=</span><span class="fu">matrix</span>(<span class="dv">1</span>,<span class="at">nrow=</span><span class="dv">11</span>,<span class="at">ncol=</span><span class="dv">11</span>)  , </span>
<span id="cb233-2"><a href="raster-operations-in-r.html#cb233-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">fun=</span>mean, <span class="at">pad=</span><span class="cn">TRUE</span>,  <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="raster-operations-in-r.html#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(f1) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">palette=</span><span class="st">&quot;-RdBu&quot;</span>,<span class="at">n=</span><span class="dv">6</span>) <span class="sc">+</span> </span>
<span id="cb234-2"><a href="raster-operations-in-r.html#cb234-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">outside =</span> <span class="cn">TRUE</span>, <span class="at">text.size =</span> .<span class="dv">8</span>) </span></code></pre></div>
<p><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>But, you must be careful when making use of the <code>na.rm=TRUE</code>/<code>pad=TRUE</code> combination. In the above example, we are passing the values from the kernel window as <em>a vector element</em> to the <code>mean</code> function. So the number of valid (non NA) values being passed to the <code>mean</code> function does not matter since the function will sort out the weights based on the number of input values.</p>
<p>If, however, the smoothing function makes use of explicitly defined weights, then setting <code>pad=TRUE</code> will be problematic since the edge pixels will succumb to unbalanced weights. In the following example, we’ll compare the output of three 3x3 smoothing operations as follows:</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="raster-operations-in-r.html#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the mean function</span></span>
<span id="cb235-2"><a href="raster-operations-in-r.html#cb235-2" aria-hidden="true" tabindex="-1"></a>f_mean     <span class="ot">&lt;-</span> <span class="fu">focal</span>(elevation, <span class="at">w=</span><span class="fu">matrix</span>(<span class="dv">1</span>,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">3</span>), <span class="at">fun=</span>mean, <span class="at">na.rm=</span><span class="cn">TRUE</span>, <span class="at">pad=</span><span class="cn">TRUE</span>)</span>
<span id="cb235-3"><a href="raster-operations-in-r.html#cb235-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-4"><a href="raster-operations-in-r.html#cb235-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Using explicitly defined weights</span></span>
<span id="cb235-5"><a href="raster-operations-in-r.html#cb235-5" aria-hidden="true" tabindex="-1"></a>f_wt_nopad <span class="ot">&lt;-</span> <span class="fu">focal</span>(elevation, <span class="at">w=</span><span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">9</span>,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">3</span>), <span class="at">na.rm=</span><span class="cn">TRUE</span>, <span class="at">pad=</span><span class="cn">FALSE</span>)</span>
<span id="cb235-6"><a href="raster-operations-in-r.html#cb235-6" aria-hidden="true" tabindex="-1"></a>f_wt_pad   <span class="ot">&lt;-</span> <span class="fu">focal</span>(elevation, <span class="at">w=</span><span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">9</span>,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">3</span>), <span class="at">na.rm=</span><span class="cn">TRUE</span>, <span class="at">pad=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>The following images are zoomed in on the upper left-hand set of pixels of each raster output. The <code>elevation</code> raster is the input raster.</p>
<p><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-18-1.png" width="768" /></p>
<p>The left-most image shows the original upper left-hand corner elevation pixel values. The second image shows the output using the mean function with the <code>pad=TRUE</code> option. The third image shows the output using the weighted kernel window with the <code>pad=FALSE</code> option (note the upper row of <code>NA</code> pixels highlighted in <em>bisque</em> color). The last image shows the output from the same weighted kernel window using the <code>pad=TRUE</code> option. This last outcome is not desirable. For example, the middle top pixel is computed from <code>1/9(-4113 -4113 -4112 -4107 -4104 -4103)</code>, which results in dividing the sum of <em>six</em> values by <em>nine</em>–hence the unbalanced weight effect. Note that we do not have that problem using the mean function.</p>
<p>You might have noticed the lack of edge effect issues along the western edge of the raster outputs. This is because the <code>focal</code> function will wrap the eastern edge of the raster to the western edge of that same raster if the input raster layer spans the entire globe (i.e from -180 ° to +180 °).</p>
<p>The <em>neighbors</em> matrix (or <em>kernel</em>) that defines the moving window can be customized. For example if we wanted to compute the average of all 8 neighboring cells <em>excluding</em> the central cell we could define the matrix as follows:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="raster-operations-in-r.html#cb236-1" aria-hidden="true" tabindex="-1"></a>m  <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">/</span><span class="dv">8</span>,<span class="at">nrow =</span> <span class="dv">3</span>) </span>
<span id="cb236-2"><a href="raster-operations-in-r.html#cb236-2" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">focal</span>(elevation, <span class="at">w=</span>m, <span class="at">fun=</span>sum)</span></code></pre></div>
<p>More complicated kernels can be defined. In the following example, a <a href="http://en.wikipedia.org/wiki/Sobel_operator">Sobel</a> filter (used for edge detection in image processing) is defined then applied to the raster layer <code>elevation</code>.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="raster-operations-in-r.html#cb237-1" aria-hidden="true" tabindex="-1"></a>Sobel <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">/</span> <span class="dv">4</span>, <span class="at">nrow=</span><span class="dv">3</span>) </span>
<span id="cb237-2"><a href="raster-operations-in-r.html#cb237-2" aria-hidden="true" tabindex="-1"></a>f3    <span class="ot">&lt;-</span> <span class="fu">focal</span>(elevation, <span class="at">w=</span>Sobel, <span class="at">fun=</span>sum) </span>
<span id="cb237-3"><a href="raster-operations-in-r.html#cb237-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4"><a href="raster-operations-in-r.html#cb237-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(f3) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">palette=</span><span class="st">&quot;Greys&quot;</span>) <span class="sc">+</span> </span>
<span id="cb237-5"><a href="raster-operations-in-r.html#cb237-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">legend.show =</span> <span class="cn">FALSE</span>) </span></code></pre></div>
<p><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="zonal-operations-and-functions-1" class="section level2 unnumbered">
<h2>Zonal operations and functions</h2>
<p>A common zonal operation is the aggregation of cells. In the following example, raster layer <code>elevation</code> is aggregated to a 5x5 raster layer.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="raster-operations-in-r.html#cb238-1" aria-hidden="true" tabindex="-1"></a>z1 <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(elevation, <span class="at">fact=</span><span class="dv">2</span>, <span class="at">fun=</span>mean, <span class="at">expand=</span><span class="cn">TRUE</span>)</span>
<span id="cb238-2"><a href="raster-operations-in-r.html#cb238-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-3"><a href="raster-operations-in-r.html#cb238-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(z1) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">palette=</span><span class="st">&quot;-RdBu&quot;</span>,<span class="at">n=</span><span class="dv">6</span>) <span class="sc">+</span> </span>
<span id="cb238-4"><a href="raster-operations-in-r.html#cb238-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">outside =</span> <span class="cn">TRUE</span>, <span class="at">text.size =</span> .<span class="dv">8</span>) </span></code></pre></div>
<p><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>The image may not look much different from the original, but a look at the image properties will show a difference in pixel sizes.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="raster-operations-in-r.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">res</span>(elevation)</span></code></pre></div>
<pre><code>[1] 0.3333333 0.3333333</code></pre>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="raster-operations-in-r.html#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">res</span>(z1)</span></code></pre></div>
<pre><code>[1] 0.6666667 0.6666667</code></pre>
<p><code>z1</code>’s pixel dimensions are half of <code>elevation</code>’s dimensions. You can reverse the process by using the <code>disaggregate</code> function which will split a cell into the desired number of subcells while assigning each one the same parent cell value.</p>
<p>Zonal operations can often involve two layers, one with the values to be aggregated, the other with the defined zones. In the next example, <code>elevation</code>’s cell values are averaged by zones defined by the <code>cont</code> polygon layer.</p>
<p>The following chunk computes the mean elevation value for each unique polygon in <code>cont</code>,</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="raster-operations-in-r.html#cb243-1" aria-hidden="true" tabindex="-1"></a>cont.elev.sp <span class="ot">&lt;-</span> <span class="fu">extract</span>(elevation, cont, <span class="at">fun=</span>mean, <span class="at">sp=</span><span class="cn">TRUE</span>) </span></code></pre></div>
<p>The <code>sp=TRUE</code> parameter instructs the function to output a <code>SpatialPolygonsDataFrame</code> object (same as the input zonal object) instead of a standalone table (matrix). The output spatial object inherits the original attributes and adds a column called <code>layer</code> with the computed mean elevation values.</p>
<p>We can convert the <code>SpatialPolygonsDataFrame</code> object to an <code>sf</code> vector object for flexibility.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="raster-operations-in-r.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb244-2"><a href="raster-operations-in-r.html#cb244-2" aria-hidden="true" tabindex="-1"></a>cont.elev <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(cont.elev.sp)</span></code></pre></div>
<p>The average elevation can be extracted from the <code>sf</code> object as follows:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="raster-operations-in-r.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_drop_geometry</span>(cont.elev)</span></code></pre></div>
<pre><code>      CONTINENT     layer
1        Africa  630.6706
2    Antarctica 2342.8605
3     Australia  276.5497
4        Europe  262.7817
5 North America  826.0598
6 South America  595.4753
7          Asia  790.6417</code></pre>
<p>If you are working off of the original <code>SpatialPolygonsDataFrame</code> vector object, use the <code>cont.elev.sp@data</code> syntax to extract the dataframe.</p>
<p>We can now map the average elevation by continent.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="raster-operations-in-r.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(cont.elev) <span class="sc">+</span> <span class="fu">tm_polygons</span>(<span class="at">col=</span><span class="st">&quot;layer&quot;</span>) <span class="sc">+</span> </span>
<span id="cb247-2"><a href="raster-operations-in-r.html#cb247-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">outside =</span> <span class="cn">TRUE</span>, <span class="at">text.size =</span> .<span class="dv">8</span>)</span></code></pre></div>
<p><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>Many custom functions can be applied to <code>extract</code>. For example, to extract the maximum elevation value by continent, type:</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="raster-operations-in-r.html#cb248-1" aria-hidden="true" tabindex="-1"></a>cont.elev.sp <span class="ot">&lt;-</span> <span class="fu">extract</span>(elevation, cont, <span class="at">fun=</span>max, <span class="at">sp=</span><span class="cn">TRUE</span>) </span></code></pre></div>
<p>As another example, we may wish to extract the number of pixels in each polygon using a customized function.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="raster-operations-in-r.html#cb249-1" aria-hidden="true" tabindex="-1"></a>cont.elev.sp <span class="ot">&lt;-</span> <span class="fu">extract</span>(elevation, cont, <span class="at">fun=</span><span class="cf">function</span>(x,...){<span class="fu">length</span>(x)}, <span class="at">sp=</span><span class="cn">TRUE</span>) </span></code></pre></div>
<p>The <code>extract</code> function will also work with lines and point spatial objects. If you wish to compute the zonal statistics of a raster using another raster as zones instead of a vector layer, use the <code>zonal()</code> function instead.</p>
</div>
<div id="global-operations-and-functions-1" class="section level2 unnumbered">
<h2>Global operations and functions</h2>
<p>Global operations and functions may make use of all input cells of a grid in the computation of an output cell value.</p>
<p>An example of a global function is the Euclidean distance function, <code>distance</code>, which computes the shortest distance between a pixel and a source (or destination) location. To demonstrate the <code>distance</code> function, we’ll first create a new raster layer with two non-NA pixels.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="raster-operations-in-r.html#cb250-1" aria-hidden="true" tabindex="-1"></a>r1   <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="at">ncol=</span><span class="dv">100</span>, <span class="at">nrow=</span><span class="dv">100</span>, <span class="at">xmn=</span><span class="dv">0</span>, <span class="at">xmx=</span><span class="dv">100</span>, <span class="at">ymn=</span><span class="dv">0</span>, <span class="at">ymx=</span><span class="dv">100</span>)</span>
<span id="cb250-2"><a href="raster-operations-in-r.html#cb250-2" aria-hidden="true" tabindex="-1"></a>r1[] <span class="ot">&lt;-</span> <span class="cn">NA</span>              <span class="co"># Assign NoData values to all pixels</span></span>
<span id="cb250-3"><a href="raster-operations-in-r.html#cb250-3" aria-hidden="true" tabindex="-1"></a>r1[<span class="fu">c</span>(<span class="dv">850</span>, <span class="dv">5650</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span>   <span class="co"># Change the pixels #850 and #5650  to 1</span></span>
<span id="cb250-4"><a href="raster-operations-in-r.html#cb250-4" aria-hidden="true" tabindex="-1"></a><span class="fu">crs</span>(r1) <span class="ot">&lt;-</span> <span class="st">&quot;+proj=ortho&quot;</span>  <span class="co"># Assign an arbitrary coordinate system (needed for mapping with tmap)</span></span></code></pre></div>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="raster-operations-in-r.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(r1) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">palette=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb251-2"><a href="raster-operations-in-r.html#cb251-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">outside =</span> <span class="cn">TRUE</span>, <span class="at">text.size =</span> .<span class="dv">8</span>) </span></code></pre></div>
<p><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<p>Next, we’ll compute a Euclidean distance raster from these two cells. The output extent will default to the input raster extent.</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="raster-operations-in-r.html#cb252-1" aria-hidden="true" tabindex="-1"></a>r1.d <span class="ot">&lt;-</span> <span class="fu">distance</span>(r1) </span></code></pre></div>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="raster-operations-in-r.html#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(r1.d) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="st">&quot;Greens&quot;</span>, <span class="at">style=</span><span class="st">&quot;order&quot;</span>, <span class="at">title=</span><span class="st">&quot;Distance&quot;</span>) <span class="sc">+</span> </span>
<span id="cb253-2"><a href="raster-operations-in-r.html#cb253-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">outside =</span> <span class="cn">TRUE</span>, <span class="at">text.size =</span> .<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb253-3"><a href="raster-operations-in-r.html#cb253-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(r1) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">palette=</span><span class="st">&quot;red&quot;</span>, <span class="at">title=</span><span class="st">&quot;Points&quot;</span>) </span></code></pre></div>
<p><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>You can also compute a distance raster using <code>SpatialPoints</code> objects or a simple x,y data table. In the following example, distances to points (25,30) and (87,80) are computed for each output cell. However, since we are working off of point objects (and not an existing raster as was the case in the previous example), we will need to create a blank raster layer which will define the extent of the Euclidean distance raster output.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="raster-operations-in-r.html#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a blank raster</span></span>
<span id="cb254-2"><a href="raster-operations-in-r.html#cb254-2" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="at">ncol=</span><span class="dv">100</span>, <span class="at">nrow=</span><span class="dv">100</span>, <span class="at">xmn=</span><span class="dv">0</span>, <span class="at">xmx=</span><span class="dv">100</span>, <span class="at">ymn=</span><span class="dv">0</span>, <span class="at">ymx=</span><span class="dv">100</span>)</span>
<span id="cb254-3"><a href="raster-operations-in-r.html#cb254-3" aria-hidden="true" tabindex="-1"></a><span class="fu">crs</span>(r2) <span class="ot">&lt;-</span> <span class="st">&quot;+proj=ortho&quot;</span>  <span class="co"># Assign an arbitrary coordinate system </span></span>
<span id="cb254-4"><a href="raster-operations-in-r.html#cb254-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-5"><a href="raster-operations-in-r.html#cb254-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a point layer</span></span>
<span id="cb254-6"><a href="raster-operations-in-r.html#cb254-6" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">25</span>,<span class="dv">30</span>,<span class="dv">87</span>,<span class="dv">80</span>),<span class="at">nrow=</span><span class="dv">2</span>, <span class="at">byrow=</span>T) </span>
<span id="cb254-7"><a href="raster-operations-in-r.html#cb254-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">SpatialPoints</span>(xy)</span>
<span id="cb254-8"><a href="raster-operations-in-r.html#cb254-8" aria-hidden="true" tabindex="-1"></a><span class="fu">crs</span>(p1) <span class="ot">&lt;-</span> <span class="st">&quot;+proj=ortho&quot;</span>  <span class="co"># Assign an arbitrary coordinate system </span></span></code></pre></div>
<p>Now let’s compute the Euclidean distance to these points using the <code>distanceFromPoints</code> function.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="raster-operations-in-r.html#cb255-1" aria-hidden="true" tabindex="-1"></a>r2.d <span class="ot">&lt;-</span> <span class="fu">distanceFromPoints</span>(r2, p1)</span></code></pre></div>
<p>Let’s plot the resulting output.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="raster-operations-in-r.html#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(r2.d) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="st">&quot;Greens&quot;</span>, <span class="at">style=</span><span class="st">&quot;order&quot;</span>) <span class="sc">+</span> </span>
<span id="cb256-2"><a href="raster-operations-in-r.html#cb256-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">outside =</span> <span class="cn">TRUE</span>, <span class="at">text.size =</span> .<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb256-3"><a href="raster-operations-in-r.html#cb256-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(p1) <span class="sc">+</span> <span class="fu">tm_bubbles</span>(<span class="at">col=</span><span class="st">&quot;red&quot;</span>) </span></code></pre></div>
<p><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
</div>
<div id="computing-cumulative-distances" class="section level2 unnumbered">
<h2>Computing cumulative distances</h2>
<p>This exercise demonstrates how to use functions from the <code>gdistance</code> package to generate a cumulative distance raster. One objective will be to demonstrate the influence “adjacency cells” wields in the final results.</p>
<p>Load the <code>gdistance</code> package.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="raster-operations-in-r.html#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gdistance)</span></code></pre></div>
<p>First, we’ll create a 100x100 raster and assign a value of <code>1</code> to each cell. The pixel value defines the cost (other than distance) in traversing that pixel. In this example, we’ll assume that the cost is uniform across the entire extent.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="raster-operations-in-r.html#cb258-1" aria-hidden="true" tabindex="-1"></a>r   <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="at">nrows=</span><span class="dv">100</span>,<span class="at">ncols=</span><span class="dv">100</span>,<span class="at">xmn=</span><span class="dv">0</span>,<span class="at">ymn=</span><span class="dv">0</span>,<span class="at">xmx=</span><span class="dv">100</span>,<span class="at">ymx=</span><span class="dv">100</span>)</span>
<span id="cb258-2"><a href="raster-operations-in-r.html#cb258-2" aria-hidden="true" tabindex="-1"></a>r[] <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">ncell</span>(r))</span></code></pre></div>
<p>If you were to include traveling costs other than distance (such as elevation) you would assign those values to each cell instead of the constant value of <code>1</code>.</p>
<p>A <strong>translation matrix</strong> allows one to define a ‘traversing’ cost going from one cell to an adjacent cell. Since we are assuming there are no ‘costs’ (other than distance) in traversing from one cell to any adjacent cell we’ll assign a value of 1, <code>function(x){1}</code>, to the translation between a cell and its adjacent cells (i.e. translation cost is uniform in all directions).</p>
<p>There are four different ways in which ‘adjacency’ can be defined using the <code>transition</code> function. These are showcased in the next four blocks of code.</p>
<p>In this example, adjacency is defined as a <strong>four node</strong> (vertical and horizontal) connection (i.e. a “rook” move).</p>
<p><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-40-1.png" width="288" style="display: block; margin: auto auto auto 0;" /></p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="raster-operations-in-r.html#cb259-1" aria-hidden="true" tabindex="-1"></a>h4   <span class="ot">&lt;-</span> <span class="fu">transition</span>(r, <span class="at">transitionFunction =</span> <span class="cf">function</span>(x){<span class="dv">1</span>}, <span class="at">directions =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>In this example, adjacency is defined as an <strong>eight node</strong> connection (i.e. a single cell “queen” move).</p>
<p><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-42-1.png" width="288" style="display: block; margin: auto auto auto 0;" /></p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="raster-operations-in-r.html#cb260-1" aria-hidden="true" tabindex="-1"></a>h8   <span class="ot">&lt;-</span> <span class="fu">transition</span>(r, <span class="at">transitionFunction =</span> <span class="cf">function</span>(x){<span class="dv">1</span>}, <span class="at">directions =</span> <span class="dv">8</span>)</span></code></pre></div>
<p>In this example, adjacency is defined as a <strong>sixteen node</strong> connection (i.e. a single cell “queen” move combined with a “knight” move).</p>
<p><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-44-1.png" width="288" style="display: block; margin: auto auto auto 0;" /></p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="raster-operations-in-r.html#cb261-1" aria-hidden="true" tabindex="-1"></a>h16  <span class="ot">&lt;-</span> <span class="fu">transition</span>(r, <span class="at">transitionFunction=</span><span class="cf">function</span>(x){<span class="dv">1</span>},<span class="dv">16</span>,<span class="at">symm=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p>In this example, adjacency is defined as a <strong>four node diagonal</strong> connection (i.e. a single cell “bishop” move).</p>
<p><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-46-1.png" width="288" style="display: block; margin: auto auto auto 0;" /></p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="raster-operations-in-r.html#cb262-1" aria-hidden="true" tabindex="-1"></a>hb   <span class="ot">&lt;-</span> <span class="fu">transition</span>(r, <span class="at">transitionFunction=</span><span class="cf">function</span>(x){<span class="dv">1</span>},<span class="st">&quot;bishop&quot;</span>,<span class="at">symm=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p>The <code>transition</code> function treats all adjacent cells as being at an equal distance from the source cell across the entire raster. <code>geoCorrection</code> corrects for ‘true’ local distance. In essence, it’s adding an additional cost to traversing from one cell to an adjacent cell (the original cost being defined using the <code>transition</code> function). The importance of applying this correction will be shown later.</p>
<p>Note: <code>geoCorrection</code> also corrects for distance distortions associated with data in a geographic coordinate system. To take advantage of this correction, make sure to define the raster layer’s coordinate system using the <code>projection</code> function.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="raster-operations-in-r.html#cb263-1" aria-hidden="true" tabindex="-1"></a>h4    <span class="ot">&lt;-</span> <span class="fu">geoCorrection</span>(h4,  <span class="at">scl=</span><span class="cn">FALSE</span>)</span>
<span id="cb263-2"><a href="raster-operations-in-r.html#cb263-2" aria-hidden="true" tabindex="-1"></a>h8    <span class="ot">&lt;-</span> <span class="fu">geoCorrection</span>(h8,  <span class="at">scl=</span><span class="cn">FALSE</span>)</span>
<span id="cb263-3"><a href="raster-operations-in-r.html#cb263-3" aria-hidden="true" tabindex="-1"></a>h16   <span class="ot">&lt;-</span> <span class="fu">geoCorrection</span>(h16, <span class="at">scl=</span><span class="cn">FALSE</span>)</span>
<span id="cb263-4"><a href="raster-operations-in-r.html#cb263-4" aria-hidden="true" tabindex="-1"></a>hb    <span class="ot">&lt;-</span> <span class="fu">geoCorrection</span>(hb,  <span class="at">scl=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p>In the “queen’s” case, the diagonal neighbors are <span class="math inline">\(\sqrt{2 x (CellWidth)^{2}}\)</span> times the cell width distance from the source cell.</p>
<p>Next we will map the cumulative distance (<code>accCost</code>) from a central point (A) to all cells in the raster using the four different adjacency definitions.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="raster-operations-in-r.html#cb264-1" aria-hidden="true" tabindex="-1"></a>A       <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">50</span>) <span class="co"># Location of source cell</span></span>
<span id="cb264-2"><a href="raster-operations-in-r.html#cb264-2" aria-hidden="true" tabindex="-1"></a>h4.acc  <span class="ot">&lt;-</span> <span class="fu">accCost</span>(h4,A)</span>
<span id="cb264-3"><a href="raster-operations-in-r.html#cb264-3" aria-hidden="true" tabindex="-1"></a>h8.acc  <span class="ot">&lt;-</span> <span class="fu">accCost</span>(h8,A)</span>
<span id="cb264-4"><a href="raster-operations-in-r.html#cb264-4" aria-hidden="true" tabindex="-1"></a>h16.acc <span class="ot">&lt;-</span> <span class="fu">accCost</span>(h16,A)</span>
<span id="cb264-5"><a href="raster-operations-in-r.html#cb264-5" aria-hidden="true" tabindex="-1"></a>hb.acc  <span class="ot">&lt;-</span> <span class="fu">accCost</span>(hb,A) </span></code></pre></div>
<p>If the <code>geoCorrection</code> function had not been applied in the previous steps, the cumulative distance between point location A and its neighboring adjacent cells would have been different. Note the difference in cumulative distance for the 16-direction case as shown in the next two figures.</p>
<p>Uncorrected (i.e. <code>geoCorrection</code> <em>not</em> applied to h16):</p>
<p><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-51-1.png" width="288" style="display: block; margin: auto auto auto 0;" /></p>
<p>Corrected (i.e. <code>geoCorrection</code> applied to h16):</p>
<p><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-52-1.png" width="288" style="display: block; margin: auto auto auto 0;" /></p>
<p>The “bishop” case offers a unique problem: only cells in the diagonal direction are identified as being adjacent. This leaves many undefined cells (labeled as <code>Inf</code>). We will change the <code>Inf</code> cells to <code>NA</code> cells.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="raster-operations-in-r.html#cb265-1" aria-hidden="true" tabindex="-1"></a>hb.acc[hb.acc <span class="sc">==</span> <span class="cn">Inf</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
<p>Now let’s compare a 7x7 subset (centered on point A) between the four different cumulative distance rasters.</p>
<p><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-54-1.png" width="576" style="display: block; margin: auto auto auto 0;" /></p>
<p>To highlight the differences between all four rasters, we will assign a red color to all cells that are within 20 cell units of point A.</p>
<p><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-55-1.png" width="576" style="display: block; margin: auto auto auto 0;" /></p>
<p>It’s obvious that the accuracy of the cumulative distance raster can be greatly influenced by how we define adjacent nodes. The number of red cells (i.e. area identified as being within a 20 units cumulative distance) ranges from 925 to 2749 cells.</p>
<p><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<div id="working-example" class="section level3 unnumbered">
<h3>Working example</h3>
<p>In the following example, we will generate a raster layer with barriers (defined as <code>NA</code> cell values). The goal will be to identify all cells that fall within a 290 km traveling distance from the upper left-hand corner of the raster layer (the green point in the maps). Results between an 8-node and 16-node adjacency definition will be compared.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="raster-operations-in-r.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create an empty raster</span></span>
<span id="cb266-2"><a href="raster-operations-in-r.html#cb266-2" aria-hidden="true" tabindex="-1"></a>r   <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="at">nrows=</span><span class="dv">300</span>,<span class="at">ncols=</span><span class="dv">150</span>,<span class="at">xmn=</span><span class="dv">0</span>,<span class="at">ymn=</span><span class="dv">0</span>,<span class="at">xmx=</span><span class="dv">150000</span>, <span class="at">ymx=</span><span class="dv">300000</span>)</span>
<span id="cb266-3"><a href="raster-operations-in-r.html#cb266-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-4"><a href="raster-operations-in-r.html#cb266-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a UTM projection (this sets map units to meters)</span></span>
<span id="cb266-5"><a href="raster-operations-in-r.html#cb266-5" aria-hidden="true" tabindex="-1"></a><span class="fu">projection</span>(r) <span class="ot">=</span> <span class="st">&quot;+proj=utm +zone=19 +datum=NAD83&quot;</span> </span>
<span id="cb266-6"><a href="raster-operations-in-r.html#cb266-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-7"><a href="raster-operations-in-r.html#cb266-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Each cell is assigned a value of 1</span></span>
<span id="cb266-8"><a href="raster-operations-in-r.html#cb266-8" aria-hidden="true" tabindex="-1"></a>r[] <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">ncell</span>(r)) </span>
<span id="cb266-9"><a href="raster-operations-in-r.html#cb266-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-10"><a href="raster-operations-in-r.html#cb266-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate &#39;baffles&#39; by assigning NA to cells. Cells are identified by</span></span>
<span id="cb266-11"><a href="raster-operations-in-r.html#cb266-11" aria-hidden="true" tabindex="-1"></a><span class="co"># their index and not their coordinates.</span></span>
<span id="cb266-12"><a href="raster-operations-in-r.html#cb266-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Baffles need to be 2 cells thick to prevent the 16-node</span></span>
<span id="cb266-13"><a href="raster-operations-in-r.html#cb266-13" aria-hidden="true" tabindex="-1"></a><span class="co"># case from &quot;jumping&quot; a one pixel thick NA cell.</span></span>
<span id="cb266-14"><a href="raster-operations-in-r.html#cb266-14" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">3001</span>,<span class="dv">3100</span>,<span class="dv">1</span>),<span class="fu">seq</span>(<span class="dv">3151</span>,<span class="dv">3250</span>,<span class="dv">1</span>))</span>
<span id="cb266-15"><a href="raster-operations-in-r.html#cb266-15" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(a, a<span class="sc">+</span><span class="dv">6000</span>, a<span class="sc">+</span><span class="dv">12000</span>, a<span class="sc">+</span><span class="dv">18000</span>, a<span class="sc">+</span><span class="dv">24000</span>, a<span class="sc">+</span><span class="dv">30000</span>, a<span class="sc">+</span><span class="dv">36000</span>)</span>
<span id="cb266-16"><a href="raster-operations-in-r.html#cb266-16" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(a , a<span class="sc">+</span><span class="dv">3050</span>)</span>
<span id="cb266-17"><a href="raster-operations-in-r.html#cb266-17" aria-hidden="true" tabindex="-1"></a>r[a] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb266-18"><a href="raster-operations-in-r.html#cb266-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-19"><a href="raster-operations-in-r.html#cb266-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s check that the baffles are properly placed</span></span>
<span id="cb266-20"><a href="raster-operations-in-r.html#cb266-20" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(r) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">colorNA=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb266-21"><a href="raster-operations-in-r.html#cb266-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">legend.show=</span><span class="cn">FALSE</span>)</span>
<span id="cb266-22"><a href="raster-operations-in-r.html#cb266-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-23"><a href="raster-operations-in-r.html#cb266-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Next, generate a transition matrix for the 8-node case and the 16-node case</span></span>
<span id="cb266-24"><a href="raster-operations-in-r.html#cb266-24" aria-hidden="true" tabindex="-1"></a>h8   <span class="ot">&lt;-</span> <span class="fu">transition</span>(r, <span class="at">transitionFunction =</span> <span class="cf">function</span>(x){<span class="dv">1</span>}, <span class="at">directions =</span> <span class="dv">8</span>)</span>
<span id="cb266-25"><a href="raster-operations-in-r.html#cb266-25" aria-hidden="true" tabindex="-1"></a>h16  <span class="ot">&lt;-</span> <span class="fu">transition</span>(r, <span class="at">transitionFunction =</span> <span class="cf">function</span>(x){<span class="dv">1</span>}, <span class="at">directions =</span> <span class="dv">16</span>)</span>
<span id="cb266-26"><a href="raster-operations-in-r.html#cb266-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-27"><a href="raster-operations-in-r.html#cb266-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Now assign distance cost to the matrices. </span></span>
<span id="cb266-28"><a href="raster-operations-in-r.html#cb266-28" aria-hidden="true" tabindex="-1"></a>h8   <span class="ot">&lt;-</span> <span class="fu">geoCorrection</span>(h8)</span>
<span id="cb266-29"><a href="raster-operations-in-r.html#cb266-29" aria-hidden="true" tabindex="-1"></a>h16  <span class="ot">&lt;-</span> <span class="fu">geoCorrection</span>(h16)</span>
<span id="cb266-30"><a href="raster-operations-in-r.html#cb266-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-31"><a href="raster-operations-in-r.html#cb266-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a point source and assign a projection</span></span>
<span id="cb266-32"><a href="raster-operations-in-r.html#cb266-32" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">SpatialPoints</span>(<span class="fu">cbind</span>(<span class="dv">50</span>,<span class="dv">290000</span>))</span>
<span id="cb266-33"><a href="raster-operations-in-r.html#cb266-33" aria-hidden="true" tabindex="-1"></a><span class="fu">crs</span>(A) <span class="ot">&lt;-</span> <span class="st">&quot;+proj=utm +zone=19 +datum=NAD83 +units=m +no_defs&quot;</span>  </span>
<span id="cb266-34"><a href="raster-operations-in-r.html#cb266-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-35"><a href="raster-operations-in-r.html#cb266-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the cumulative cost raster</span></span>
<span id="cb266-36"><a href="raster-operations-in-r.html#cb266-36" aria-hidden="true" tabindex="-1"></a>h8.acc   <span class="ot">&lt;-</span> <span class="fu">accCost</span>(h8, A)</span>
<span id="cb266-37"><a href="raster-operations-in-r.html#cb266-37" aria-hidden="true" tabindex="-1"></a>h16.acc  <span class="ot">&lt;-</span> <span class="fu">accCost</span>(h16,A)</span>
<span id="cb266-38"><a href="raster-operations-in-r.html#cb266-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-39"><a href="raster-operations-in-r.html#cb266-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace Inf with NA</span></span>
<span id="cb266-40"><a href="raster-operations-in-r.html#cb266-40" aria-hidden="true" tabindex="-1"></a>h8.acc[h8.acc   <span class="sc">==</span> <span class="cn">Inf</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb266-41"><a href="raster-operations-in-r.html#cb266-41" aria-hidden="true" tabindex="-1"></a>h16.acc[h16.acc <span class="sc">==</span> <span class="cn">Inf</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
<p><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-58-1.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<p>Let’s plot the results. Yellow cells will identify cumulative distances within 290 km.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="raster-operations-in-r.html#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(h8.acc) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">n=</span><span class="dv">2</span>, <span class="at">style=</span><span class="st">&quot;fixed&quot;</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">290000</span>,<span class="cn">Inf</span>)) <span class="sc">+</span></span>
<span id="cb267-2"><a href="raster-operations-in-r.html#cb267-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>() <span class="sc">+</span> <span class="fu">tm_shape</span>(A) <span class="sc">+</span> <span class="fu">tm_bubbles</span>(<span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb267-3"><a href="raster-operations-in-r.html#cb267-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">outside =</span> <span class="cn">TRUE</span>, <span class="at">text.size =</span> .<span class="dv">8</span>)</span>
<span id="cb267-4"><a href="raster-operations-in-r.html#cb267-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-5"><a href="raster-operations-in-r.html#cb267-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(h16.acc) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">n=</span><span class="dv">2</span>, <span class="at">style=</span><span class="st">&quot;fixed&quot;</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">290000</span>,<span class="cn">Inf</span>)) <span class="sc">+</span> </span>
<span id="cb267-6"><a href="raster-operations-in-r.html#cb267-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>() <span class="sc">+</span> <span class="fu">tm_shape</span>(A) <span class="sc">+</span> <span class="fu">tm_bubbles</span>(<span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb267-7"><a href="raster-operations-in-r.html#cb267-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">outside =</span> <span class="cn">TRUE</span>, <span class="at">text.size =</span> .<span class="dv">8</span>)</span></code></pre></div>
<p><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-59-1.png" width="672" style="display: block; margin: auto auto auto 0;" /><img src="A06-Raster-Operations_files/figure-html/unnamed-chunk-59-2.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<p>We can compute the difference between the 8-node and 16-node cumulative distance rasters:</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="raster-operations-in-r.html#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(h8.acc[]  <span class="sc">&lt;=</span> <span class="dv">290000</span>) </span></code></pre></div>
<pre><code>
FALSE  TRUE 
31458 10742 </code></pre>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="raster-operations-in-r.html#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(h16.acc[] <span class="sc">&lt;=</span> <span class="dv">290000</span>)</span></code></pre></div>
<pre><code>
FALSE  TRUE 
30842 11358 </code></pre>
<p>The number of cells identified as being within a 290 km cumulative distance of point A for the 8-node case is 10742 whereas it’s 11358 for the 16-node case, a difference of 5.4%.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mapping-rates-in-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="coordinate-systems-in-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false,
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
